{"version":3,"file":"js/app.c2789847.js","mappings":"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BAAqB,CACpB,MAED,uBAAwB,CACvB,MAED,0BAA2B,CAC1B,MAED,6BAA8B,CAC7B,MAED,sBAAuB,CACtB,MAED,yBAA0B,CACzB,MAED,sBAAuB,CACtB,KAED,yBAA0B,CACzB,KAED,6BAA8B,CAC7B,IAED,gCAAiC,CAChC,IAED,UAAW,CACV,MAED,aAAc,CACb,MAED,iBAAkB,CACjB,KAED,oBAAqB,CACpB,KAED,oBAAqB,CACpB,MAED,uBAAwB,CACvB,MAED,sBAAuB,CACtB,MAED,yBAA0B,CACzB,MAED,kCAAmC,CAClC,MAED,qCAAsC,CACrC,MAED,0BAA2B,CAC1B,MAED,6BAA8B,CAC7B,MAED,iCAAkC,CACjC,MAED,oCAAqC,CACpC,MAED,qCAAsC,CACrC,MAED,wCAAyC,CACxC,MAED,yCAA0C,CACzC,KACA,MAED,4CAA6C,CAC5C,KACA,MAED,8BAA+B,CAC9B,MAED,iCAAkC,CACjC,MAED,4BAA6B,CAC5B,MAED,+BAAgC,CAC/B,MAED,iBAAkB,CACjB,MAED,oBAAqB,CACpB,MAED,wBAAyB,CACxB,MAED,2BAA4B,CAC3B,MAED,gCAAiC,CAChC,MAED,mCAAoC,CACnC,MAED,4DAA6D,CAC5D,MAED,+DAAgE,CAC/D,MAED,iEAAkE,CACjE,MAED,oEAAqE,CACpE,MAED,2DAA4D,CAC3D,KAED,8DAA+D,CAC9D,KAED,+DAAgE,CAC/D,MAED,kEAAmE,CAClE,MAED,iEAAkE,CACjE,MAED,oEAAqE,CACpE,MAED,6DAA8D,CAC7D,MAED,gEAAiE,CAChE,MAED,sEAAuE,CACtE,MAED,yEAA0E,CACzE,MAED,+DAAgE,CAC/D,MAED,kEAAmE,CAClE,MAED,sEAAuE,CACtE,MAED,yEAA0E,CACzE,MAED,8DAA+D,CAC9D,MAED,iEAAkE,CACjE,MAED,oEAAqE,CACpE,MAED,uEAAwE,CACvE,MAED,gEAAiE,CAChE,MAED,mEAAoE,CACnE,MAED,gEAAiE,CAChE,KAED,mEAAoE,CACnE,KAED,uEAAwE,CACvE,IAED,0EAA2E,CAC1E,IAED,oDAAqD,CA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","sources":["webpack://things-editor/./src/App.vue","webpack://things-editor/./src/components/Editor.vue","webpack://things-editor/./src/components/talents/chevron.js","webpack://things-editor/./src/components/Parser.js","webpack://things-editor/./src/components/Editor.vue?81e4","webpack://things-editor/./src/App.vue?7ccd","webpack://things-editor/./src/main.js","webpack://things-editor/./node_modules/monaco-editor/esm/vs/base/common/worker/ lazy ^.*$ namespace object","webpack://things-editor/./node_modules/monaco-editor/esm/vs/editor/common/services/ lazy ^.*$ namespace object","webpack://things-editor/webpack/bootstrap","webpack://things-editor/webpack/runtime/amd options","webpack://things-editor/webpack/runtime/chunk loaded","webpack://things-editor/webpack/runtime/compat get default export","webpack://things-editor/webpack/runtime/define property getters","webpack://things-editor/webpack/runtime/ensure chunk","webpack://things-editor/webpack/runtime/get javascript chunk filename","webpack://things-editor/webpack/runtime/get mini-css chunk filename","webpack://things-editor/webpack/runtime/global","webpack://things-editor/webpack/runtime/hasOwnProperty shorthand","webpack://things-editor/webpack/runtime/load script","webpack://things-editor/webpack/runtime/make namespace object","webpack://things-editor/webpack/runtime/publicPath","webpack://things-editor/webpack/runtime/jsonp chunk loading","webpack://things-editor/webpack/startup"],"sourcesContent":["<template>\n  <ThingsEditor />\n</template>\n\n<script>\nimport ThingsEditor from './components/Editor.vue';\n\nexport default {\n  name: 'App',\n  components: {\n    ThingsEditor\n  }\n}\n\n</script>\n\n<style>\nbody {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n</style>\n","<template>\n  <div class=\"main-container\">\n\n    <div class=\"editor-container\">\n      <div class=\"editor-toolbar\">\n        <!-- <div class=\"toolbar-left\"> -->\n          <!-- <div class=\"control\">\n            <label class=\"control-label\">Type</label>\n            <select v-model=\"documentType\" class=\"control-select\">\n              <option value=\"info\">Info</option>\n              <option value=\"lore\">Lore</option>\n            </select>\n          </div> -->\n<!-- \n          <div class=\"control\">\n            <label class=\"control-label\">Columns</label>\n            <select v-model=\"columnCount\" class=\"control-select\">\n              <option value=\"1\">1</option>\n              <option value=\"2\">2</option>\n              <option value=\"3\">3</option>\n            </select>\n          </div> -->\n\n          <!-- <div class=\"control compact\">\n            <label class=\"control-label\">DPI</label>\n            <input class=\"control-input\" type=\"number\" min=\"72\" max=\"600\" step=\"1\" v-model.number=\"dpi\" aria-label=\"Document DPI\" />\n          </div>\n\n          <div class=\"control compact\">\n            <label class=\"control-label\">Width (px)</label>\n            <input class=\"control-input\" type=\"number\" min=\"640\" max=\"2048\" step=\"1\" v-model.number=\"docWidth\" aria-label=\"Document width\" />\n          </div>\n\n          <div class=\"control compact\">\n            <label class=\"control-label\">Height (px)</label>\n            <input class=\"control-input\" type=\"number\" min=\"900\" max=\"2800\" step=\"1\" v-model.number=\"docHeight\" aria-label=\"Document height\" />\n          </div> -->\n        <!-- </div> -->\n\n        <div class=\"toolbar-left\">\n          <div class=\"control\">\n            <button class=\"btn secondary\" @click=\"loadState\">Load</button>\n          </div>\n          <div class=\"control\">\n            <button class=\"btn primary\" @click=\"saveState\">Save</button>\n          </div>\n        </div>\n\n        <div class=\"toolbar-right\">\n          <div class=\"control\" style=\"width: 150px;\">\n            <span class=\"save-timer\" v-if=\"isSaving\">Auto-saving...</span>\n          </div>\n          <!-- <button class=\"btn secondary\" @click=\"exportPdf\">Export PDF</button> -->\n          <button class=\"btn primary\" @click=\"exportImage\">Export Images</button>\n        </div>\n      </div>\n\n      <div class=\"editor-toolbar\">\n        <div class=\"toolbar-left\">\n          <div class=\"control\">\n            <label class=\"control-label\"><i class=\"ra ra-hammer\"></i> Insert Item</label>\n            <select v-model=\"selectedItemType\" @change=\"onItemDropdownSelect\" class=\"control-select\">\n              <option disabled value=\"\">Select Item Type...</option>\n              <option value=\"equipment\">Blank Equipment Template</option>\n              <option value=\"sample_javelin\">Sample: \"JAVELIN OF THE SKIES\"</option>\n              <option value=\"sample_specialist_table\">Sample: Specialist Talent Table</option>\n              <option value=\"sample_spell\">Sample: Spell Template</option>\n              <option value=\"sample_species_profile\">Sample: Species Profile</option>\n              <option value=\"sample_lore_excerpt\">Sample: Lore Excerpt</option>\n            </select>\n          </div>\n\n          <div class=\"control\">\n            <label class=\"control-label\"><i class=\"ra ra-book\"></i> Insert Page</label>\n            <select v-model=\"selectedPageType\" @change=\"onPageDropdownSelect\" class=\"control-select\">\n              <option disabled value=\"\">Select Page Type...</option>\n              <option value=\"purple\">Purple Page</option>\n              <option value=\"red\">Red Page</option>\n              <option value=\"yellow\">Yellow Page</option>\n              <option value=\"blue\">Blue Page</option>\n              <option value=\"green\">Green Page</option>\n              <option value=\"orange\">Orange Page</option>\n              <option value=\"red\">Red Page</option>\n            </select>\n          </div>\n\n          <!-- <div class=\"control\">\n            <label class=\"control-label\"><i class=\"ra ra-gear-hammer\"></i> Insert Snippet</label>\n            <select v-model=\"selectedSnippet\" @change=\"onSnippetDropdownSelect\" class=\"control-select\">\n              <option disabled value=\"\">Select Snippet...</option>\n              <option value=\"note-callout\">Note Callout Block</option>\n              <option value=\"two-column-quote\">Two-Column Quote</option>\n              <option value=\"lore-facts\">Lore Fact List</option>\n              <option value=\"stat-block\">Quick Stat Block</option>\n            </select>\n          </div> -->\n        </div>\n\n        <div class=\"toolbar-right\">\n          <div class=\"control\" style=\"width: 300px; text-align: right; color: #f39c12;\" v-if=\"warningText\">\n            <i class=\"ra ra-exclamation-triangle\"></i> {{ warningText }}\n          </div>\n          <div class=\"control\">\n            <input class=\"username-input\" type=\"text\" placeholder=\"username\" v-model=\"username\" />\n          </div>\n          <div class=\"control\">\n            <button class=\"btn secondary\" @click=\"loadSampleDocument('starter-pack')\">Load Starter Packet</button>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"editor-toolbar toolbar-advanced\">\n        <div class=\"toolbar-left\">\n          <div class=\"control compact\">\n            <label class=\"control-label\">Header (pt)</label>\n            <input class=\"control-input\" type=\"number\" min=\"16\" max=\"96\" step=\"1\" v-model.number=\"headerFontPt\" aria-label=\"Header font size in points\" />\n          </div>\n          <div class=\"control compact\">\n            <label class=\"control-label\">Subheader (pt)</label>\n            <input class=\"control-input\" type=\"number\" min=\"14\" max=\"72\" step=\"1\" v-model.number=\"subheaderFontPt\" aria-label=\"Subheader font size in points\" />\n          </div>\n          <div class=\"control compact\">\n            <label class=\"control-label\">Body (pt)</label>\n            <input class=\"control-input\" type=\"number\" min=\"8\" max=\"48\" step=\"0.5\" v-model.number=\"bodyFontPt\" aria-label=\"Body font size in points\" />\n          </div>\n        </div>\n\n        <div class=\"toolbar-right\">\n          <!-- <div class=\"control checkbox-control\">\n            <label>\n              <input type=\"checkbox\" v-model=\"showUsername\" />\n              <span>Show author credit</span>\n            </label>\n          </div> -->\n          <div class=\"control checkbox-control\">\n            <label>\n              <input type=\"checkbox\" v-model=\"showGridOverlay\" />\n              <span>Layout grid</span>\n            </label>\n          </div>\n          <div class=\"control\">\n            <button class=\"btn secondary\" @click=\"resetLayoutDefaults\">Reset Layout</button>\n          </div>\n        </div>\n      </div>\n\n      <div ref=\"monacoContainer\" class=\"editor\" aria-label=\"Markdown editor\" tabindex=\"0\" @click=\"focusEditor\"></div>\n    </div>\n\n    <div ref=\"viewerContainer\" class=\"viewer\" aria-label=\"Document preview\"></div>\n\n  </div>\n</template>\n\n<script>\nimport * as monaco from 'monaco-editor';\nimport { parse } from './Parser';\nimport domtoimage from 'dom-to-image-more';\nimport JSZip from 'jszip';\nimport * as FileSaver from 'file-saver';\nimport { PDFDocument, StandardFonts, rgb } from 'pdf-lib';\n//import CustomDropdown from './CustomDropdown.vue';\n\nexport default {\n  name: 'ThingsEditor',\n  //components: { CustomDropdown },\n\n  data() {\n    return {\n      documentType: \"info\",\n      columnCount: 2,\n\n      docWidth: 1275,\n      docHeight: 1650,\n      headerFontPx: 58.333333333333336,\n      subheaderFontPx: 50,\n      bodyFontPx: 25,\n\n      dpi: 150,\n      headerFontPt: 28,\n      subheaderFontPt: 24,\n      bodyFontPt: 12,\n\n      isSaving: false,\n      warningText: '',\n\n      username: '',\n\n      selectedItemType: '',\n      selectedPageType: '',\n      selectedSnippet: '',\n\n      showGridOverlay: false,\n      showUsername: true,\n\n      layoutDefaults: {\n        width: 1275,\n        height: 1650,\n        dpi: 150,\n        headerPt: 28,\n        subheaderPt: 24,\n        bodyPt: 12\n      }\n    };\n  },\n\n  mounted() {\n\n    setInterval(() => {\n      const model = this._monacoEditor ? this._monacoEditor.getModel() : null;\n      if (model && model.getValue().length > 0) {\n        this.isSaving = true;\n        this.saveState();\n        setTimeout(() => this.isSaving = false, 1000);\n      }\n    }, 20000);\n\n    // Only auto-load saved state if there is no existing content in the editor\n    // setTimeout(() => {\n    //   if (this._monacoEditor) {\n    //   const model = this._monacoEditor.getModel();\n    //   if (model && !model.getValue()) {\n    //     this.loadState();\n    //   }\n    //   }\n    // }, 500);\n\n    this.$nextTick(() => {\n      this.tick();\n\n      // set initial header color; the background image will be applied to\n      // the document root inside renderMarkdown so it scales and aligns with\n      // the document content.\n      const container = this.$refs.viewerContainer;\n      if (container) {\n        if (this.documentType === 'info') {\n          container.style.setProperty('--header-color', '#0067a9');\n        } else {\n          container.style.setProperty('--header-color', '#8349a4');\n        }\n      }\n\n      this.$watch('documentType', () => {\n        const viewerContent = this.$refs.viewerContainer && this.$refs.viewerContainer.querySelector('.viewer-content');\n\n        switch (this.documentType) {\n          case 'info':\n            if (viewerContent) {\n              viewerContent.style.backgroundImage = \"url('../assets/documents/blue-page.png')\";\n              viewerContent.style.backgroundSize = '100% 100%';\n              viewerContent.style.backgroundRepeat = 'no-repeat';\n              viewerContent.style.backgroundPosition = 'top left';\n            }\n            if (this.$refs.viewerContainer) this.$refs.viewerContainer.style.setProperty('--header-color', '#0067a9');\n            break;\n          case 'lore':\n            if (viewerContent) {\n              viewerContent.style.backgroundImage = \"url('../assets/documents/lore-sheet.png')\";\n              viewerContent.style.backgroundSize = '100% 100%';\n              viewerContent.style.backgroundRepeat = 'no-repeat';\n              viewerContent.style.backgroundPosition = 'top left';\n            }\n            if (this.$refs.viewerContainer) this.$refs.viewerContainer.style.setProperty('--header-color', '#8349a4');\n            break;\n        }\n\n      });\n\n      this.$watch('username', () => {\n        // update username displays on all pages\n        const viewer = this.$refs.viewerContainer;\n        if (viewer) {\n          for (const page of viewer.querySelectorAll('.page')) {\n            const usernameDisplay = page.querySelector('.username-display');\n            if (usernameDisplay) {\n              usernameDisplay.textContent = (document.querySelector('.username-input') ? document.querySelector('.username-input').value.trim() : '');\n            }\n          }\n        }\n      });\n    });\n  },\n\n  beforeUnmount() {\n    // dispose Monaco editor and observers when component is removed\n    try {\n      if (this._monacoEditor) {\n        this._monacoEditor.dispose();\n        this._monacoEditor = null;\n      }\n    } catch (e) { }\n\n    try {\n      if (this._viewerResizeObserver) {\n        this._viewerResizeObserver.disconnect();\n        this._viewerResizeObserver = null;\n      }\n    } catch (e) { }\n\n    try {\n      if (this._editorResizeObserver) {\n        this._editorResizeObserver.disconnect();\n        this._editorResizeObserver = null;\n      }\n    } catch (e) { }\n    try { if (window && window.__thingsEditor) delete window.__thingsEditor; } catch (e) { }\n  },\n\n  methods: {\n\n    updateUsernameDisplays() {\n      const viewer = this.$refs.viewerContainer;\n      if (viewer) {\n        for (const page of viewer.querySelectorAll('.page')) {\n          const usernameDisplay = page.querySelector('.username-display');\n          if (usernameDisplay) {\n            usernameDisplay.textContent = 'Authored by: ' + (document.querySelector('.username-input') ? document.querySelector('.username-input').value.trim() : '');\n          }\n        }\n      }\n    },\n\n    onItemDropdownSelect(event) {\n      console.log('Item dropdown changed:', event);\n      if (event.target.value === \"sample_javelin\") {\n        this.onInsertSelect({\n          value: [\n            \"/equipment mythic JAVELIN OF THE SKIES\",\n            \"/type Fast Weapon, Mythical\",\n            \"/cost 7040 Silver Pieces\",\n            \"/next\",\n            \"/tag Attack Speed: 1 Turn Action\",\n            \"/tag Handling: 2 hands\",\n            \"/tag Range: 15 meters (Ranged)\",\n            \"/tag Size: 27 slots\",\n            \"/next\",\n            \"/damage 7d4 Energy Damage\",\n            \"/desc Attacks made with this weapon affect all creatures within a 1 meter wide line, originating from the user, extending out to the weapon's range. Tests for accuracy do not need to be made.\",\n            \"/desc This weapon is sentient, sensing objects and creatures within 10 meters of it, and can communicate basic emotions directly to its user.\",\n            \"/desc Damage dealt by this weapon ignores defenses.\",\n            \"/desc This weapon requires 1 stamina to attack with. This weapon consumes 1 cell during each attack. Ammunition used this way must be equipped on the user's back or waist slot.\",\n            \"/next\",\n            \"/flavor One of three weapons a part of the Nine Divines. It uses its sentience to implore progress and calculated improvement. Naturally, it hovers between the two hands of its user, firing trailing shards of lightning at high speeds.\",\n            \"/craft 1 Mythical Material Component\",\n            \"/craft 4 Mythical Refinement Components\",\n            \"/craft 3 Mythical Power Components\",\n            \"/end\"\n          ].join('\\n')\n        });\n      }\n      else if (event.target.value === \"equipment\") {\n        this.onInsertSelect({\n          value: [\n            \"/equipment <rarity> <name>\",\n            \"/type\",\n            \"/cost\",\n            \"/next\",\n            \"/tag <tag>\",\n            \"/next\",\n            \"/damage 7d4 <damageType> Damage\",\n            \"/desc <description>\",\n            \"/next\",\n            \"/flavor <flavor text>\",\n            \"/craft <quantity> <component>\",\n            \"/end\"\n          ].join('\\n')\n        });\n      }\n      else if (event.target.value === \"sample_specialist_table\") {\n        this.onInsertSelect({\n          value: [\n            \"/page talent 1\",\n            \"/specialist\",\n            \"/title Arcane Specialist Talents\",\n            \"/desc Arcane specialist talents are used to push a caster when putting spells together, allowing for significant versatility. Some require that the caster have a specific talent within the Magecraft tree, others require that the caster can simply cast spells at all, even less require specific trait scores.\",\n            \"Subtle Spells | Must have at least one talent from the **Magecraft** core talent tree. | You may cast spells without making any physical or audible gestures. Creatures gaina point of favor on tests made to resist spells cast this way. You may cast spells 2 meters through a medium rather than 1.\",\n            \"Mystical Cognizance | Must have the **Subtle Spells** specialist talent. | When casting spells with no physical gestures, creatures do not gain a point of favor on tests made to resist spells cast this way. You may cast spells 3 meters through a medium rather than 2.\",\n            \"Arcane Withdrawal | Must know the Art of **Enchantment.** | You may spend 6 turn actions to undo a permanent spell that you cast, given you are within 1 meter of the spell's effects.\",\n            \"In Tune | Must have a **Will** score of 10 or higher. | Your spellcap is equal to your **Will** score. If you have no Spellcap, spells you cast cost less stamina by an amount equal to your **Soul** score.\",\n            \"Enlightened | Must have the **In Tune** specialist talent.\\\\nMust be able to use at least three **Arcane Arts.** | Your Spellcap is equal to double your **Will** score. If you have no Spellcap, spells you cast cost less stamina by an amount equal to your **Mind** score.\",\n            \"Occult Mind | Must have at least one talent rom the **Magecraft** core talent tree. | You gain 2 points of favor on tests made to resist losing Focus or breaking Concentration.\",\n            \"Pyromancy | Must know the Art of **Evocation.** | You may cast spells that deal only Heat damage and cost 3 stamina or less after discounts without spending any stamina.\",\n            \"Cryomancy | Must know the Art of **Evocation.** | You may cast spells that deal only Chill damage and cost 3 stamina or less after discounts without spending any stamina.\",\n            \"/end\"\n          ].join('\\n')\n        })\n      }\n      else if (event.target.value === \"sample_spell\") {\n        this.onInsertSelect({\n          value: [\n            \"/page equipment 1\",\n            \"/spell DISPEL\",\n            \"/type Utility\",\n            \"/arts Enchantment, Illusion, Necromancy, Evocation\",\n            \"/next\",\n            \"/tag Duration: Immediate\",\n            \"/tag Range: Touch\",\n            \"/tag AOE: Target Spell\",\n            \"/next\",\n            \"/stamina 5 TIMES X STAMINA\",\n            \"/desc You grasp something affected by a spell, methodically unweaving its runes. If a creature is currently focusing or concentrating on the spell, it makes a Will contest against you. Given the spell is no older than X hours and any apposing creatures fail their test, the spell ends.\",\n            \"/end\"\n          ].join('\\n')\n        })\n      }\n      else if (event.target.value === \"sample_species_profile\") {\n        this.onInsertSelect({\n          value: [\n            \"/page species 1\",\n            \"# {Species Profile}\",\n            \"/spacing 24\",\n            \"## The Verdant\", \n            \"**Traits:** Graceful, Empathic, Photosynthetic\",\n            \"**Size:** Medium | **Speed:** 9 meters\",\n            \"- Gain favor on tests to sense plants or natural toxins\",\n            \"- Can photosynthesize to recover 1 stamina every 10 minutes in bright light\",\n            \"- Suffers disadvantage on perception tests taken underground\",\n            \"/spacing 18\",\n            \"### Culture\",\n            \"The Verdant are a communal people who weave living architecture. Their homes are coaxed from sturdy reeds and sung into shape over the course of weeks.\",\n            \"/spacing 18\",\n            \"### Hooks\",\n            \"1. A Verdant elder asks the party to escort a migratory seed to fertile soil.\",\n            \"2. The settlement's water-garden is mysteriously blighted.\",\n            \"3. Rival wood-cutters have begun logging sacred groves.\",\n            \"/end\"\n          ].join('\\n')\n        });\n      }\n      else if (event.target.value === \"sample_lore_excerpt\") {\n        this.onInsertSelect({\n          value: [\n            \"/page lore 2\",\n            \"# Excerpt from the Journal of Arcanist Vela\",\n            \"The stormglass hums louder each night. Waves of color press against the panes, forming sigils I almost comprehend.\",\n            \"/spacing 12\",\n            \"> \\\"If the prism fractures, the Wake will spill unchecked through the streets.\\\"\",\n            \"/spacing 12\",\n            \"## Field Notes\",\n            \"- The Wake resonates with bronze alloys, not silver.\",\n            \"- Divination artistries lose potency within seven kilometers of the lighthouse.\",\n            \"- Enchantment weaves linger longer where the Wake is thickest.\",\n            \"/spacing 12\",\n            \"### Closing\",\n            \"Tomorrow we open the sluice gates and see if the tide will listen.\",\n            \"/end\"\n          ].join('\\n')\n        });\n      }\n      // Reset dropdown after insert\n      this.selectedItemType = \"\";\n    },\n\n    onSnippetDropdownSelect(event) {\n      const snippetKey = event && event.target ? event.target.value : '';\n      if (!snippetKey) {\n        return;\n      }\n\n      const snippets = {\n        'note-callout': [\n          '/note info Readying for Expedition',\n          'Pack climbing rigging, one spare wake-stone, and at least two doses of nighthoney.',\n          '/end'\n        ],\n        'two-column-quote': [\n          '/col',\n          '### Scholar\\'s Margin',\n          'The Wake trends strongest near ley convergence sites.',\n          '/col',\n          '> \\\"Measure the silence before you measure the sound.\\\"\\n>  Archivist Rhys',\n          '/col'\n        ],\n        'lore-facts': [\n          '### Lore Fragments',\n          '- Wake currents flow quickest beneath vaulted ceilings.',\n          '- Necromancy glyphs dim in the presence of auric stones.',\n          '- Evocation prisms ring like crystal when overstressed.'\n        ],\n        'stat-block': [\n          '/page gameplay 3',\n          '### Clockwork Sentry',\n          '**Level:** 5 | **Disposition:** Guarded',\n          '**Traits:** Construct, Vigilant, Heavy',\n          '/spacing 8',\n          '**Motive:** Protect the sealed vault',\n          '**Vitality:** 46 | **Guard:** 18 | **Resolve:** 12',\n          '/spacing 12',\n          '**Attacks:**',\n          '- Arm Pike  +8 vs Guard, 2d8 Piercing + Push 1',\n          '- Wake Pulse  +6 vs Resolve, 2d6 Radiant, target is **Dazed**',\n          '/spacing 12',\n          '**Protocol:** Gains favor on tests while within 5 meters of a control node.'\n        ]\n      };\n\n      const snippet = snippets[snippetKey];\n      if (snippet) {\n        this.onInsertSelect({ value: snippet.join('\\n') });\n      }\n\n      this.selectedSnippet = '';\n    },\n\n    onPageDropdownSelect(event) {\n      const pageType = event.target.value;\n      if (pageType) {\n        this.onInsertSelect({ value: `/page ${pageType} 1` });\n        // Reset dropdown after insert\n        this.selectedPageType = \"\";\n      }\n    },\n\n    onEquipmentButtonClick() {\n      this.onItemDropdownSelect();\n    },\n\n    onPageButtonClick(type) {\n      this.selectedPageType = type;\n      this.onPageDropdownSelect();\n    },\n\n    loadSampleDocument(kind) {\n      if (!this._monacoEditor) return;\n\n      const samples = {\n        'starter-pack': [\n          '/page blue 1',\n          '# Welcome to Things',\n          'The **Things Editor** lets you rapidly build printable sheets.',\n          '/spacing 16',\n          '## Getting Started',\n          'Use `/page <color> <number>` to start each sheet.',\n          'Swap columns with `/col`.',\n          'Close blocks like `/note` or `/equipment` with `/end`.',\n          '/spacing 18',\n          '### Quick Legend',\n          '**Bold** items call attention to important rules.',\n          '*Italics* mark optional flavor text.',\n          'Links like [Myramyth Website](https://myramyth.com/utopia) are allowed (though they won\\'t work when exported).',\n          '/spacing 24',\n          '/note **Handy Commands**',\n          'Try `/lore` for purple callouts or `/toc begin` to build a table of contents.',\n          '/end',\n          '/page blue 2',\n          '# Sample Lore Spread',\n          '/spacing 12',\n          '### The Singing Wake',\n          'Every sixty years the Wake changes pitch, harmonizing with previously silent ruins.',\n          '/spacing 12',\n          '/col',\n          '/spacing -30',\n          '#### Rumors',\n          'Hidden choirs beneath the city keep the Wake docile.',\n          'The royal archivist hoards broken wake-stones.',\n          'Free-tide sailors can hear storms days in advance.',\n          '/spacing 12',\n          '#### Adventure Seeds',\n          'Hunt a missing conductor before the Wake resonance fails.',\n          'Protect a caravan bringing new tuning forks to the capital.',\n          'Sabotage rival enchantments that disrupt the city\\'s rhythm.',\n          '/page yellow 3',\n          '# Encounter Sketch',\n          '### Gilded Promenade',\n          'The promenade is split across three balconies connected by floating stairs.',\n          '/spacing 12',\n          '#### Features',\n          'Crystal balustrades grant cover but shatter when struck (Guard 14).',\n          'Wake vents blast upward each round, relocating anyone nearby.',\n          'Two control obelisks tune the promenade. Both must be struck within the same round to disable the vents.',\n          '/spacing 12',\n          '#### Tactics',\n          '**Clockwork Sentries** hold the high ground.',\n          '**Wake Adepts** attempt to knock foes into the vents.',\n          'The promenade guardian arrives at round 4 if the obelisks remain active.'\n        ].join('\\n')\n      };\n\n      const sample = samples[kind];\n      if (!sample) {\n        return;\n      }\n\n      let shouldReplace = !this._monacoEditor.getValue();\n      if (!shouldReplace) {\n        const canConfirm = typeof window !== 'undefined' && typeof window.confirm === 'function';\n        shouldReplace = canConfirm ? window.confirm('Replace the current document with the starter packet?') : true;\n      }\n      if (!shouldReplace) {\n        return;\n      }\n\n      this._monacoEditor.setValue(sample);\n      this.selectedItemType = '';\n      this.selectedPageType = '';\n      this.selectedSnippet = '';\n    },\n\n    loadState() {\n      const content = localStorage.getItem('things-editor-content');\n      console.log('Loaded content:', content);\n      if (typeof content === 'string' && this._monacoEditor) {\n        const editor = this._monacoEditor;\n        const model = editor.getModel();\n        if (model) {\n          const current = model.getValue();\n          // avoid replacing the model value if identical (prevents focus/selection loss)\n          if (content !== current) {\n            let selection = null;\n            let hadFocus = false;\n            try {\n              selection = editor.getSelection();\n              hadFocus = document.activeElement && (this.$refs.monacoContainer && this.$refs.monacoContainer.contains(document.activeElement));\n            } catch (e) { }\n\n            model.setValue(content);\n\n            try {\n              if (selection) editor.setSelection(selection);\n              if (hadFocus) editor.focus();\n            } catch (e) { }\n          }\n        }\n      }\n    },\n\n    saveState() {\n      // simple throttle to avoid blocking UI with many writes\n      const now = Date.now();\n      if (this._lastSave && now - this._lastSave < 200) return;\n      this._lastSave = now;\n\n      if (!this._monacoEditor) return;\n      const model = this._monacoEditor.getModel();\n      if (!model) return;\n      const content = model.getValue();\n      try {\n        localStorage.setItem('things-editor-content', content);\n      } catch (e) {\n        console.warn('Failed to save to localStorage:', e);\n      }\n      console.log('Saved content:', content);\n    },\n\n    tick() {\n      const container = this.$refs.monacoContainer;\n      const viewerContainer = this.$refs.viewerContainer;\n\n      if (container && viewerContainer) {\n        // Register a small custom language that highlights our Parser commands\n        try {\n          monaco.languages.register({ id: 'utopia' });\n\n          monaco.languages.setMonarchTokensProvider('utopia', {\n            defaultToken: 'invalid',\n            keywords: [],\n            typeKeywords: [],\n            operators: [],\n            symbols: /[-+*/=<>!]+/,\n            escapes: /\\\\(?:[abfnrtv\\\\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,\n\n            tokenizer: {\n              root: [\n                // commands that start a line: /page, /col, /note, /end, /spacing, /page-num\n                [/^\\/(page|column|note|info|lore|end|spacing|page-num|advanced|toc)\\b/i, 'utopia.command'],\n                // page types used with /page commands (case-insensitive)\n                [/(equipment|gameplay|info|lore|species|talent|toc|advanced)\\b/i, 'utopia.pagetype'],\n                // talents\n                [/\\/(specialist)\\b/i, 'utopia.talent'],\n                // equipment, spells (case-insensitive)\n                [/\\/(equipment|spell)\\b/i, 'utopia.equipment'],\n                [/\\/(type|cost|tag|damage|desc|flavor|craft)\\b/i, 'utopia.equipment'],\n                // rarity colors (match common variants and be case-insensitive)\n                [/\\bcrude\\b/i, 'utopia.crude'],\n                [/\\bcommon\\b/i, 'utopia.common'],\n                [/\\buncommon\\b/i, 'utopia.uncommon'],\n                [/\\brare\\b/i, 'utopia.rare'],\n                [/\\blegendary\\b/i, 'utopia.legendary'],\n                [/\\bmythic(?:al)?\\b/i, 'utopia.mythical'],\n                // comment\n                [/^\\/\\/\\s+(.*)$/i, 'utopia.comment'],\n                // numeric values\n                [/\\b\\d+\\b/, 'number'],\n                // markdown-style headings\n                [/^#{1,6}[^\\n]*/, 'utopia.heading'],\n                // bold / italic inline (simple)\n                [/\\*\\*(.+?)\\*\\*/, 'utopia.strong'],\n                [/\\*(.+?)\\*/, 'utopia.emphasis'],\n                // escaped characters (use Monarch reference to the escapes pattern)\n                [/@escapes/, 'string.escape'],\n                [/\\n/, 'string.escape'],\n                // table cells\n                [/[A-Za-z0-9\\s]+(?=\\||$)/, 'table-cell'],\n                // whitespace (consume spaces so word-based rules can match at word-start)\n                [/[ \\t]+/, ''],\n                // pipes\n                [/\\|/, 'delimiter.pipe'],\n                // everything else (avoid consuming pipes so pipe token can match)\n                [/[^|\\n]+/, '']\n              ]\n            }\n          });\n\n          monaco.editor.defineTheme('utopia-theme', {\n            base: 'vs-dark',\n            inherit: true,\n            rules: [\n              { token: 'utopia.command', foreground: 'FFA500', fontStyle: 'bold' }, // orange\n              { token: 'utopia.pagetype', foreground: '00e5ff' }, // cyan\n              { token: 'utopia.equipment', foreground: 'ff79c6' }, // pink\n\n              { token: 'utopia.comment', foreground: '6272a4' }, // blue\n\n              { token: 'utopia.talent', foreground: 'ffb86c' }, // light orange\n\n              { token: 'utopia.crude', foreground: '8f9092' },\n              { token: 'utopia.common', foreground: '737790' },\n              { token: 'utopia.uncommon', foreground: '809a7d' },\n              { token: 'utopia.rare', foreground: 'c0b985' },\n              { token: 'utopia.legendary', foreground: 'b78e70' },\n              { token: 'utopia.mythical', foreground: 'a7645b' },\n\n              { token: 'table-cell', foreground: 'ff965d' },\n\n              { token: 'utopia.heading', foreground: 'ffd166', fontStyle: 'bold' }, // gold\n              { token: 'number', foreground: 'c792ea' }, // purple\n              { token: 'utopia.strong', fontStyle: 'bold' },\n              { token: 'utopia.emphasis', fontStyle: 'italic' },\n\n              { token: 'string.escape', foreground: 'ff79c6' }, // pink\n              { token: 'delimiter.pipe', foreground: 'ffd166' } // white\n            ],\n            colors: {\n              'editor.background': '#1e1e1e'\n            }\n          });\n        } catch (e) {\n          // If Monaco already registered the language, ignore errors and continue\n          console.warn('Monaco language/theme registration issue:', e);\n        }\n\n        const editor = monaco.editor.create(container, {\n          language: 'utopia',\n          wordWrap: 'on',\n          theme: 'utopia-theme'\n        });\n\n        // focus editor so keyboard input is accepted immediately\n        try {\n          editor.focus();\n        } catch (e) {\n          // ignore focus errors in test environments\n        }\n\n        // expose the monaco editor instance for toolbar actions\n        this._monacoEditor = editor;\n        // also expose to window for quick debugging in the browser console\n        try { window.__thingsEditor = editor; } catch (e) { }\n\n        const renderMarkdown = () => {\n          const content = editor.getValue();\n\n          // if (editor && (content.trim().length === 0 || !/^\\/page\\s+(equipment|gameplay|info|lore|species|talent|toc|advanced)\\s+(.+)$/i.test(content.split('\\n')[0]))) {\n          //   // if the editor is empty, show a warning\n          //   this.warningText = 'No pages defined. Add a page with /page <type> <number> (e.g. /page info 1) at the start of the document.';\n          // }\n          // else {\n          //   this.warningText = '';\n          // }\n          this.warningText = '';\n\n\n          viewerContainer.innerHTML = '';\n\n          // create a document-root sized to the Illustrator pixels\n          const viewer = document.createElement('div');\n          viewer.className = 'viewer-content';\n          viewer.style.width = this.docWidth + 'px';\n          viewer.style.height = this.docHeight + 'px';\n\n          // const documentImage = document.createElement('img');\n          // documentImage.classList.add('document-image');\n          // documentImage.src = this.documentType === 'info' ? '../assets/documents/blue-page.png' : '../assets/documents/lore-sheet.png';\n          // viewer.appendChild(documentImage);\n\n          // set font-size vars so styles are pixel-accurate\n          viewer.style.setProperty('--header-font-px', this.headerFontPx + 'px');\n          viewer.style.setProperty('--subheader-font-px', this.subheaderFontPx + 'px');\n          viewer.style.setProperty('--body-font-px', this.bodyFontPx + 'px');\n          viewer.style.setProperty('--doc-height', this.docHeight + 'px');\n          viewer.style.setProperty('--doc-width', this.docWidth + 'px');\n          //viewer.style.setProperty('--page-background', this.documentType === 'info' ? \"url('../assets/documents/blue-page.png')\" : \"url('../assets/documents/lore-sheet.png')\");\n          // set background image on the document root so it remains aligned\n          // with the content when scaled and when the window resizes\n          const themeBackgrounds = {\n            info: \"url('../assets/documents/blue-page.png')\",\n            lore: \"url('../assets/documents/lore-sheet.png')\"\n          };\n          const themeColors = {\n            info: '#0067a9',\n            lore: '#8349a4'\n          };\n\n          const backgroundImage = themeBackgrounds[this.documentType] || themeBackgrounds.info;\n          const headerColor = themeColors[this.documentType] || themeColors.info;\n\n          viewer.style.backgroundImage = backgroundImage;\n          viewer.style.setProperty('--header-color', headerColor);\n          viewer.style.backgroundSize = '100% 100%';\n          viewer.style.backgroundRepeat = 'no-repeat';\n          viewer.style.backgroundPosition = 'top left';\n\n          if (this.showGridOverlay) {\n            viewer.classList.add('viewer-grid');\n          }\n\n          const parsedContent = parse(content, this.columnCount);\n          viewer.appendChild(parsedContent);\n          viewerContainer.appendChild(viewer);\n\n          if (this.showUsername) {\n            for (const page of viewer.querySelectorAll('.page')) {\n              const usernameDisplay = document.createElement('div');\n              usernameDisplay.className = 'username-display';\n              usernameDisplay.textContent = 'Authored by: ' + (document.querySelector('.username-input') ? document.querySelector('.username-input').value.trim() : '');\n              page.appendChild(usernameDisplay);\n            }\n          }\n\n          // compute scaling to fit the viewer area while preserving pixel font sizes\n          this.updateScale();\n        };\n\n        renderMarkdown();\n\n        // Use the editor-level change event so we catch user edits\n        editor.onDidChangeModelContent(() => {\n          renderMarkdown();\n        });\n\n        // watchers for the pixel-perfect controls\n        this.$watch('docWidth', () => {\n          // force re-render so sizing updates\n          renderMarkdown();\n        });\n        this.$watch('docHeight', () => renderMarkdown());\n        this.$watch('headerFontPx', () => {\n          // keep pt in sync\n          this.headerFontPt = this.pxToPt(this.headerFontPx, this.dpi);\n          this.updateVars();\n        });\n        this.$watch('bodyFontPx', () => {\n          this.bodyFontPt = this.pxToPt(this.bodyFontPx, this.dpi);\n          this.updateVars();\n        });\n        this.$watch('columnCount', () => renderMarkdown());\n\n        this.$watch('dpi', () => {\n          // recompute px from pt when DPI changes\n          this.headerFontPx = this.ptToPx(this.headerFontPt, this.dpi);\n          this.subheaderFontPx = this.ptToPx(this.subheaderFontPt, this.dpi);\n          this.bodyFontPx = this.ptToPx(this.bodyFontPt, this.dpi);\n          renderMarkdown();\n        });\n\n        this.$watch('headerFontPt', () => {\n          this.headerFontPx = this.ptToPx(this.headerFontPt, this.dpi);\n          this.updateVars();\n        });\n\n        this.$watch('subheaderFontPt', () => {\n          this.subheaderFontPx = this.ptToPx(this.subheaderFontPt, this.dpi);\n          this.updateVars();\n        });\n\n        this.$watch('bodyFontPt', () => {\n          this.bodyFontPx = this.ptToPx(this.bodyFontPt, this.dpi);\n          this.updateVars();\n        });\n\n        this.$watch('documentType', () => renderMarkdown());\n        this.$watch('showUsername', () => renderMarkdown());\n        this.$watch('showGridOverlay', () => renderMarkdown());\n\n        // Resize observer to recompute scale when viewer size changes\n        if (window.ResizeObserver) {\n          const ro = new ResizeObserver(() => this.updateScale());\n          ro.observe(viewerContainer);\n          this._viewerResizeObserver = ro;\n        } else {\n          window.addEventListener('resize', this.updateScale.bind(this));\n        }\n        // also re-layout the monaco editor on container resize\n        if (container) {\n          const roEditor = window.ResizeObserver ? new ResizeObserver(() => {\n            try { editor.layout(); } catch (e) { }\n          }) : null;\n          if (roEditor) {\n            roEditor.observe(container);\n            this._editorResizeObserver = roEditor;\n          } else {\n            window.addEventListener('resize', () => { try { editor.layout(); } catch (e) { } });\n          }\n        }\n      }\n    },\n\n    focusEditor() {\n      if (this._monacoEditor) {\n        try { this._monacoEditor.focus(); } catch (e) { }\n      } else if (this.$refs && this.$refs.monacoContainer) {\n        try { this.$refs.monacoContainer.focus(); } catch (e) { }\n      }\n    },\n\n    onInsertSelect(option) {\n      if (!this._monacoEditor) return;\n      const insertText = option && option.value ? option.value : '';\n      const model = this._monacoEditor.getModel();\n      const pos = this._monacoEditor.getPosition();\n      if (!model || !pos) {\n        // fallback: append to end\n        const full = model.getValue();\n        model.setValue(full + '\\n' + insertText + '\\n');\n        return;\n      }\n\n      // perform an edit at the current cursor\n      this._monacoEditor.executeEdits('insert-dropdown', [{\n        range: new monaco.Range(pos.lineNumber, pos.column, pos.lineNumber, pos.column),\n        text: insertText + '\\n',\n        forceMoveMarkers: true\n      }]);\n\n      // focus editor after inserting\n      this._monacoEditor.focus();\n    },\n\n    exportImage: async function () {\n      const viewerContainer = this.$refs.viewerContainer;\n      if (!viewerContainer) return;\n\n      try {\n        // Discard the first instance of the toPng to correct object alignment\n        // eslint-disable-next-line\n        await domtoimage.toPng(viewerContainer);\n\n        const pages = Array.from(document.querySelectorAll('.page'));\n        if (pages.length === 0) {\n          console.warn('No pages found to export.');\n          alert('No pages found to export.');\n          return;\n        }\n\n        const zip = new JSZip();\n        const usedPageNumbers = [];\n\n        // Render each page to PNG and add to the zip. Prefer toBlob if available.\n        for (let i = 0; i < pages.length; i++) {\n          const page = pages[i];\n          var pageNumber = page.querySelector('.page-number') ? page.querySelector('.page-number').textContent.trim() : `page-${i + 1}`;\n\n          if (usedPageNumbers.includes(pageNumber)) {\n            console.warn(`Duplicate page number found: ${pageNumber}`);\n            alert(`Duplicate page number found: ${pageNumber}`);\n            pageNumber = `${pageNumber} - ${i}`;\n          }\n\n          usedPageNumbers.push(pageNumber);\n\n          try {\n            let blob = null;\n\n            if (domtoimage && typeof domtoimage.toBlob === 'function') {\n              // dom-to-image-more exposes toBlob in many builds\n              blob = await domtoimage.toBlob(page);\n            } else {\n              const dataUrl = await domtoimage.toPng(page);\n              // Convert dataURL to blob so JSZip stores binary data correctly\n              blob = (function dataURLtoBlob(dataurl) {\n                const arr = dataurl.split(',');\n                const mime = arr[0].match(/:(.*?);/)[1];\n                const bstr = atob(arr[1]);\n                let n = bstr.length;\n                const u8arr = new Uint8Array(n);\n                while (n--) {\n                  u8arr[n] = bstr.charCodeAt(n);\n                }\n                return new Blob([u8arr], { type: mime });\n              })(dataUrl);\n            }\n\n            if (blob) {\n              zip.file(`${pageNumber}.png`, blob);\n              console.log(`Added ${pageNumber}.png (${blob.size} bytes) to ZIP`);\n            } else {\n              console.warn(`No blob produced for page ${i + 1}`);\n            }\n          } catch (err) {\n            console.error(`Error exporting page ${i + 1}:`, err);\n          }\n        }\n\n        // Generate the zip and trigger download\n        const content = await zip.generateAsync({ type: 'blob' });\n        // Try FileSaver first, then fallback to creating an object URL and clicking an anchor.\n        try {\n          FileSaver.saveAs(content, 'document.zip');\n          console.log('ZIP generated and download triggered via FileSaver');\n        } catch (err) {\n          console.warn('FileSaver failed, falling back to anchor method:', err);\n          try {\n            const url = URL.createObjectURL(content);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = 'document.zip';\n            document.body.appendChild(a);\n            a.click();\n            a.remove();\n            // allow time for the download to start before revoking\n            setTimeout(() => URL.revokeObjectURL(url), 10000);\n            console.log('ZIP generated and download triggered via anchor fallback');\n          } catch (err2) {\n            console.error('Anchor fallback failed to save the zip:', err2);\n            alert('Failed to trigger download. Check console for details.');\n          }\n        }\n      } catch (error) {\n        console.error('Error creating ZIP:', error);\n      }\n    },\n\n    exportPdf: async function () {\n      const viewerContainer = this.$refs.viewerContainer;\n      if (!viewerContainer) return;\n\n      const pages = Array.from(viewerContainer.querySelectorAll('.page'));\n      if (pages.length === 0) {\n        console.warn('No pages found to export.');\n        alert('No pages found to export.');\n        return;\n      }\n\n      try {\n        const pdfDoc = await PDFDocument.create();\n        const fonts = {\n          regular: await pdfDoc.embedFont(StandardFonts.Helvetica),\n          bold: await pdfDoc.embedFont(StandardFonts.HelveticaBold),\n          italic: await pdfDoc.embedFont(StandardFonts.HelveticaOblique),\n          boldItalic: await pdfDoc.embedFont(StandardFonts.HelveticaBoldOblique)\n        };\n\n        const pageWidthPt = this.pxToPt(this.docWidth, this.dpi);\n        const pageHeightPt = this.pxToPt(this.docHeight, this.dpi);\n\n        for (let i = 0; i < pages.length; i++) {\n          const pageElement = pages[i];\n          const pdfPage = pdfDoc.addPage([pageWidthPt, pageHeightPt]);\n\n          // capture the rendered page as an image for backgrounds and artwork\n          try {\n            const dataUrl = await domtoimage.toPng(pageElement);\n            const pngImage = await pdfDoc.embedPng(dataUrl);\n            pdfPage.drawImage(pngImage, {\n              x: 0,\n              y: 0,\n              width: pageWidthPt,\n              height: pageHeightPt,\n              opacity: 0.35\n            });\n          } catch (imgErr) {\n            console.warn(`Unable to capture background for page ${i + 1}:`, imgErr);\n          }\n\n          const pageRect = pageElement.getBoundingClientRect();\n          const scale = pageRect.width > 0 ? pageRect.width / this.docWidth : 1;\n          const textBlocks = this._collectTextBlocks(pageElement);\n\n          for (const element of textBlocks) {\n            const computed = window.getComputedStyle(element);\n            if (computed.display === 'none' || computed.visibility === 'hidden') {\n              continue;\n            }\n\n            const normalizedText = this._normalizeTextContent(element.innerText);\n            if (!normalizedText) continue;\n\n            const elementRect = element.getBoundingClientRect();\n            const paddingLeft = parseFloat(computed.paddingLeft) || 0;\n            const paddingRight = parseFloat(computed.paddingRight) || 0;\n            const paddingTop = parseFloat(computed.paddingTop) || 0;\n\n            const widthPx = Math.max(0, (elementRect.width / scale) - paddingLeft - paddingRight);\n            if (widthPx <= 0) continue;\n\n            const xPx = (elementRect.left - pageRect.left) / scale + paddingLeft;\n            const yTopPx = (elementRect.top - pageRect.top) / scale + paddingTop;\n\n            const fontSizePx = parseFloat(computed.fontSize) || this.bodyFontPx;\n            const lineHeightPx = computed.lineHeight === 'normal'\n              ? fontSizePx * 1.2\n              : parseFloat(computed.lineHeight) || fontSizePx * 1.2;\n\n            const fontSizePt = this.pxToPt(fontSizePx, this.dpi);\n            const lineHeightPt = this.pxToPt(lineHeightPx, this.dpi);\n            const maxWidthPt = this.pxToPt(widthPx, this.dpi);\n\n            const font = this._resolveFont(computed, fonts);\n            const { color, opacity } = this._cssColorToRgb(computed.color, parseFloat(computed.opacity));\n\n            const lines = this._wrapTextIntoLines(font, normalizedText, fontSizePt, maxWidthPt);\n            if (!lines.length) continue;\n\n            let cursorY = pageHeightPt - this.pxToPt(yTopPx, this.dpi) - fontSizePt;\n            const align = computed.textAlign || 'left';\n\n            for (const line of lines) {\n              const lineWidth = font.widthOfTextAtSize(line, fontSizePt);\n              let lineX = this.pxToPt(xPx, this.dpi);\n\n              if (align === 'center') {\n                lineX += Math.max(0, (maxWidthPt - lineWidth) / 2);\n              } else if (align === 'right') {\n                lineX += Math.max(0, maxWidthPt - lineWidth);\n              }\n\n              pdfPage.drawText(line, {\n                x: lineX,\n                y: cursorY,\n                size: fontSizePt,\n                font,\n                color,\n                opacity\n              });\n              cursorY -= lineHeightPt;\n              if (cursorY < -pageHeightPt) {\n                break;\n              }\n            }\n          }\n        }\n\n        const pdfBytes = await pdfDoc.save();\n        const blob = new Blob([pdfBytes], { type: 'application/pdf' });\n\n        try {\n          FileSaver.saveAs(blob, 'document.pdf');\n        } catch (err) {\n          console.warn('FileSaver failed, falling back to anchor method:', err);\n          try {\n            const url = URL.createObjectURL(blob);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = 'document.pdf';\n            document.body.appendChild(a);\n            a.click();\n            a.remove();\n            setTimeout(() => URL.revokeObjectURL(url), 10000);\n          } catch (err2) {\n            console.error('Failed to trigger PDF download:', err2);\n            alert('Failed to export PDF. Check console for details.');\n          }\n        }\n      } catch (error) {\n        console.error('Error creating PDF:', error);\n        alert('Failed to export PDF. Check console for details.');\n      }\n    },\n\n    _collectTextBlocks(root) {\n      const blocks = [];\n      const visit = (element) => {\n        if (!(element instanceof HTMLElement)) return;\n        const tagName = element.tagName ? element.tagName.toLowerCase() : '';\n        if (tagName === 'script' || tagName === 'style') return;\n        if (element.classList.contains('page-watermark')) return;\n\n        const style = window.getComputedStyle(element);\n        if (style.display === 'none' || style.visibility === 'hidden' || parseFloat(style.opacity) === 0) {\n          return;\n        }\n\n        const children = Array.from(element.children).filter(child => {\n          const childStyle = window.getComputedStyle(child);\n          return childStyle.display !== 'none' && childStyle.visibility !== 'hidden' && parseFloat(childStyle.opacity) !== 0;\n        });\n\n        const hasBlockChild = children.some(child => {\n          const display = window.getComputedStyle(child).display;\n          return display !== 'inline' && display !== 'contents';\n        });\n\n        const hasTextNode = Array.from(element.childNodes).some(node => node.nodeType === Node.TEXT_NODE && node.textContent && node.textContent.trim().length > 0);\n\n        const display = style.display;\n        const isBlockLike = display !== 'inline' && display !== 'contents';\n\n        if (hasTextNode && isBlockLike && !hasBlockChild) {\n          blocks.push(element);\n        }\n\n        for (const child of children) {\n          visit(child);\n        }\n      };\n\n      visit(root);\n      return blocks;\n    },\n\n    _cssColorToRgb(colorString, opacity = 1) {\n      const normalizedOpacity = Number.isFinite(opacity) ? opacity : 1;\n      if (!colorString || typeof colorString !== 'string') {\n        return { color: rgb(0, 0, 0), opacity: Math.max(0, Math.min(1, normalizedOpacity)) };\n      }\n\n      const rgbaMatch = colorString.match(/rgba?\\((\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)(?:\\s*,\\s*([\\d.]+))?\\)/i);\n      if (rgbaMatch) {\n        const r = Math.min(255, parseInt(rgbaMatch[1], 10) || 0) / 255;\n        const g = Math.min(255, parseInt(rgbaMatch[2], 10) || 0) / 255;\n        const b = Math.min(255, parseInt(rgbaMatch[3], 10) || 0) / 255;\n        const a = rgbaMatch[4] !== undefined ? parseFloat(rgbaMatch[4]) : 1;\n        const finalOpacity = Number.isFinite(a) ? a * normalizedOpacity : normalizedOpacity;\n        return { color: rgb(r, g, b), opacity: Math.max(0, Math.min(1, finalOpacity)) };\n      }\n\n      const hexMatch = colorString.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i);\n      if (hexMatch) {\n        let hex = hexMatch[1];\n        if (hex.length === 3) {\n          hex = hex.split('').map(ch => ch + ch).join('');\n        }\n        const intVal = parseInt(hex, 16);\n        const r = ((intVal >> 16) & 255) / 255;\n        const g = ((intVal >> 8) & 255) / 255;\n        const b = (intVal & 255) / 255;\n        return { color: rgb(r, g, b), opacity: Math.max(0, Math.min(1, normalizedOpacity)) };\n      }\n\n      return { color: rgb(0, 0, 0), opacity: Math.max(0, Math.min(1, normalizedOpacity)) };\n    },\n\n    _resolveFont(style, fonts) {\n      const weight = style.fontWeight;\n      const isBold = weight === 'bold' || weight === 'bolder' || (parseInt(weight, 10) || 0) >= 600;\n      const fontStyle = style.fontStyle;\n      const isItalic = fontStyle === 'italic' || fontStyle === 'oblique';\n\n      if (isBold && isItalic) return fonts.boldItalic;\n      if (isBold) return fonts.bold;\n      if (isItalic) return fonts.italic;\n      return fonts.regular;\n    },\n\n    _normalizeTextContent(text) {\n      if (!text || typeof text !== 'string') return '';\n      return text\n        .replace(/\\u00A0/g, ' ')\n        .replace(/[\\t\\r]+/g, ' ')\n        .replace(/\\s+\\n/g, '\\n')\n        .replace(/\\n\\s+/g, '\\n')\n        .replace(/ +/g, ' ')\n        .trim();\n    },\n\n    _wrapTextIntoLines(font, text, fontSize, maxWidth) {\n      if (!text || typeof text !== 'string') return [];\n      if (!font || !Number.isFinite(fontSize) || fontSize <= 0) {\n        return text.split('\\n');\n      }\n\n      if (!Number.isFinite(maxWidth) || maxWidth <= 0) {\n        return text.split('\\n');\n      }\n\n      const lines = [];\n      const paragraphs = text.split('\\n');\n\n      for (const paragraph of paragraphs) {\n        const trimmedParagraph = paragraph.trim();\n        if (!trimmedParagraph) {\n          lines.push('');\n          continue;\n        }\n\n        const words = trimmedParagraph.split(' ');\n        let currentLine = '';\n\n        for (const rawWord of words) {\n          const word = rawWord.trim();\n          if (!word) continue;\n\n          const candidate = currentLine ? `${currentLine} ${word}` : word;\n          const candidateWidth = font.widthOfTextAtSize(candidate, fontSize);\n\n          if (candidateWidth <= maxWidth) {\n            currentLine = candidate;\n            continue;\n          }\n\n          if (currentLine) {\n            lines.push(currentLine);\n            currentLine = '';\n          }\n\n          const wordWidth = font.widthOfTextAtSize(word, fontSize);\n          if (wordWidth <= maxWidth) {\n            currentLine = word;\n            continue;\n          }\n\n          const fragments = this._breakWordIntoChunks(font, word, fontSize, maxWidth);\n          if (fragments.length) {\n            for (let i = 0; i < fragments.length - 1; i++) {\n              lines.push(fragments[i]);\n            }\n            currentLine = fragments[fragments.length - 1];\n          } else {\n            currentLine = word;\n          }\n        }\n\n        if (currentLine) {\n          lines.push(currentLine);\n        } else if (trimmedParagraph.length === 0) {\n          lines.push('');\n        }\n      }\n\n      return lines;\n    },\n\n    _breakWordIntoChunks(font, word, fontSize, maxWidth) {\n      if (!word) return [];\n      const chunks = [];\n      let current = '';\n\n      for (const char of Array.from(word)) {\n        const candidate = current + char;\n        const width = font.widthOfTextAtSize(candidate, fontSize);\n\n        if (width <= maxWidth || current.length === 0) {\n          current = candidate;\n        } else {\n          chunks.push(current);\n          current = char;\n        }\n      }\n\n      if (current) {\n        chunks.push(current);\n      }\n\n      return chunks;\n    },\n\n    resetLayoutDefaults() {\n      if (!this.layoutDefaults) return;\n      this.docWidth = this.layoutDefaults.width;\n      this.docHeight = this.layoutDefaults.height;\n      this.dpi = this.layoutDefaults.dpi;\n      this.headerFontPt = this.layoutDefaults.headerPt;\n      this.subheaderFontPt = this.layoutDefaults.subheaderPt;\n      this.bodyFontPt = this.layoutDefaults.bodyPt;\n    },\n\n    updateScale() {\n      this.$nextTick(() => {\n        const viewerContainer = this.$refs.viewerContainer;\n        if (!viewerContainer) return;\n        const viewer = viewerContainer.querySelector('.viewer-content');\n        if (!viewer) return;\n\n        const containerW = viewerContainer.clientWidth;\n        const containerH = viewerContainer.clientHeight;\n        const docW = parseFloat(this.docWidth || 1);\n        const docH = parseFloat(this.docHeight || 1);\n\n        const scaleX = containerW / docW;\n        const scaleY = containerH / docH;\n        const scale = Math.min(scaleX, scaleY, 1);\n\n        const scaledW = docW * scale;\n        const scaledH = docH * scale;\n        const offsetX = containerW > scaledW ? (containerW - scaledW) / 2 : 0;\n        const offsetY = containerH > scaledH ? (containerH - scaledH) / 2 : 0;\n\n        viewer.style.transformOrigin = 'top left';\n        viewer.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;\n        viewer.style.setProperty('--scale', scale);\n      });\n    },\n\n    updateVars() {\n      this.$nextTick(() => {\n        const viewerContainer = this.$refs.viewerContainer;\n        if (!viewerContainer) return;\n        const viewer = viewerContainer.querySelector('.viewer-content');\n        if (!viewer) return;\n        viewer.style.setProperty('--header-font-px', this.headerFontPx + 'px');\n        viewer.style.setProperty('--subheader-font-px', this.subheaderFontPx + 'px');\n        viewer.style.setProperty('--body-font-px', this.bodyFontPx + 'px');\n      });\n    }\n\n    // Helper: convert points to pixels for a given DPI.\n    // 1pt = 1/72 inch. px = pt * dpi / 72\n    , ptToPx(pt, dpi) {\n      return (parseFloat(pt) || 0) * (parseFloat(dpi) || 72) / 72;\n    }\n\n    // Helper: convert pixels to points for a given DPI.\n    , pxToPt(px, dpi) {\n      return (parseFloat(px) || 0) * 72 / (parseFloat(dpi) || 72);\n    }\n  }\n};\n</script>\n\n<style lang=\"css\">\n:root {\n  --doc-height: 1650px;\n  --doc-width: 1275px;\n  --page-background: white;\n\n  --toolbar-bg: rgba(0, 0, 0, 0.35);\n  --toolbar-fg: #fff;\n  --control-bg: rgba(255, 255, 255, 0.06);\n  --accent: #2f9adf;\n\n  --line-width: 5px;\n  --line-offset: -38px;\n  /* how far left from origin */\n  --line-shadow: 0 2px 6px rgba(0, 0, 0, 0.9);\n\n  --info-background: url('@/assets/documents/blue-page.png');\n  --lore-background: url('@/assets/documents/lore-sheet.png');\n  --equipment-background: url('@/assets/documents/equipment-sheet.png');\n  --species-background: url('@/assets/documents/species-sheet.png');\n  --talent-background: url('@/assets/documents/yellow-page.png');\n  --toc-background: url('@/assets/documents/toc-sheet.png');\n  --gameplay-background: url('@/assets/documents/gameplay-sheet.png');\n  --advanced-background: url('@/assets/documents/advanced-sheet.png');\n\n  --purple-background: url('@/assets/documents/purple-page.png');\n  --red-background: url('@/assets/documents/red-page.png');\n  --yellow-background: url('@/assets/documents/yellow-page.png');\n  --blue-background: url('@/assets/documents/blue-page.png');\n  --green-background: url('@/assets/documents/green-page.png');\n  --orange-background: url('@/assets/documents/orange-page.png');\n  --pink-background: url('@/assets/documents/pink-page.png');\n\n  --header-color: #000000;\n  --page-color: #000000;\n\n  --info-color: #0c4e81;\n  --lore-color: #32004b;\n  --equipment-color: #a36209;\n  --species-color: #007236;\n  --talent-color: #aba835;\n  --toc-color: #72103e;\n  --gameplay-color: #a36209;\n  --advanced-color: #a21d21;\n\n  --info-page-number: #203e62;\n  --lore-page-number: #39164e;\n  --equipment-page-number: #794d12;\n  --species-page-number: #00582c;\n  --talent-page-number: #706800;\n  --toc-page-number: #79314a;\n  --gameplay-page-number: #794d12;\n  --advanced-page-number: #712d24;\n\n  --rarity-crude: #8f9092;\n  --rarity-common: #737790;\n  --rarity-uncommon: #809a7d;\n  --rarity-rare: #c0b985;\n  --rarity-legendary: #b78e70;\n  --rarity-mythic: #a7645b;\n\n  --equipment-tags: url('@/assets/blocks/equipment-tags.png');\n  --equipment-description: url('@/assets/blocks/equipment-description.png');\n  --equipment-flavor: url('@/assets/blocks/equipment-flavor.png');\n\n  --section-1-border: url('@/assets/blocks/equipment-section-1-border.png');\n  --section-2-border: url('@/assets/blocks/equipment-section-2-border.png');\n  --section-3-border: url('@/assets/blocks/equipment-section-3-border.png');\n\n  --section-1-bg: #a3a4a6;\n  --section-2-bg: #cccccc;\n  --section-3-bg: #e0e0de;\n\n  --frame-crude: url('@/assets/blocks/rarity-border-crude.png');\n  --frame-common: url('@/assets/blocks/rarity-border-common.png');\n  --frame-uncommon: url('@/assets/blocks/rarity-border-uncommon.png');\n  --frame-rare: url('@/assets/blocks/rarity-border-rare.png');\n  --frame-legendary: url('@/assets/blocks/rarity-border-legendary.png');\n  --frame-mythic: url('@/assets/blocks/rarity-border-mythic.png');\n  --frame-edge: 48px;\n  --section-border-size: 48px;\n  --edge-top: 64;\n  --edge-right: 64;\n  --edge-bottom: 64;\n  --edge-left: 64;\n\n  --artistry-enchantment: url('@/assets/artistries/enchantment.svg');\n  --artistry-alteration:  url('@/assets/artistries/alteration.svg');\n  --artistry-array:  url('@/assets/artistries/array.svg');\n  --artistry-divination: url('@/assets/artistries/divination.svg');\n  --artistry-evocation:  url('@/assets/artistries/evocation.svg');\n  --artistry-illusion: url('@/assets/artistries/illusion.svg');\n  --artistry-necromancy:  url('@/assets/artistries/necromancy.svg');\n  --artistry-wake:  url('@/assets/artistries/wake.svg');  \n\n  --specialist-table: url('@/assets/blocks/specialist-table.png');\n}\n\n@font-face {\n  font-family: \"Rockwell Nova Condensed\";\n  src: url('~@/assets/fonts/RockwellNovaCond.woff') format('woff');\n  font-weight: normal;\n  font-style: normal;\n  font-display: swap;\n}\n\n@font-face {\n  font-family: \"Rockwell Nova Condensed\";\n  src: url('~@/assets/fonts/RockwellNovaCond-Bold.woff') format('woff');\n  font-weight: bold;\n  font-style: normal;\n  font-display: swap;\n}\n\n@font-face {\n  font-family: \"Rockwell Nova\";\n  src: url('~@/assets/fonts/RockwellNova.woff') format('woff');\n  font-weight: normal;\n  font-style: normal;\n  font-display: swap;\n}\n\n@font-face {\n  font-family: \"Rockwell Nova\";\n  src: url('~@/assets/fonts/RockwellNova-Bold.woff') format('woff');\n  font-weight: bold;\n  font-style: normal;\n  font-display: swap;\n}\n\n@font-face {\n  font-family: \"Bahnschrift\";\n  src: url('~@/assets/fonts/Bahnschrift.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n  font-display: swap;\n}\n\n.main-container {\n  background-color: #2b2b2b;\n  display: flex;\n  gap: 24px;\n  align-items: stretch;\n  height: 100vh;\n  padding: 20px;\n  box-sizing: border-box;\n}\n\n.editor-container {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  width: 48%;\n  height: 100%;\n}\n\n.editor-toolbar {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 12px;\n  padding: 10px;\n  background: var(--toolbar-bg);\n  color: var(--toolbar-fg);\n  border-radius: 8px;\n  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.5);\n  flex-wrap: wrap;\n}\n\n.editor-toolbar .toolbar-left,\n.editor-toolbar .toolbar-center,\n.editor-toolbar .toolbar-right {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.editor-toolbar.toolbar-advanced {\n  align-items: center;\n  justify-content: space-between;\n}\n\n.control {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  color: #e6eef6;\n}\n\n.control.compact {\n  flex-direction: row;\n  align-items: center;\n}\n\n.control.checkbox-control {\n  flex-direction: row;\n  align-items: center;\n  gap: 8px;\n}\n\n.control.checkbox-control label {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  cursor: pointer;\n  font-size: 12px;\n}\n\n.control.checkbox-control input[type=\"checkbox\"] {\n  width: 16px;\n  height: 16px;\n}\n\n.control-label {\n  font-size: 12px;\n  opacity: 0.9;\n}\n\n.control-select,\n.control-input {\n  background: #f0f0f0;\n  color: #000;\n  border: 1px solid rgba(255, 255, 255, 0.06);\n  padding: 6px 8px;\n  border-radius: 6px;\n  min-width: 64px;\n}\n\n.control-input[type=number] {\n  width: 80px;\n}\n\n.username-input {\n  width: 160px;\n}\n\n.btn {\n  appearance: none;\n  border: 0;\n  padding: 10px 16px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 600;\n}\n\n.btn.primary {\n  background: linear-gradient(180deg, var(--accent), #176fa6);\n  color: white;\n  box-shadow: 0 6px 14px rgba(34, 139, 199, 0.25);\n}\n\n.editor {\n  width: calc(100% - 20px);\n  height: calc(100% - 20px);\n  text-align: left;\n}\n\n.viewer {\n  width: 52%;\n  height: calc(100% - 0px);\n  display: flex;\n  justify-content: flex-start;\n  align-items: flex-start;\n  position: relative;\n  overflow: auto;\n  background: linear-gradient(180deg, #f3f2f0 0%, #dcdcdc 100%);\n  padding: 12px;\n  border-radius: 8px;\n}\n\n.viewer-content {\n  text-align: left;\n  transform-origin: top left;\n  will-change: transform;\n  background-clip: padding-box;\n  background-origin: padding-box;\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.35);\n  border-radius: 6px;\n  position: relative;\n}\n\n.viewer-content.viewer-grid::after {\n  content: '';\n  position: absolute;\n  inset: 0;\n  pointer-events: none;\n  background-image:\n    linear-gradient(rgba(0, 0, 0, 0.12) 1px, transparent 1px),\n    linear-gradient(90deg, rgba(0, 0, 0, 0.12) 1px, transparent 1px),\n    linear-gradient(rgba(0, 0, 0, 0.2) 4px, transparent 4px),\n    linear-gradient(90deg, rgba(0, 0, 0, 0.2) 4px, transparent 4px);\n  background-size: 48px 48px, 48px 48px, 240px 240px, 240px 240px;\n  opacity: 0.25;\n  mix-blend-mode: multiply;\n}\n\n.page {\n  min-width: var(--doc-width);\n  max-width: var(--doc-width);\n  min-height: var(--doc-height, 1650px);\n  max-height: var(--doc-height, 1650px);\n  position: relative;\n}\n\n.page-watermark {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%) rotate(-60deg);\n  opacity: 0.05;\n  font-size: 320px;\n  font-family: \"Rockwell Nova Condensed\";\n  font-weight: bold;\n  color: #ff0000;\n  pointer-events: none;\n  user-select: none;\n  z-index: 1;\n}\n\n.username-display {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 20px;\n  font-size: 18px;\n  font-family: \"Bahnschrift\";\n  color: #000000;\n  z-index: 5;\n  text-align: center;\n}\n\n.page.page-equipment {\n  background: var(--equipment-background);\n  --header-color: var(--equipment-color);\n  --page-color: var(--equipment-page-number);\n}\n\n.page.page-gameplay {\n  background: var(--gameplay-background);\n  --header-color: var(--gameplay-color);\n  --page-color: var(--gameplay-page-number);\n}\n\n.page.page-info {\n  background: var(--info-background);\n  --header-color: var(--info-color);\n  --page-color: var(--info-page-number);\n}\n\n.page.page-lore {\n  background: var(--lore-background);\n  --header-color: var(--lore-color);\n  --page-color: var(--lore-page-number);\n}\n\n.page.page-species {\n  background: var(--species-background);\n  --header-color: var(--species-color);\n  --page-color: var(--species-page-number);\n}\n\n.page.page-talent {\n  display: flex;\n  gap: 25px;\n  flex-wrap: nowrap;\n\n  background: var(--yellow-background);\n  --header-color: var(--talent-color);\n  --page-color: var(--talent-page-number);\n}\n\n.page.page-toc {\n  background: var(--toc-background);\n  --header-color: var(--toc-color);\n  --page-color: var(--toc-page-number);\n}\n\n.page.page-advanced {\n  background: var(--advanced-background);\n  --header-color: var(--advanced-color);\n  --page-color: var(--advanced-page-number);\n}\n\n.page.page-purple {\n  background: var(--purple-background);\n  --header-color: var(--lore-color);\n  --page-color: var(--lore-page-number);\n}\n\n.page.page-red {\n  background: var(--red-background);\n  --header-color: var(--advanced-color);\n  --page-color: var(--advanced-page-number);\n}\n\n.page.page-yellow {\n  background: var(--yellow-background);\n  --header-color: var(--talent-color);\n  --page-color: var(--talent-page-number);\n}\n\n.page.page-blue {\n  background: var(--blue-background);\n  --header-color: var(--info-color);\n  --page-color: var(--info-page-number);\n}\n\n.page.page-green {\n  background: var(--green-background);\n  --header-color: var(--species-color);\n  --page-color: var(--species-page-number);\n}\n\n.page.page-orange {\n  background: var(--orange-background);\n  --header-color: var(--equipment-color);\n  --page-color: var(--equipment-page-number);\n}\n\n.page.page-pink {\n  background: var(--pink-background);\n  --header-color: var(--gameplay-color);\n  --page-color: var(--gameplay-page-number);\n}\n\n.page h1 {\n  color: var(--header-color, #573084);\n  font-family: \"Rockwell Nova Condensed\";\n  font-weight: bold;\n  font-size: var(--header-font-px, 28pt);\n  line-height: 1.15;\n  margin: 0 0 28px;\n}\n\n.page h1.span-2 {\n  position: absolute;\n  left: 150px;\n  /* align with page-content left */\n  top: 125px;\n  /* adjust vertically to sit above page content */\n  width: calc(459px * 2 + 58px);\n  /* two columns + gap */\n  z-index: 6;\n  margin: 0 0 18px;\n  box-sizing: border-box;\n}\n\n.page.has-span-2 .column {\n  padding-top: 120px;\n}\n\n.page h2 {\n  color: var(--header-color, #573084);\n  font-family: \"Rockwell Nova Condensed\";\n  font-weight: bold;\n  font-size: var(--subheader-font-px, 24pt);\n  line-height: 1.15;\n  margin: 38px 0 -5px;\n}\n\n.page h3 {\n  color: var(--header-color, #573084);\n  font-family: \"Rockwell Nova Condensed\";\n  font-weight: bold;\n  font-size: var(--subheader-font-px, 24pt);\n  line-height: 1.15;\n  margin: 38px 0 -5px;\n}\n\n.page h4 {\n  color: var(--header-color, #573084);\n  font-family: \"Rockwell Nova Condensed\";\n  font-weight: bold;\n  font-size: 46px;\n  line-height: 1.15;\n  margin: 28px 0 -5px;\n}\n\n.page p {\n  color: black;\n  font-family: \"Bahnschrift\";\n  font-size: var(--body-font-px, 12px);\n  margin: 0 0 30px;\n  line-height: 1.2;\n}\n\n.page-content {\n  position: absolute;\n  left: 150px;\n  top: 120px;\n  display: flex;\n  gap: 50px;\n}\n\n.page.page-talent .page-content {\n  left: 175px;\n  right: 175px;\n  top: 100px;\n  display: flex;\n  flex-direction: row;\n  position: relative;\n  align-content: center;\n  justify-content: center;\n  gap: 16px;\n  overflow: none;\n}\n\n.page.page-talent .page-content .talent-tree {\n  flex: 1;\n  max-width: 300px;\n  min-width: 300px;\n  /* fixed width to match column */\n  overflow: visible;\n  padding-right: 10px;\n  box-sizing: border-box;\n}\n\n.full-column {\n  width: calc(459px * 2 + 58px);\n}\n\n.talent-content {\n  position: absolute;\n  bottom: 230px;\n  display: flex;\n  flex-direction: column;\n  gap: 0px;\n  left: -175px;\n  right: -175px;\n  width: 137%;\n  height: 250px;\n  justify-content: center;\n  align-content: center;\n  align-items: center;\n}\n\n.talent-label {\n  position: relative;\n  left: -4px;\n  right: 0;\n  text-align: center;\n  font-size: 66px;\n  font-family: \"Bahnschrift\";\n  font-weight: bold;\n}\n\n.talent-description {\n  font-size: 22px;\n  font-family: \"Bahnschrift\";\n  text-align: center;\n  position: relative;\n  top: -10px;\n}\n\n.column {\n  max-width: 465px;\n  min-width: 465px;\n}\n\n.column h1,\n.column h2,\n.column h3,\n.column p {\n  padding-right: 5px;\n  word-wrap: break-word;\n}\n\n.column p:first-of-type {\n  margin-top: 5px;\n}\n\n.page-number {\n  color: var(--page-color);\n  font-family: \"Rockwell Nova\";\n  font-weight: bold;\n  position: absolute;\n  bottom: 25px;\n  font-size: 56px;\n  width: 100%;\n  text-align: center;\n}\n\n.note.lore {\n  color: black;\n  font-family: \"Bahnschrift\";\n  font-size: var(--body-font-px, 12px);\n  margin: 0;\n  margin-bottom: 30px;\n  line-height: 1.2;\n}\n\n.note {\n  position: relative;\n}\n\n.note::before {\n  content: \"\";\n  position: absolute;\n  top: 110px;\n  bottom: 110px;\n  left: var(--line-offset);\n  /* negative to push it out to the left */\n  width: var(--line-width);\n  /* fixed horizontal size  prevents horizontal growth */\n  background-image: linear-gradient(to right, #a7a9ac 100%, #d1d3d4 110%, #a7a9ac 120%);\n  pointer-events: none;\n  z-index: 4;\n  /* place under/over content as needed */\n  /* filter: drop-shadow(1px 2px 2px rgba(0,0,0,0.3)); */\n  border-radius: 2px;\n  /* optional subtle rounding */\n}\n\n.note-content {\n  position: relative;\n  z-index: 4;\n}\n\n.box {\n  z-index: 3;\n  position: absolute;\n}\n\n.box-gradient {\n  top: -10px;\n  left: -35px;\n  right: -35px;\n  bottom: -10px;\n  background: radial-gradient(circle at center, #00b6f1, #1c75bc);\n  border-radius: 25px;\n  z-index: 1;\n  opacity: 0.3;\n}\n\n.box-top-left {\n  top: -20px;\n  left: -40px;\n}\n\n.box-bottom-left {\n  z-index: 5;\n  bottom: -20px;\n  left: -40px;\n}\n\n.box-top-right {\n  top: -20px;\n  right: -40px;\n}\n\n.box-bottom-right {\n  bottom: -20px;\n  right: -40px;\n}\n\n.box-left {\n  z-index: 3;\n  top: 0;\n  left: -39px;\n  bottom: 0;\n  width: 8px;\n  /* fixed horizontal size so background cannot expand horizontally */\n  height: 100%;\n  transform: none;\n  position: absolute;\n  /* Prevent overflow, stretch to content height */\n  max-height: 100%;\n  pointer-events: none;\n  /* If using SVG as background, make it stretch vertically */\n  /* map the background to the fixed width (100% of 6px) and full height */\n  background-size: 100% 100%;\n  background-repeat: no-repeat;\n  backdrop-filter: drop-shadow(0 0 5px rgba(0, 0, 0, 1));\n}\n\n/* Responsive: stack editor/viewer on narrow windows */\n@media (max-width: 1100px) {\n  .main-container {\n    flex-direction: column;\n    padding: 12px;\n  }\n\n  .editor-container,\n  .viewer {\n    width: 100%;\n  }\n\n  .editor {\n    height: 360px;\n  }\n}\n\n.equipment {\n  position: relative;\n  background: var(--equipment-background);\n  background-clip: padding-box;\n  /* dont paint behind the border */\n  isolation: isolate;\n\n  /* border-image as before */\n  border: 5px solid transparent;\n  border-image-source: var(--frame);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--frame-edge);\n  border-image-repeat: round;\n}\n\n/* map each rarity class to a custom property used by the pseudo element */\n.equipment.rarity-crude {\n  --equipment-background: var(--rarity-crude);\n  --frame: var(--frame-crude);\n}\n\n.equipment.rarity-common {\n  --equipment-background: var(--rarity-common);\n  --frame: var(--frame-common);\n}\n\n.equipment.rarity-uncommon {\n  --equipment-background: var(--rarity-uncommon);\n  --frame: var(--frame-uncommon);\n}\n\n.equipment.rarity-rare {\n  --equipment-background: var(--rarity-rare);\n  --frame: var(--frame-rare);\n}\n\n.equipment.rarity-legendary {\n  --equipment-background: var(--rarity-legendary);\n  --frame: var(--frame-legendary);\n}\n\n.equipment.rarity-mythic {\n  --equipment-background: var(--rarity-mythic);\n  --frame: var(--frame-mythic);\n}\n\n.equipment-content {\n  position: relative;\n  background-clip: content-box;\n  z-index: 1;\n  padding-top: 10px;\n  padding-left: 10px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  gap: 4px;\n}\n\n.equipment-title {\n  font-family: \"Bahnschrift\";\n  font-weight: bold;\n  font-size: 21.5px;\n}\n\n.equipment-detail {\n  font-family: \"Bahnschrift\";\n  font-size: 18px;\n  z-index: 10;\n  position: relative;\n}\n\n.equipment-detail.cost {\n  color: white;\n}\n\n.equipment-detail.tag {\n  font-family: \"Bahnschrift\";\n  font-size: 21.5px;\n  margin-bottom: 5px;\n  margin-top: 2px;\n}\n\n.equipment-tag-type {\n  font-weight: bold;\n}\n\n.equipment-detail.damage {\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 21px;\n  font-weight: bold;\n  margin-top: 13px;\n  margin-bottom: 25px;\n  text-align: center;\n}\n\n.equipment-detail.desc {\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 20.51px;\n  margin-bottom: 25px;\n  line-height: 1.22;\n}\n\n.equipment-detail.flavor {\n  color: #585858;\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 20.7px;\n  margin-bottom: 23px;\n  margin-top: 13px;\n  line-height: 1.23;\n  text-align: center;\n}\n\n.equipment-detail.craft {\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 20.7px;\n  margin-bottom: 1px;\n}\n\n.equipment-section {\n  position: relative;\n  margin-top: 2px;\n  /* reserve space for the border on all sides */\n  padding-left: 3px;\n  padding-top: 10px;\n  margin-left: 5px;\n  /* clip the background so it doesnt render under the border */\n  background: var(--section-bg);\n  background-clip: padding-box;\n  /* no background behind the border:contentReference[oaicite:0]{index=0} */\n  /* optional: rounded corners if your frame has them */\n  border-radius: 4px;\n}\n\n.equipment-section.section-1 {\n  background-color: var(--section-1-bg);\n  /* draw the torn frame; reuse your existing border image variables */\n  border: 2px solid transparent;\n  border-image-source: var(--section-1-border);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--section-border-size);\n  border-image-repeat: round;\n}\n\n.equipment-section.section-2 {\n  padding-left: 0px;\n  background-color: var(--section-2-bg);\n  /* draw the torn frame; reuse your existing border image variables */\n  border: 5px solid transparent;\n  border-image-source: var(--section-2-border);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--section-border-size);\n  border-image-repeat: round;\n}\n\n.equipment-section.section-3 {\n  padding-left: 11px;\n  padding-right: 9px;\n  padding-bottom: 30px;\n  text-align: center;\n  background-color: var(--section-3-bg);\n  /* draw the torn frame; reuse your existing border image variables */\n  border: 5px solid transparent;\n  border-image-source: var(--section-3-border);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--section-border-size);\n  border-image-repeat: round;\n}\n\n.spell {\n  position: relative;\n  background: var(--rarity-crude);\n  background-clip: padding-box;\n  /* dont paint behind the border */\n  isolation: isolate;\n\n  /* border-image as before */\n  border: 5px solid transparent;\n  border-image-source: var(--frame-crude);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--frame-edge);\n  border-image-repeat: round;\n}\n\n.spell-content {\n  position: relative;\n  background-clip: content-box;\n  z-index: 1;\n  padding-top: 10px;\n  padding-left: 10px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  gap: 4px;\n}\n\n.spell-title {\n  font-family: \"Bahnschrift\";\n  font-weight: bold;\n  font-size: 21.5px;\n}\n\n.spell-detail {\n  font-family: \"Bahnschrift\";\n  font-size: 18px;\n  z-index: 10;\n  position: relative;\n}\n\n.spell-detail.arts {\n  color: white;\n}\n\n.spell-detail.tag {\n  font-family: \"Bahnschrift\";\n  font-size: 21.5px;\n  margin-bottom: 5px;\n  margin-top: 2px;\n}\n\n.spell-tag-type {\n  font-weight: bold;\n}\n\n.spell-detail.stamina,\n.spell-detail.sta {\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 21px;\n  font-weight: bold;\n  margin-top: 13px;\n  margin-bottom: 25px;\n  text-align: center;\n}\n\n.spell-detail.desc {\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 20.51px;\n  margin-bottom: 25px;\n  line-height: 1.22;\n  text-align: center;\n}\n\n.spell-detail.flavor {\n  color: #585858;\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 20.7px;\n  margin-bottom: 23px;\n  margin-top: 13px;\n  line-height: 1.23;\n  text-align: center;\n}\n\n.spell-detail.craft {\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 20.7px;\n  margin-bottom: 1px;\n}\n\n.spell-section {\n  position: relative;\n  margin-top: 2px;\n  /* reserve space for the border on all sides */\n  padding-left: 3px;\n  padding-top: 10px;\n  margin-left: 5px;\n  /* clip the background so it doesnt render under the border */\n  background: var(--section-bg);\n  background-clip: padding-box;\n  /* no background behind the border:contentReference[oaicite:0]{index=0} */\n  /* optional: rounded corners if your frame has them */\n  border-radius: 4px;\n}\n\n.spell-section.section-1 {\n  background-color: var(--section-1-bg);\n  /* draw the torn frame; reuse your existing border image variables */\n  border: 2px solid transparent;\n  border-image-source: var(--section-1-border);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--section-border-size);\n  border-image-repeat: round;\n}\n\n.spell-section.section-2 {\n  padding-left: 0px;\n  background-color: var(--section-2-bg);\n  /* draw the torn frame; reuse your existing border image variables */\n  border: 5px solid transparent;\n  border-image-source: var(--section-2-border);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--section-border-size);\n  border-image-repeat: round;\n  position: relative;\n}\n\n.spell-section .artistry-container {\n  display: flex;\n  align-items: center;\n  gap: 0px;\n  position: absolute;\n  left: 0; right: 0; top: 0; bottom: 0;\n  height: 100%;\n  width: 100%;\n  pointer-events: none;\n  opacity: 0.2;\n}\n\n.spell-section .artistry-container-1 {\n  justify-content: center;\n}\n\n.spell-section .artistry-container-2 {\n  justify-content: space-around;\n}\n\n.spell-section .artistry-container-3,\n.spell-section .artistry-container-4,\n.spell-section .artistry-container-5,\n.spell-section .artistry-container-6 {\n  justify-content: center;\n}\n\n.spell-section .artistry-container-3 .artistry-icon:nth-child(odd),\n.spell-section .artistry-container-4 .artistry-icon:nth-child(odd),\n.spell-section .artistry-container-5 .artistry-icon:nth-child(odd),\n.spell-section .artistry-container-6 .artistry-icon:nth-child(odd) {\n  position: relative;\n  top: -25px;\n}\n.spell-section .artistry-container-3 .artistry-icon:nth-child(even),\n.spell-section .artistry-container-4 .artistry-icon:nth-child(even),\n.spell-section .artistry-container-5 .artistry-icon:nth-child(even),\n.spell-section .artistry-container-6 .artistry-icon:nth-child(even) {\n  position: relative;\n  bottom: -25px;\n}\n\n.artistry-icon {\n  position: relative;\n  width: 100px;\n  height: 100px;\n  background-size: contain;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n\n.artistry-enchantment {\n  background-image: var(--artistry-enchantment);\n}\n.artistry-alteration {\n  background-image: var(--artistry-alteration);\n}\n.artistry-array {\n  background-image: var(--artistry-array);\n}\n.artistry-divination {\n  background-image: var(--artistry-divination);\n}\n.artistry-evocation {\n  background-image: var(--artistry-evocation);\n}\n.artistry-illusion {\n  background-image: var(--artistry-illusion);\n}\n.artistry-necromancy {\n  background-image: var(--artistry-necromancy);\n}\n.artistry-wake {\n  background-image: var(--artistry-wake);\n}\n\n\n.toc-entry {\n  font-family: \"Bahnschrift\";\n  display: flex;\n  gap: 20px;\n  justify-content: space-between;\n  font-size: 22px;\n}\n\n.toc-title {\n  font-weight: bold;\n}\n\n.toc-page {\n  color: gray;\n}\n\n.specialist-table {\n  position: absolute;\n  inset: 0;\n  background-image: var(--specialist-table);\n}\n\n.specialist-header {\n  position: absolute;\n  top: 93px;\n  left: 105px;\n  padding-right: 119px;\n  word-wrap: break-word;\n  word-break: break-all;\n  hyphens: auto;\n  -webkit-hyphens: auto;\n  -moz-hyphens: auto;\n  -ms-hyphens: auto;\n  font-family: \"Bahnschrift\";\n}\n\n.specialist-content {\n  inset: 251px 88px 163px 105px;\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\n.specialist-row.header {\n  position: absolute;\n  top: 211px;\n  left: 105px;\n  font-family: \"Bahnschrift\";\n  display: grid;\n  grid-template-columns: 281px 285px 1fr;\n  gap: 0;\n}\n\n.specialist-row.header .specialist-cell.cell-1,\n.specialist-row.header .specialist-cell.cell-2,\n.specialist-row.header .specialist-cell.cell-3 {\n  font-size: 25px;\n  font-weight: bold;\n}\n\n.specialist-row {\n  flex: 1;\n  align-items: center;\n  display: grid;\n  grid-template-columns: 292px 282px 1fr;\n}\n\n.specialist-cell {\n  font-size: 19.5px;\n  font-family: \"Bahnschrift\";\n}\n\n.specialist-cell.cell-1 {\n  font-weight: bold;\n}\n\n.specialist-cell.cell-2 {\n  letter-spacing: 0.2px;\n  font-size: 20.5px;\n  padding-right: 38px;\n}\n\n.specialist-cell.cell-3 {\n  padding-bottom: 8px;\n  font-size: 20.8px;\n  padding-right: 25px;\n}\n\n.specialist-table .specialist-title {\n  font-family: \"Bahnschrift\";\n  font-size: 25px;\n  font-weight: bold;  \n  margin: 0;\n  padding: 0;\n  color: black;\n}\n\n.specialist-table .specialist-desc {\n  color: black;\n  font-family: \"Bahnschrift\";\n  font-size: 20.5px;\n  margin: 0 0 30px;\n  text-align: left;\n  line-height: 1.2;\n  word-break: break-word;\n  word-wrap: break-word;\n  hyphens: auto;\n  -webkit-hyphens: auto;\n  -moz-hyphens: auto;\n  -ms-hyphens: auto;\n}\n</style>","import { createApp, defineComponent, ref, computed } from 'vue';\nimport './chevron.css';\n\nconst defaultGradient = 'linear-gradient(135deg, rgba(185, 194, 202, 1) 0%, rgba(97, 101, 105, 1) 100%);';\n\nconst ensureTrailingSlash = (value) => (value.endsWith('/') ? value : `${value}/`);\nconst baseAssetPath = ensureTrailingSlash(process.env.BASE_URL || '/');\nconst pointsImage = `${baseAssetPath}assets/tree/points.png`;\n\nconst offsetsForScale = (scale, position) => {\n  switch (scale) {\n    case 3:\n      return { imageBottom: -15 + (-2 * position), bodySoulBottom: 21 + (-2 * position), mindBottom: 12 + (-2 * position) };\n    case 4:\n      return { imageBottom: -17 + (-2 * position), bodySoulBottom: 19 + (-2 * position), mindBottom: 10 + (-2 * position) };\n    case 5:\n      return { imageBottom: -19 + (-2 * position), bodySoulBottom: 17 + (-2 * position), mindBottom: 8 + (-2 * position) };\n    default:\n      return { imageBottom: 0, bodySoulBottom: 0, mindBottom: 0 };\n  }\n};\n\nconst toNumber = (value, fallback = 0) => {\n  const parsed = Number(value);\n  return Number.isNaN(parsed) ? fallback : parsed;\n};\n\nconst ParentChevronComponent = defineComponent({\n  name: 'ParentChevron',\n  props: {\n    scale: {\n      type: Number,\n      required: true\n    },\n    column: {\n      type: Number,\n      required: true\n    }\n  },\n  setup(props) {\n    const textSize = ref(25);\n    const showMenu = ref(false);\n    const fill = ref(defaultGradient);\n    const color1 = ref('#474747');\n    const color2 = ref('#555555');\n    const stop1 = ref(0);\n    const stop2 = ref(100);\n    const descriptionTop = ref(48);\n    const descriptionColor = ref('#FFFFFF');\n\n    // let height = 0;\n\n    // switch (props.scale) {\n    //   case 3:\n    //     height = computed(() => (700 + (67 * props.scale)) / props.scale);\n    //     break;\n    //   case 4:\n    //     height = computed(() => (750 + (67 * props.scale)) / props.scale);\n    //     break;\n    //   case 5:\n    //     height = computed(() => (800 + (67 * props.scale)) / props.scale);\n    //     break;\n    // }\n\n    const height = computed(() => (1150 + (32 * props.scale)) / props.scale);\n    const offsets = computed(() => offsetsForScale(props.scale, 0));\n    const gradientId = computed(() => `myGradient-parent-${props.column}`);\n\n    const updateTextSize = (event) => {\n      textSize.value = toNumber(event.target.value, textSize.value);\n    };\n\n    const updateDescriptionTop = (event) => {\n      descriptionTop.value = toNumber(event.target.value, descriptionTop.value);\n    };\n\n    const updateColorOne = (event) => {\n      fill.value = `url(#${gradientId.value})`;\n      color1.value = event.target.value;\n    };\n\n    const updateStopOne = (event) => {\n      fill.value = `url(#${gradientId.value})`;\n      stop1.value = toNumber(event.target.value, stop1.value);\n    };\n\n    const updateColorTwo = (event) => {\n      fill.value = `url(#${gradientId.value})`;\n      color2.value = event.target.value;\n    };\n\n    const updateStopTwo = (event) => {\n      fill.value = `url(#${gradientId.value})`;\n      stop2.value = toNumber(event.target.value, stop2.value);\n    };\n\n    const updateDescriptionColor = (event) => {\n      descriptionColor.value = event.target.value;\n    };\n\n    const reset = () => {\n      fill.value = defaultGradient;\n    };\n\n    return {\n      textSize,\n      showMenu,\n      fill,\n      color1,\n      color2,\n      stop1,\n      stop2,\n      descriptionTop,\n      descriptionColor,\n      height,\n      offsets,\n      gradientId,\n      column: props.column,\n      pointsImage,\n      updateTextSize,\n      updateDescriptionTop,\n      updateColorOne,\n      updateStopOne,\n      updateColorTwo,\n      updateStopTwo,\n      updateDescriptionColor,\n      reset\n    };\n  },\n  template: `\n    <div class=\"chevron-container\" @mouseenter=\"showMenu = true\" @mouseleave=\"showMenu = false\">\n      <div class=\"chevron-svg\" :style=\"{ height: height + 'px', zIndex: 100 }\" style=\"overflow: visible;\">\n        <svg class=\"chevron\" viewBox=\"0 0 159 170\" preserveAspectRatio=\"none\" style=\"overflow: visible;\">\n          <defs>\n            <radialGradient class=\"radial\" :id=\"gradientId\">\n              <stop class=\"chevron-radial-1\" :offset=\"stop1 + '%'\" :stop-color=\"color1\" />\n              <stop class=\"chevron-radial-2\" :offset=\"stop2 + '%'\" :stop-color=\"color2\" />\n            </radialGradient>\n          </defs>\n          <polyline :fill=\"fill\" points=\"159 1 159 155 79 170 0 155 0 1 159 1\" />\n        </svg>\n      </div>\n      <div class=\"parent-chevron-controls\">\n        <textarea class=\"title\" placeholder=\"Epic Talent\"></textarea>\n        <img :src=\"pointsImage\" alt=\"points\" class=\"points-img\" :style=\"{ bottom: offsets.imageBottom + 'px', height: '104px' }\" />\n        <textarea class=\"skillbody\" placeholder=\"Some awesome, incredible, homebrew'd talent\" :style=\"{ fontSize: textSize + 'px', top: descriptionTop + '%' }\"></textarea>\n        <input class=\"body\" type=\"number\" maxlength=\"1\" min=\"0\" max=\"9\" value=\"0\" :style=\"{ bottom: offsets.bodySoulBottom + 'px' }\" />\n        <input class=\"mind\" type=\"number\" maxlength=\"1\" min=\"0\" max=\"9\" value=\"0\" :style=\"{ bottom: offsets.mindBottom + 'px' }\" />\n        <input class=\"soul\" type=\"number\" maxlength=\"1\" min=\"0\" max=\"9\" value=\"0\" :style=\"{ bottom: offsets.bodySoulBottom + 'px' }\" />\n      </div>\n\n      <div class=\"chevron-extras\" :style=\"{ display: showMenu ? 'flex' : 'none' }\">\n        <div class=\"control-group\">\n          <div class=\"control-label\">\n            <label :for=\"'text-size-parent-' + column\">Font size: {{ textSize }} [1]</label>\n            <input :id=\"'text-size-parent-' + column\" :name=\"'text-size-parent-' + column\" step=\"0.01\" min=\"0.3\" max=\"2\" placeholder=\"1\" type=\"number\" :value=\"textSize\" @input=\"updateTextSize\" />\n          </div>\n          <div class=\"control-label\">\n            <label :for=\"'description-top-parent-' + column\">Height: {{ descriptionTop }}% [50%]</label>\n            <input :id=\"'description-top-parent-' + column\" :name=\"'description-top-parent-' + column\" step=\"0.1\" min=\"0\" max=\"100\" type=\"number\" :value=\"descriptionTop\" @input=\"updateDescriptionTop\" />\n          </div>\n        </div>\n        <div class=\"control-group\">\n          <div class=\"control-label\">\n            <label :for=\"'inner-gradient-parent-' + column\">Inner gradient color</label>\n            <input :id=\"'inner-gradient-parent-' + column\" :name=\"'inner-gradient-parent-' + column\" type=\"color\" :value=\"color1\" @input=\"updateColorOne\" />\n          </div>\n          <div class=\"control-label\">\n            <label :for=\"'inner-position-parent-' + column\">and position</label>\n            <input :id=\"'inner-position-parent-' + column\" :name=\"'inner-position-parent-' + column\" type=\"number\" :value=\"stop1\" placeholder=\"10\" @input=\"updateStopOne\" />\n          </div>\n        </div>\n        <div class=\"control-group\">\n          <div class=\"control-label\">\n            <label :for=\"'outer-gradient-parent-' + column\">Outer gradient color</label>\n            <input :id=\"'outer-gradient-parent-' + column\" :name=\"'outer-gradient-parent-' + column\" type=\"color\" :value=\"color2\" @input=\"updateColorTwo\" />\n          </div>\n          <div class=\"control-label\">\n            <label :for=\"'outer-position-parent-' + column\">and position</label>\n            <input :id=\"'outer-position-parent-' + column\" :name=\"'outer-position-parent-' + column\" type=\"number\" :value=\"stop2\" placeholder=\"95\" @input=\"updateStopTwo\" />\n          </div>\n        </div>\n        <div class=\"control-group\">\n          <div class=\"control-label\">\n            <label :for=\"'description-color-' + column\">Description color</label>\n            <input :id=\"'description-color-' + column\" :name=\"'description-color-' + column\" type=\"color\" :value=\"descriptionColor\" @input=\"updateDescriptionColor\" />\n          </div>\n        </div>\n        <button type=\"button\" @click=\"reset\">Reset Gradients</button>\n      </div>\n    </div>\n  `\n});\n\nconst ChevronComponent = defineComponent({\n  name: 'Chevron',\n  props: {\n    position: {\n      type: Number,\n      required: true\n    },\n    scale: {\n      type: Number,\n      required: true\n    },\n    column: {\n      type: Number,\n      required: true\n    }\n  },\n  setup(props) {\n    const textSize = ref(25);\n    const showMenu = ref(false);\n    const fill = ref(defaultGradient);\n    const color1 = ref('#474747');\n    const color2 = ref('#555555');\n    const stop1 = ref(0);\n    const stop2 = ref(100);\n    const descriptionTop = ref(46);\n    const descriptionColor = ref('#FFFFFF');\n    const marginTop = -50;\n\n    const offsets = computed(() => offsetsForScale(props.scale, props.position));\n    const height = computed(() => (1150 + (32 * props.scale)) / props.scale);\n    const zIndex = computed(() => 100 - props.position);\n    const display = computed(() => (props.position > props.scale ? 'none' : 'block'));\n    const extrasTop = computed(() => `${marginTop - 20}px`);\n    const gradientId = computed(() => `myGradient-${props.position}-${props.column}`);\n\n    const updateTextSize = (event) => {\n      textSize.value = toNumber(event.target.value, textSize.value);\n    };\n\n    const updateDescriptionTop = (event) => {\n      descriptionTop.value = toNumber(event.target.value, descriptionTop.value);\n    };\n\n    const updateColorOne = (event) => {\n      fill.value = `url(#${gradientId.value})`;\n      color1.value = event.target.value;\n    };\n\n    const updateStopOne = (event) => {\n      fill.value = `url(#${gradientId.value})`;\n      stop1.value = toNumber(event.target.value, stop1.value);\n    };\n\n    const updateColorTwo = (event) => {\n      fill.value = `url(#${gradientId.value})`;\n      color2.value = event.target.value;\n    };\n\n    const updateStopTwo = (event) => {\n      fill.value = `url(#${gradientId.value})`;\n      stop2.value = toNumber(event.target.value, stop2.value);\n    };\n\n    const updateDescriptionColor = (event) => {\n      descriptionColor.value = event.target.value;\n    };\n\n    const reset = () => {\n      fill.value = defaultGradient;\n    };\n\n    return {\n      position: props.position,\n      column: props.column,\n      textSize,\n      showMenu,\n      fill,\n      color1,\n      color2,\n      stop1,\n      stop2,\n      descriptionTop,\n      descriptionColor,\n      marginTop,\n      offsets,\n      height,\n      zIndex,\n      display,\n      extrasTop,\n      gradientId,\n      pointsImage,\n      updateTextSize,\n      updateDescriptionTop,\n      updateColorOne,\n      updateStopOne,\n      updateColorTwo,\n      updateStopTwo,\n      updateDescriptionColor,\n      reset\n    };\n  },\n  template: `\n    <div class=\"chevron-container\" @mouseenter=\"showMenu = true\" @mouseleave=\"showMenu = false\" :style=\"{ display }\">\n      <div class=\"chevron-svg\" :style=\"{ marginTop: marginTop + 'px', height: height + 'px', zIndex }\" style=\"overflow: visible;\">\n        <svg class=\"chevron\" viewBox=\"0 0 159 170\" preserveAspectRatio=\"none\" style=\"overflow: visible;\">\n          <defs>\n            <radialGradient class=\"radial\" :id=\"gradientId\">\n              <stop class=\"chevron-radial-1\" :offset=\"stop1 + '%'\" :stop-color=\"color1\" />\n              <stop class=\"chevron-radial-2\" :offset=\"stop2 + '%'\" :stop-color=\"color2\" />\n            </radialGradient>\n          </defs>\n          <polyline :fill=\"fill\" points=\"159 1 159 155 79 170 0 155 0 1 159 1\" />\n        </svg>\n      </div>\n      <div class=\"chevron-controls\">\n        <textarea class=\"title\" :style=\"{ top: '1%' }\"></textarea>\n        <img :src=\"pointsImage\" alt=\"points\" class=\"points-img\" :style=\"{ bottom: offsets.imageBottom + 'px', height: '104px' }\" />\n        <textarea class=\"skillbody\" :style=\"{ fontSize: textSize + 'px', top: descriptionTop + '%' }\"></textarea>\n        <input class=\"body\" type=\"number\" maxlength=\"1\" min=\"0\" max=\"9\" value=\"0\" :style=\"{ bottom: offsets.bodySoulBottom + 'px' }\" />\n        <input class=\"mind\" type=\"number\" maxlength=\"1\" min=\"0\" max=\"9\" value=\"0\" :style=\"{ bottom: offsets.mindBottom + 'px' }\" />\n        <input class=\"soul\" type=\"number\" maxlength=\"1\" min=\"0\" max=\"9\" value=\"0\" :style=\"{ bottom: offsets.bodySoulBottom + 'px' }\" />\n      </div>\n\n      <div class=\"chevron-extras\" :style=\"{ display: showMenu ? 'flex' : 'none', top: extrasTop }\">\n        <div class=\"control-group\">\n          <div class=\"control-label\">\n            <label :for=\"'text-size-' + position + '-' + column\">Font size: {{ textSize }} [1]</label>\n            <input :id=\"'text-size-' + position + '-' + column\" :name=\"'text-size-' + position + '-' + column\" step=\"0.01\" min=\"0.3\" max=\"2\" placeholder=\"1\" type=\"number\" :value=\"textSize\" @input=\"updateTextSize\" />\n          </div>\n          <div class=\"control-label\">\n            <label :for=\"'description-top-' + position + '-' + column\">Height: {{ descriptionTop }}% [50%]</label>\n            <input :id=\"'description-top-' + position + '-' + column\" :name=\"'description-top-' + position + '-' + column\" step=\"0.1\" min=\"0\" max=\"100\" type=\"number\" :value=\"descriptionTop\" @input=\"updateDescriptionTop\" />\n          </div>\n        </div>\n        <div class=\"control-group\">\n          <div class=\"control-label\">\n            <label :for=\"'inner-gradient-' + position + '-' + column\">Inner gradient color</label>\n            <input :id=\"'inner-gradient-' + position + '-' + column\" :name=\"'inner-gradient-' + position + '-' + column\" type=\"color\" :value=\"color1\" @input=\"updateColorOne\" />\n          </div>\n          <div class=\"control-label\">\n            <label :for=\"'inner-position-' + position + '-' + column\">and position</label>\n            <input :id=\"'inner-position-' + position + '-' + column\" :name=\"'inner-position-' + position + '-' + column\" type=\"number\" :value=\"stop1\" placeholder=\"10\" @input=\"updateStopOne\" />\n          </div>\n        </div>\n        <div class=\"control-group\">\n          <div class=\"control-label\">\n            <label :for=\"'outer-gradient-' + position + '-' + column\">Outer gradient color</label>\n            <input :id=\"'outer-gradient-' + position + '-' + column\" :name=\"'outer-gradient-' + position + '-' + column\" type=\"color\" :value=\"color2\" @input=\"updateColorTwo\" />\n          </div>\n          <div class=\"control-label\">\n            <label :for=\"'outer-position-' + position + '-' + column\">and position</label>\n            <input :id=\"'outer-position-' + position + '-' + column\" :name=\"'outer-position-' + position + '-' + column\" type=\"number\" :value=\"stop2\" placeholder=\"95\" @input=\"updateStopTwo\" />\n          </div>\n        </div>\n        <div class=\"control-group\">\n          <div class=\"control-label\">\n            <label :for=\"'description-color-' + column\">Description color</label>\n            <input :id=\"'description-color-' + column\" :name=\"'description-color-' + column\" type=\"color\" :value=\"descriptionColor\" @input=\"updateDescriptionColor\" />\n          </div>\n        </div>\n        <button type=\"button\" @click=\"reset\">Reset Gradients</button>\n      </div>\n    </div>\n  `\n});\n\nconst TalentTree = defineComponent({\n  name: 'TalentTree',\n  components: {\n    ParentChevron: ParentChevronComponent,\n    Chevron: ChevronComponent\n  },\n  props: {\n    scale: {\n      type: Number,\n      default: 5\n    },\n    columns: {\n      type: Number,\n      default: 1\n    }\n  },\n  setup(props) {\n    const chevronPositions = computed(() => Array.from({ length: Math.max(1, props.scale - 1) }, (_, idx) => idx + 1));\n    return {\n      chevronPositions\n    };\n  },\n  template: `\n    <div class=\"talent-tree-wrapper\">\n      <ParentChevron :scale=\"scale\" :column=\"0\" />\n      <div class=\"talent-tree-children\">\n        <Chevron\n          v-for=\"pos in chevronPositions\"\n          :key=\"pos\"\n          :position=\"pos\"\n          :scale=\"scale\"\n          :column=\"0\"\n        />\n      </div>\n    </div>\n  `\n});\n\nclass ChevronTalentTree {\n  constructor(container, options = {}) {\n    this.container = container;\n    this.options = options;\n    this.mountEl = document.createElement('div');\n    this.mountEl.className = 'talent-tree-host';\n    this.container.appendChild(this.mountEl);\n    const { scale = 5, columns = 1 } = options;\n    this.app = createApp(TalentTree, { scale, columns });\n    this.app.mount(this.mountEl);\n  }\n\n  destroy() {\n    if (this.app) {\n      this.app.unmount();\n      this.app = null;\n    }\n    if (this.mountEl && this.mountEl.parentNode) {\n      this.mountEl.parentNode.removeChild(this.mountEl);\n    }\n  }\n}\n\nexport const ParentChevron = ParentChevronComponent;\nexport const Chevron = ChevronComponent;\n\nexport default ChevronTalentTree;","import ChevronTalentTree from \"./talents/chevron\";\n\n/**\n * Parse lightweight markup into structured DOM nodes.\n *\n * Supported commands (case-insensitive):\n *  /page <type> <number|label>\n *  /column   (alias: /col)\n *  /spacing <px> (alias: /sp <px>)\n *  /equipment <rarity> <name>\n *      followed by /type /cost /tag /damage /desc /flavor /craft lines\n *      /next to start a new equipment section, /end to close equipment block\n *  /note <text> (aliases: /info, /lore) ... /end\n *  /toc begin  ... /toc end\n *      Inside TOC block: lines shaped as \"Title | 001\" become entries.\n *  /page-num <number>\n *  /style begin ... /style end  -> injects a <style> block (sanitized)\n *  /img <src> [alt and attributes]\n *  /columns <n>  -> set number of columns for current page\n *  /page-break\n *\n * Headings:  #, ##, ### etc. Append {.class #id style=\"...\" span-2} to add attributes.\n * Inline formatting: **bold**, *italic*, [link](url).\n * All user content is HTML-escaped prior to inline formatting replacement.\n */\nexport function parse(input, columnCount = 1) {\n  columnCount = Math.max(1, parseInt(columnCount, 10) || 1);\n  const lines = (input || '').split('\\n');\n\n  // ---------- Utility helpers ----------\n  const escapeHTML = (str) => String(str || '')\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n\n  const applyInlineFormatting = (text) => {\n    // Work on escaped text so user HTML cannot break out.\n    let safe = escapeHTML(text);\n    // Bold first to avoid double-processing inside italic.\n    safe = safe.replace(/\\*\\*(.+?)\\*\\*/g, '<strong>$1</strong>');\n    safe = safe.replace(/\\*(.+?)\\*/g, '<em>$1</em>');\n    safe = safe.replace(/\\\\n/g, '<br/>');\n    // Links: [text](url)\n    safe = safe.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, (m, t, u) => {\n      return `<a href=\"${escapeHTML(u)}\">${t}</a>`;\n    });\n    return safe;\n  };\n\n  const createEl = (tag, className, text) => {\n    const el = document.createElement(tag);\n    if (className) el.className = className;\n    if (text !== undefined) el.textContent = text;\n    return el;\n  };\n\n  const makeColumn = () => createEl('div', 'column');\n  const makePage = (pageType) => {\n    const type = pageType || 'default';\n    const page = createEl('div', 'page page-' + type);\n    page.style.setProperty('background', `var(--${type}-background)`);\n    page.appendChild(createEl('div', 'page-content'));\n    return page;\n  };\n\n  // ---------- Regex (precompiled) ----------\n  const RE = {\n    comment: /^\\/\\/\\s+(.*)$/i,\n    page: /^\\/page\\s+(red|pink|orange|yellow|purple|green|blue|talent)\\s+(.+)$/i,\n    pageNum: /^\\/page-num\\s+(\\d+)$/i,\n    column: /^\\/(column|col)$/i,\n  spacing: /^\\/(spacing|sp)\\s+(-?\\d+)$/i,\n    equipment: /^\\/equipment\\s+(crude|common|uncommon|rare|legendary|mythic)\\s+(.*)$/i,\n    equipmentDetail: /^\\/(type|cost|tag|damage|desc|flavor|craft)\\s+(.*)$/i,\n    equipmentNext: /^\\/next$/i,\n    spell: /^\\/spell\\s+(.*)$/i,\n    spellDetail: /^\\/(type|arts|tag|sta|stamina|desc)\\s+(.*)$/i,\n    spellNext: /^\\/next$/i,\n    specialist: /^\\/specialist$/i,\n    noteStart: /^\\/(note|info|lore)\\s+(.*)$/i,\n    blockEnd: /^\\/end$/i,\n    toc: /^\\/toc\\s+(begin|end)$/i,\n    heading: /^(#+)\\s+(.*)$/, \n\n    // Talent handling\n    talentStart: /^\\/tree\\s+([3-5])$/i,\n    talentContent: /^\\/talent\\s+(label|description)\\s+(.*)$/i,\n    talentEnd: /^\\/end-tree$/i,\n\n    // style blocks\n    styleBegin: /^\\/style\\s+begin$/i,\n    styleEnd: /^\\/style\\s+end$/i,\n    img: /^\\/img\\s+(\\S+)(?:\\s+(.*))?$/i,\n    codeFenceBegin: /^```\\s*(\\w+)?\\s*$/,\n    hr: /^-{3,}\\s*$/,\n    pageBreak: /^\\/page-break$/i,\n    columns: /^\\/columns\\s+(\\d+)$/i\n  };\n\n  // ---------- State ----------\n  const parent = createEl('div', 'content-parent');\n  // lazy pages: don't create a page until a explicit /page command is seen\n  const pages = [];\n  let activePageIndex = -1;\n  let activePage = null;\n  const pageColumns = [];\n  let activeColumnIndex = -1;\n\n  let noteDiv = null; // current note box\n  let equipmentDiv = null; // current equipment wrapper\n  let equipmentSectionContainer = null; // current equipment inner section\n  let equipmentSectionCount = 0;\n  let spellDiv = null;\n  let spellArtistries = [];\n  let spellSectionContainer = null;\n  let spellSectionCount = 0;\n\n  let treeDiv = null; // container for current talent tree\n  let talentTreeInstance = null;\n\n  let tocDiv = null; // TOC container\n  let styleCollect = null; // array of style lines when inside style block\n  let specialistDiv = null; // current specialist table\n  const pageColumnLimits = [];\n\n  const getActiveColumn = () => pageColumns[activePageIndex][activeColumnIndex];\n\n  const ensureColumn = () => {\n    if (activePageIndex < 0) return; // no active page\n    if (!pageColumns[activePageIndex] || pageColumns[activePageIndex].length === 0) {\n      pageColumns[activePageIndex] = [makeColumn()];\n      activePage.querySelector('.page-content').appendChild(pageColumns[activePageIndex][0]);\n      activeColumnIndex = 0;\n    }\n  };\n\n  const startNewPage = (type, pageLabel) => {\n    const page = makePage(type);\n    pages.push(page);\n    parent.appendChild(page);\n    activePageIndex = pages.length - 1;\n    activePage = page;\n    pageColumns[activePageIndex] = [];\n    if (type !== \"talent\") {\n      const firstCol = makeColumn();\n      page.querySelector('.page-content').appendChild(firstCol);\n      pageColumns[activePageIndex].push(firstCol);\n      activeColumnIndex = 0;\n    }\n    else {\n      const col = createEl('div', 'full-column talent-content');\n      page.querySelector('.page-content').appendChild(col);\n      pageColumns[activePageIndex].push(col);\n      activeColumnIndex = 0;\n    }\n    if (pageLabel) {\n      const pageDiv = createEl('div', 'page-number');\n      if (/^\\d+$/.test(pageLabel)) {\n        pageDiv.textContent = pageLabel.toString().padStart(3, '0');\n      } else {\n        pageDiv.textContent = pageLabel;\n      }\n      activePage.appendChild(pageDiv);\n    }\n  };\n\n  const startEquipment = (rarity, name) => {\n    const equipment = createEl('div', 'equipment rarity-' + rarity.toLowerCase());\n    const contentWrap = createEl('div', 'equipment-content');\n    const title = createEl('div', 'equipment-title', name);\n    contentWrap.appendChild(title);\n    equipment.appendChild(contentWrap);\n    getActiveColumn().appendChild(equipment);\n    equipmentDiv = equipment;\n    equipmentSectionContainer = contentWrap;\n    equipmentSectionCount = 0;\n  };\n\n  const startSpell = (name) => {\n    const spell = createEl('div', 'spell');\n    const contentWrap = createEl('div', 'spell-content');\n    const title = createEl('div', 'spell-title', name);\n    contentWrap.appendChild(title);\n    spell.appendChild(contentWrap);\n    getActiveColumn().appendChild(spell);\n    spellDiv = spell;\n    spellSectionContainer = contentWrap;\n    spellSectionCount = 0;\n  };\n\n  const startTalent = (count) => {\n    if (!activePage) return;\n    const scale = Math.max(1, parseInt(count, 10) || 5);\n    const pageContent = activePage.querySelector('.page-content');\n    if (!pageContent) return;\n\n    if (!treeDiv) {\n      treeDiv = createEl('div', 'talent-tree');\n      pageContent.appendChild(treeDiv);\n    }\n\n    if (talentTreeInstance) {\n      talentTreeInstance.destroy();\n      talentTreeInstance = null;\n    }\n\n    treeDiv.innerHTML = '';\n    talentTreeInstance = new ChevronTalentTree(treeDiv, { scale, columns: 3 });\n  };\n\n  const endTalent = () => {\n    if (!talentTreeInstance) return;\n    talentTreeInstance = null;\n    treeDiv = null;\n  };\n\n  const addEquipmentDetail = (kind, rawContent) => {\n    if (!equipmentDiv) return;\n    // Don't create a new section until the first 'next' is called\n    // if (!equipmentSectionContainer || equipmentSectionCount === 0) {\n    //   equipmentSectionCount = 1;\n    //   const section = createEl('div', 'equipment-section section-1');\n    //   equipmentDiv.appendChild(section);\n    //   equipmentSectionContainer = section;\n    // }\n    const detail = createEl('div', 'equipment-detail ' + kind.toLowerCase());\n    if (kind.toLowerCase() === 'tag') {\n      const [left, ...rest] = rawContent.split(':');\n      const right = rest.join(':').trim();\n      const first = createEl('span', 'equipment-tag-type', left.trim() + ': ');\n      const second = createEl('span', 'equipment-tag-content', right);\n      detail.appendChild(first);\n      detail.appendChild(second);\n    } else {\n      detail.textContent = rawContent;\n    }\n    equipmentSectionContainer.appendChild(detail);\n  };\n\n  const addSpellDetail = (kind, rawContent) => {\n    if (!spellDiv) return;\n    // Don't create a new section until the first 'next' is called\n    // if (!spellSectionContainer || spellSectionCount === 0) {\n    //   spellSectionCount = 1;\n    //   const section = createEl('div', 'spell-section section-1');\n    //   spellDiv.appendChild(section);\n    //   spellSectionContainer = section;\n    // }\n    const detail = createEl('div', 'spell-detail ' + kind.toLowerCase());\n    if (kind.toLowerCase() === 'tag') {\n      const [left, ...rest] = rawContent.split(':');\n      const right = rest.join(':').trim();\n      const first = createEl('span', 'equipment-tag-type', left.trim() + ': ');\n      const second = createEl('span', 'equipment-tag-content', right);\n      detail.appendChild(first);\n      detail.appendChild(second);\n    } else if (kind.toLowerCase() === \"arts\") {\n      const arts = rawContent.split(',');\n      arts.forEach(a => spellArtistries.push(a.trim().toLowerCase()));\n      detail.textContent = rawContent;\n    } else {\n      detail.textContent = rawContent;\n    }\n    spellSectionContainer.appendChild(detail);\n  };\n\n  const nextEquipmentSection = () => {\n    if (!equipmentDiv) return;\n    equipmentSectionCount += 1;\n    const section = createEl('div', 'equipment-section section-' + equipmentSectionCount);\n    equipmentDiv.appendChild(section);\n    equipmentSectionContainer = section;\n  };\n\n  const nextSpellSection = () => {\n    if (!spellDiv) return;\n    spellSectionCount += 1;\n    const section = createEl('div', 'spell-section section-' + spellSectionCount);\n    spellDiv.appendChild(section);\n    spellSectionContainer = section;\n  }\n\n  const endEquipment = () => {\n    equipmentDiv = null;\n    equipmentSectionContainer = null;\n    equipmentSectionCount = 0;\n  };\n\n  const endSpell = () => {\n    if (!spellDiv) {\n      spellSectionContainer = null;\n      spellSectionCount = 0;\n      spellArtistries = [];\n      return;\n    }\n\n    try {\n      const section = spellDiv.querySelector('.section-2');\n      const artistryCount = spellArtistries.length;\n      const container = createEl('div', 'artistry-container artistry-container-' + artistryCount, '');\n      section.appendChild(container);\n\n      for (const artistry of spellArtistries) {\n        const artistryIcon = createEl('img', `artistry-icon artistry-${artistry}`, '');\n        artistryIcon.setAttribute('width', '130');\n        artistryIcon.setAttribute('height', '130');\n        container.appendChild(artistryIcon);\n      }\n\n      spellDiv = null;\n      spellSectionContainer = null;\n      spellSectionCount = 0;\n      spellArtistries = [];\n    } catch (e) {\n      console.error('Error finalizing spell:', e);\n    }\n  };\n\n  const startNote = (type, firstLine) => {\n    const wrapper = createEl('div', 'note ' + type.toLowerCase());\n    const makeImg = (cls, file) => {\n      const img = document.createElement('img');\n      img.className = 'box ' + cls;\n      img.src = '../assets/blocks/' + file;\n      return img;\n    };\n    wrapper.appendChild(makeImg('box-top-left', 'box-top-left.svg'));\n    wrapper.appendChild(makeImg('box-top-right', 'box-top-right.svg'));\n    wrapper.appendChild(makeImg('box-bottom-left', 'box-bottom-left.svg'));\n    wrapper.appendChild(makeImg('box-bottom-right', 'box-bottom-right.svg'));\n    const gradient = createEl('div', 'box box-gradient ' + type.toLowerCase());\n    wrapper.appendChild(gradient);\n    const p = createEl('p', 'note-content');\n    p.innerHTML = applyInlineFormatting(firstLine);\n    wrapper.appendChild(p);\n    getActiveColumn().appendChild(wrapper);\n    noteDiv = wrapper;\n  };\n\n  const appendNoteLine = (line) => {\n    if (!noteDiv) return;\n    const p = createEl('p', 'note-content');\n    p.innerHTML = applyInlineFormatting(line);\n    noteDiv.appendChild(p);\n  };\n\n  const endNote = () => { noteDiv = null; };\n\n  const startTOC = () => {\n    tocDiv = createEl('div', 'toc');\n    getActiveColumn().appendChild(tocDiv);\n  };\n  const endTOC = () => { tocDiv = null; };\n  const addTOCEntry = (title, page) => {\n    if (!tocDiv) return;\n    const entry = createEl('div', 'toc-entry');\n    const t = createEl('span', 'toc-title');\n    t.textContent = title;\n    const p = createEl('span', 'toc-page');\n    p.textContent = page;\n    entry.appendChild(t);\n    entry.appendChild(p);\n    tocDiv.appendChild(entry);\n  };\n\n  const addHeading = (level, text, span, attrs) => {\n    level = Math.min(6, level || 1);\n    const h = createEl('h' + level);\n    h.textContent = text;\n    if (attrs) {\n      if (attrs.id) h.id = attrs.id;\n      attrs.classes.forEach(c => h.classList.add(c));\n      if (attrs.style) h.setAttribute('style', attrs.style);\n    }\n    if (span && span > 1) {\n      h.classList.add('span-' + span);\n      if (attrs && !attrs.classes.includes('span-' + span)) {\n        h.classList.add('span-' + span);\n      }\n      activePage.appendChild(h);\n      activePage.classList.add('has-span-' + span);\n    } else {\n      getActiveColumn().appendChild(h);\n    }\n  };\n\n  const addParagraph = (line, attrs) => {\n    const p = createEl('p');\n    p.innerHTML = applyInlineFormatting(line);\n    if (attrs) {\n      if (attrs.id) p.id = attrs.id;\n      attrs.classes.forEach(c => p.classList.add(c));\n      if (attrs.style) p.setAttribute('style', attrs.style);\n    }\n    getActiveColumn().appendChild(p);\n  };\n\n  const addSpacing = (px) => {\n    const amount = parseFloat(px);\n    if (!Number.isFinite(amount)) return;\n\n    const spacer = createEl('div', 'spacing');\n    if (amount >= 0) {\n      spacer.style.height = amount + 'px';\n    } else {\n      spacer.style.height = '0px';\n      spacer.style.marginTop = amount + 'px';\n      spacer.classList.add('spacing-negative');\n    }\n    spacer.setAttribute('aria-hidden', 'true');\n    getActiveColumn().appendChild(spacer);\n  };\n\n  const addPageNumber = (num) => {\n    const pageDiv = createEl('div', 'page-number');\n    pageDiv.textContent = num.toString().padStart(3, '0');\n    activePage.appendChild(pageDiv);\n  };\n\n  const advanceColumn = () => {\n    const cols = pageColumns[activePageIndex];\n    const limit = pageColumnLimits[activePageIndex] || columnCount;\n    if (cols.length < limit) {\n      const newCol = makeColumn();\n      cols.push(newCol);\n      activePage.querySelector('.page-content').appendChild(newCol);\n      activeColumnIndex = cols.length - 1;\n    } else {\n      activeColumnIndex = (activeColumnIndex + 1) % limit;\n    }\n  };\n\n  const addTalentContent = (type, content) => {\n    if (!activePage) return;\n    if (!getActiveColumn().classList.contains('talent-content')) return;\n\n    if (type === \"label\") {\n      const label = createEl('div', 'talent-label', content);\n      getActiveColumn().appendChild(label);\n    }\n\n    if (type === \"description\") {\n      const description = createEl('div', 'talent-description', '');\n      description.innerHTML = applyInlineFormatting(content);\n      getActiveColumn().appendChild(description);\n    }\n  };\n\n  // Attribute block parser: supports {.class1 .class2 #id style=\"color:red;\" span-2}\n  const parseAttributeBlock = (body) => {\n    const attrMatch = body.match(/\\s\\{([^}]*)}\\s*$/);\n    if (!attrMatch) return { text: body, classes: [], id: null, style: null, span: null };\n    const attrContent = attrMatch[1].trim();\n    const remaining = body.slice(0, attrMatch.index).trim();\n    // Tokenize by spaces not inside quotes (simple split suffices for limited syntax)\n    const rawTokens = attrContent.match(/(?:\"[^\"]*\"|'[^']*'|[^\\s]+)/g) || [];\n    const classes = [];\n    let id = null;\n    let style = null;\n    let span = null;\n    rawTokens.forEach(t => {\n      if (t.startsWith('.')) {\n        classes.push(t.slice(1));\n      } else if (t.startsWith('#')) {\n        id = t.slice(1);\n      } else if (t.toLowerCase().startsWith('style=')) {\n        const val = t.substring(6).replace(/^['\"]|['\"]$/g, '');\n        style = val;\n      } else if (/^span-(\\d+)$/i.test(t)) {\n        const m = t.match(/span-(\\d+)/i);\n        span = parseInt(m[1], 10) || null;\n      } else {\n        // treat unknown token as class to be flexible\n        classes.push(t);\n      }\n    });\n    return { text: remaining, classes, id, style, span };\n  };\n\n  const addSpecialistTable = () => {\n    const div = createEl('div', 'specialist-table');\n    activePage.appendChild(div);\n    const headerWrap = createEl('div', 'specialist-header');\n    div.appendChild(headerWrap);\n    const contentWrap = createEl('div', 'specialist-content');\n    div.appendChild(contentWrap);\n    const headerRow = createEl('div', 'specialist-row header');\n    ['Talent Name', 'Prerequisites', 'Abilities'].forEach((text, idx) => {\n      const cell = createEl('div', 'specialist-cell cell-' + (idx + 1), text);\n      headerRow.appendChild(cell);\n    });\n    div.appendChild(headerRow);\n    specialistDiv = div;\n  };\n\n  // ---------- Main loop ----------\n  for (let i = 0; i < lines.length; i++) {\n    const raw = lines[i];\n    let line = raw.trim();\n    if (!line) continue;\n\n    // If no page has been created yet, ignore all non-page lines to avoid\n    // inserting a blank initial page. Allow style blocks and comments.\n    if (activePageIndex < 0 && !RE.page.test(line) && !RE.styleBegin.test(line) && !RE.styleEnd.test(line) && !RE.comment.test(line)) {\n      startNewPage('default');\n      ensureColumn();\n    }\n\n    // Style block collection mode\n    if (styleCollect && !(RE.styleEnd.test(line) || RE.blockEnd.test(line))) {\n      styleCollect.push(line);\n      continue;\n    }\n    if (styleCollect && (RE.styleEnd.test(line) || RE.blockEnd.test(line))) {\n      // finalize style element\n      const styleEl = document.createElement('style');\n      // Basic sanitization: remove < and >\n      const css = styleCollect.join('\\n').replace(/[<>]/g, '');\n      styleEl.textContent = css;\n      parent.appendChild(styleEl);\n      styleCollect = null;\n      continue;\n    }\n\n    // Skip comments\n    if (RE.comment.test(line)) continue;\n\n    // Handle modes first\n    if (noteDiv && !RE.blockEnd.test(line)) {\n      appendNoteLine(line);\n      continue;\n    }\n\n    if (equipmentDiv && !RE.blockEnd.test(line)) {\n      if (RE.equipmentNext.test(line)) { nextEquipmentSection(); continue; }\n      const mDet = line.match(RE.equipmentDetail);\n      if (mDet) { addEquipmentDetail(mDet[1], mDet[2]); continue; }\n    }\n\n    if (spellDiv && !RE.blockEnd.test(line)) {\n      if (RE.spellNext.test(line)) { nextSpellSection(); continue; }\n      const mDet = line.match(RE.spellDetail);\n      if (mDet) { addSpellDetail(mDet[1], mDet[2]); continue; }\n    }\n\n    if (tocDiv && !RE.toc.test(line)) {\n      // Expect pattern: Title | 001   (page part optional)\n      const parts = line.split('|');\n      if (parts.length >= 1) {\n        const title = parts[0].trim();\n        const page = (parts[1] || '').trim();\n        addTOCEntry(title, page);\n      }\n      continue;\n    }\n\n    if (specialistDiv) {\n      if (RE.blockEnd.test(line)) {\n        specialistDiv = null;\n        continue;\n      } else {\n        const title = /^\\/title\\s*(.*)$/i.exec(line);\n        if (title) {\n          const h2 = createEl('h2', 'specialist-title', title[1]);\n          specialistDiv.querySelector('.specialist-header').appendChild(h2);\n          continue;\n        }\n\n        const desc = /^\\/desc\\s*(.*)$/i.exec(line);\n        if (desc) {\n          const p = createEl('p', 'specialist-desc');\n          p.innerHTML = applyInlineFormatting(desc[1]);\n          specialistDiv.querySelector('.specialist-header').appendChild(p);\n          continue;\n        }\n\n        const splits = line.split('|').map(s => s.trim());\n        if (splits.length === 3) {\n          const row = createEl('div', 'specialist-row');\n          splits.forEach((text, idx) => {\n            const cell = createEl('div', 'specialist-cell cell-' + (idx + 1));\n            cell.innerHTML = applyInlineFormatting(text);\n            row.appendChild(cell);\n          });\n          specialistDiv.querySelector('.specialist-content').appendChild(row);\n          continue;\n        }\n      }\n    }\n\n    // Generic command matching\n    let m;\n    if ((m = line.match(RE.page))) { startNewPage(m[1].toLowerCase(), m[2]); continue; }\n    if (RE.styleBegin.test(line)) { styleCollect = []; continue; }\n    if (RE.styleEnd.test(line)) { /* stray end without begin ignored */ continue; }\n    if ((m = line.match(RE.pageNum))) { addPageNumber(m[1]); continue; }\n    if ((m = line.match(RE.column))) { advanceColumn(); continue; }\n    if ((m = line.match(RE.columns))) { pageColumnLimits[activePageIndex] = parseInt(m[1], 10) || columnCount; continue; }\n    if ((m = line.match(RE.spacing))) { addSpacing(m[2]); continue; }\n    if ((m = line.match(RE.equipment))) { startEquipment(m[1], m[2]); continue; }\n    if ((m = line.match(RE.spell))) { startSpell(m[1]); continue; }\n    if ((m = line.match(RE.specialist))) { addSpecialistTable(); continue; }\n    if ((m = line.match(RE.noteStart))) { startNote(m[1], m[2]); continue; }\n    if ((m = line.match(RE.talentStart))) { startTalent(m[1]); continue; }\n    if (RE.talentEnd.test(line)) { endTalent(); continue; }\n    if ((m = line.match(RE.talentContent))) {\n      const type = m[1];\n      const content = m[2];\n      addTalentContent(type, content);\n      continue;\n    }\n    if ((m = line.match(RE.img))) {\n      const src = m[1];\n      const rest = (m[2] || '').trim();\n      const attrs = parseAttributeBlock(rest);\n      const img = document.createElement('img');\n      img.src = src;\n      img.alt = attrs.text || '';\n      if (attrs.id) img.id = attrs.id;\n      attrs.classes.forEach(c => img.classList.add(c));\n      if (attrs.style) img.setAttribute('style', attrs.style);\n      getActiveColumn().appendChild(img);\n      continue;\n    }\n  if (RE.blockEnd.test(line)) { endNote(); endEquipment(); endSpell(); endTOC(); continue; }\n    if ((m = line.match(RE.toc))) { if (m[1].toLowerCase() === 'begin') startTOC(); else endTOC(); continue; }\n    if (RE.hr.test(line) || /^\\/hr$/i.test(line)) { getActiveColumn().appendChild(document.createElement('hr')); continue; }\n    if (RE.pageBreak.test(line)) { const pb = createEl('div', 'page-break'); getActiveColumn().appendChild(pb); continue; }\n\n    // Headings\n    if ((m = line.match(RE.heading))) {\n      const level = m[1].length;\n      let body = m[2].trim();\n      const attrs = parseAttributeBlock(body);\n      body = attrs.text;\n      addHeading(level, body, attrs.span, attrs);\n      continue;\n    }\n\n    // Unordered lists\n    const mList = line.match(/^[-*]\\s+(.*)$/);\n    if (mList) {\n      const ul = createEl('ul');\n      while (i < lines.length) {\n        const liLine = lines[i].trim();\n        const mItem = liLine.match(/^[-*]\\s+(.*)$/);\n        if (!mItem) break;\n        const li = createEl('li');\n        li.innerHTML = applyInlineFormatting(mItem[1]);\n        ul.appendChild(li);\n        i++;\n      }\n      i--;\n      ensureColumn();\n      getActiveColumn().appendChild(ul);\n      continue;\n    }\n\n    // Ordered lists\n    const mOrdered = line.match(/^(\\d+)\\.\\s+(.*)$/);\n    if (mOrdered) {\n      const ol = createEl('ol');\n      while (i < lines.length) {\n        const liLine = lines[i].trim();\n        const mItem = liLine.match(/^(\\d+)\\.\\s+(.*)$/);\n        if (!mItem) break;\n        const li = createEl('li');\n        li.innerHTML = applyInlineFormatting(mItem[2]);\n        ol.appendChild(li);\n        i++;\n      }\n      i--;\n      ensureColumn();\n      getActiveColumn().appendChild(ol);\n      continue;\n    }\n\n    // Code fence blocks ```lang\n    let mf;\n    if ((mf = line.match(RE.codeFenceBegin))) {\n      const lang = mf[1] || '';\n      const buffer = [];\n      i++;\n      while (i < lines.length && !/^```\\s*$/.test(lines[i])) {\n        buffer.push(lines[i]);\n        i++;\n      }\n      const pre = createEl('pre');\n      const code = createEl('code');\n      if (lang) code.className = 'language-' + lang;\n      code.textContent = buffer.join('\\n');\n      pre.appendChild(code);\n      ensureColumn();\n      getActiveColumn().appendChild(pre);\n      continue;\n    }\n\n    // Fallback paragraph\n    ensureColumn();\n    // Attribute parsing for paragraphs\n    const pAttrs = parseAttributeBlock(line);\n    addParagraph(pAttrs.text, pAttrs);\n  }\n\n  return parent;\n}","import { render } from \"./Editor.vue?vue&type=template&id=63b419c4\"\nimport script from \"./Editor.vue?vue&type=script&lang=js\"\nexport * from \"./Editor.vue?vue&type=script&lang=js\"\n\nimport \"./Editor.vue?vue&type=style&index=0&id=63b419c4&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=5eb96928\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=5eb96928&lang=css\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { createApp } from 'vue'\nimport App from './App.vue'\nimport './assets/fonts/rpg-awesome.min.css';\n\ncreateApp(App).mount('#app')\n","var map = {\n\t\"./simpleWorker\": 5585,\n\t\"./simpleWorker.js\": 5585,\n\t\"monaco-editor/esm/vs/base/common/worker/simpleWorker\": 5585,\n\t\"monaco-editor/esm/vs/base/common/worker/simpleWorker.js\": 5585\n};\n\nfunction webpackAsyncContext(req) {\n\treturn Promise.resolve().then(function() {\n\t\tif(!__webpack_require__.o(map, req)) {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t}\n\n\t\tvar id = map[req];\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function() { return Object.keys(map); };\nwebpackAsyncContext.id = 5890;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./editorBaseApi\": [\n\t\t3059\n\t],\n\t\"./editorBaseApi.js\": [\n\t\t3059\n\t],\n\t\"./editorSimpleWorker\": [\n\t\t4003\n\t],\n\t\"./editorSimpleWorker.js\": [\n\t\t4003\n\t],\n\t\"./editorWorker\": [\n\t\t304\n\t],\n\t\"./editorWorker.js\": [\n\t\t304\n\t],\n\t\"./editorWorkerHost\": [\n\t\t6358\n\t],\n\t\"./editorWorkerHost.js\": [\n\t\t6358\n\t],\n\t\"./findSectionHeaders\": [\n\t\t9307\n\t],\n\t\"./findSectionHeaders.js\": [\n\t\t9307\n\t],\n\t\"./getIconClasses\": [\n\t\t5767\n\t],\n\t\"./getIconClasses.js\": [\n\t\t5767\n\t],\n\t\"./languageFeatureDebounce\": [\n\t\t2060\n\t],\n\t\"./languageFeatureDebounce.js\": [\n\t\t2060\n\t],\n\t\"./languageFeatures\": [\n\t\t2230\n\t],\n\t\"./languageFeatures.js\": [\n\t\t2230\n\t],\n\t\"./languageFeaturesService\": [\n\t\t6127\n\t],\n\t\"./languageFeaturesService.js\": [\n\t\t6127\n\t],\n\t\"./languageService\": [\n\t\t3930\n\t],\n\t\"./languageService.js\": [\n\t\t3930\n\t],\n\t\"./languagesAssociations\": [\n\t\t5996\n\t],\n\t\"./languagesAssociations.js\": [\n\t\t5996\n\t],\n\t\"./languagesRegistry\": [\n\t\t6995\n\t],\n\t\"./languagesRegistry.js\": [\n\t\t6995\n\t],\n\t\"./markerDecorations\": [\n\t\t886\n\t],\n\t\"./markerDecorations.js\": [\n\t\t886\n\t],\n\t\"./markerDecorationsService\": [\n\t\t11\n\t],\n\t\"./markerDecorationsService.js\": [\n\t\t11\n\t],\n\t\"./model\": [\n\t\t4830\n\t],\n\t\"./model.js\": [\n\t\t4830\n\t],\n\t\"./modelService\": [\n\t\t931\n\t],\n\t\"./modelService.js\": [\n\t\t931\n\t],\n\t\"./resolverService\": [\n\t\t7042\n\t],\n\t\"./resolverService.js\": [\n\t\t7042\n\t],\n\t\"./semanticTokensDto\": [\n\t\t9376\n\t],\n\t\"./semanticTokensDto.js\": [\n\t\t9376\n\t],\n\t\"./semanticTokensProviderStyling\": [\n\t\t7642\n\t],\n\t\"./semanticTokensProviderStyling.js\": [\n\t\t7642\n\t],\n\t\"./semanticTokensStyling\": [\n\t\t2891\n\t],\n\t\"./semanticTokensStyling.js\": [\n\t\t2891\n\t],\n\t\"./semanticTokensStylingService\": [\n\t\t8148\n\t],\n\t\"./semanticTokensStylingService.js\": [\n\t\t8148\n\t],\n\t\"./textModelSync/textModelSync.impl\": [\n\t\t1171\n\t],\n\t\"./textModelSync/textModelSync.impl.js\": [\n\t\t1171\n\t],\n\t\"./textModelSync/textModelSync.protocol\": [\n\t\t5628,\n\t\t5628\n\t],\n\t\"./textModelSync/textModelSync.protocol.js\": [\n\t\t5628,\n\t\t5628\n\t],\n\t\"./textResourceConfiguration\": [\n\t\t1504\n\t],\n\t\"./textResourceConfiguration.js\": [\n\t\t1504\n\t],\n\t\"./treeSitterParserService\": [\n\t\t5320\n\t],\n\t\"./treeSitterParserService.js\": [\n\t\t5320\n\t],\n\t\"./treeViewsDnd\": [\n\t\t2603\n\t],\n\t\"./treeViewsDnd.js\": [\n\t\t2603\n\t],\n\t\"./treeViewsDndService\": [\n\t\t6756\n\t],\n\t\"./treeViewsDndService.js\": [\n\t\t6756\n\t],\n\t\"./unicodeTextModelHighlighter\": [\n\t\t9887\n\t],\n\t\"./unicodeTextModelHighlighter.js\": [\n\t\t9887\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorBaseApi\": [\n\t\t3059\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorBaseApi.js\": [\n\t\t3059\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorSimpleWorker\": [\n\t\t4003\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorSimpleWorker.js\": [\n\t\t4003\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorWorker\": [\n\t\t304\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorWorker.js\": [\n\t\t304\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorWorkerHost\": [\n\t\t6358\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorWorkerHost.js\": [\n\t\t6358\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/findSectionHeaders\": [\n\t\t9307\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/findSectionHeaders.js\": [\n\t\t9307\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/getIconClasses\": [\n\t\t5767\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/getIconClasses.js\": [\n\t\t5767\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageFeatureDebounce\": [\n\t\t2060\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageFeatureDebounce.js\": [\n\t\t2060\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageFeatures\": [\n\t\t2230\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageFeatures.js\": [\n\t\t2230\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageFeaturesService\": [\n\t\t6127\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageFeaturesService.js\": [\n\t\t6127\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageService\": [\n\t\t3930\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageService.js\": [\n\t\t3930\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languagesAssociations\": [\n\t\t5996\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languagesAssociations.js\": [\n\t\t5996\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languagesRegistry\": [\n\t\t6995\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languagesRegistry.js\": [\n\t\t6995\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/markerDecorations\": [\n\t\t886\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/markerDecorations.js\": [\n\t\t886\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/markerDecorationsService\": [\n\t\t11\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/markerDecorationsService.js\": [\n\t\t11\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/model\": [\n\t\t4830\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/model.js\": [\n\t\t4830\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/modelService\": [\n\t\t931\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/modelService.js\": [\n\t\t931\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/resolverService\": [\n\t\t7042\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/resolverService.js\": [\n\t\t7042\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensDto\": [\n\t\t9376\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensDto.js\": [\n\t\t9376\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensProviderStyling\": [\n\t\t7642\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensProviderStyling.js\": [\n\t\t7642\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensStyling\": [\n\t\t2891\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensStyling.js\": [\n\t\t2891\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensStylingService\": [\n\t\t8148\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensStylingService.js\": [\n\t\t8148\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.impl\": [\n\t\t1171\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.impl.js\": [\n\t\t1171\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.protocol\": [\n\t\t5628,\n\t\t5628\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.protocol.js\": [\n\t\t5628,\n\t\t5628\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/textResourceConfiguration\": [\n\t\t1504\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/textResourceConfiguration.js\": [\n\t\t1504\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/treeSitterParserService\": [\n\t\t5320\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/treeSitterParserService.js\": [\n\t\t5320\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/treeViewsDnd\": [\n\t\t2603\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/treeViewsDnd.js\": [\n\t\t2603\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/treeViewsDndService\": [\n\t\t6756\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/treeViewsDndService.js\": [\n\t\t6756\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/unicodeTextModelHighlighter\": [\n\t\t9887\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/unicodeTextModelHighlighter.js\": [\n\t\t9887\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function() { return Object.keys(map); };\nwebpackAsyncContext.id = 9204;\nmodule.exports = webpackAsyncContext;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdO = {};","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"js/\" + chunkId + \".\" + {\"198\":\"019281a0\",\"205\":\"be988e82\",\"398\":\"69575a9b\",\"494\":\"b89d81c7\",\"558\":\"3d98b531\",\"910\":\"07627dc0\",\"946\":\"8bd6966d\",\"968\":\"93dcd98b\",\"970\":\"5966d6de\",\"1118\":\"15282e03\",\"1122\":\"cfb3ef65\",\"1282\":\"fe485f76\",\"1420\":\"b6d319fd\",\"1438\":\"cd56bc64\",\"1446\":\"723579ce\",\"1560\":\"e1c2012f\",\"1710\":\"365111e7\",\"1740\":\"60cd1a85\",\"1888\":\"347a0ce3\",\"1914\":\"f5ef0dc3\",\"2077\":\"91fa0ff8\",\"2094\":\"ca683993\",\"2244\":\"b0b04def\",\"2278\":\"31aec673\",\"2398\":\"6d75374a\",\"2586\":\"d68a1ef4\",\"2658\":\"b7a6e5e0\",\"2686\":\"7c641f9a\",\"2692\":\"3063380d\",\"2745\":\"1588fb81\",\"2962\":\"15c4ae8f\",\"3042\":\"6c75c68a\",\"3062\":\"8610b604\",\"3096\":\"c1b9df44\",\"3182\":\"3c94dc32\",\"3622\":\"9bef8934\",\"3726\":\"cf3bdbf6\",\"4114\":\"53ba94e6\",\"4120\":\"64ebe536\",\"4334\":\"c35675f2\",\"4630\":\"c752b031\",\"4680\":\"3ac34c98\",\"4698\":\"8057b0c7\",\"4839\":\"a1498f0d\",\"4958\":\"8730b31c\",\"4962\":\"34107969\",\"5130\":\"b32ce11f\",\"5196\":\"986b08da\",\"5364\":\"83c7c473\",\"5550\":\"e043983b\",\"5618\":\"579221bd\",\"5628\":\"652b5ba0\",\"5786\":\"9d2fb584\",\"5966\":\"93daa54c\",\"6018\":\"4bfaea07\",\"6134\":\"31ac4595\",\"6185\":\"50d53859\",\"6302\":\"eefcb942\",\"6414\":\"5215c642\",\"6446\":\"e2507bc6\",\"6590\":\"39cf1ba2\",\"6830\":\"d1e27f9f\",\"6940\":\"e244bf19\",\"6990\":\"e8352b4c\",\"7048\":\"aeff6a27\",\"7200\":\"d6e8fb13\",\"7246\":\"a7457529\",\"7466\":\"f5692250\",\"7614\":\"bbe567f9\",\"7836\":\"30f7ef17\",\"7886\":\"4f4416aa\",\"8230\":\"e36f02c9\",\"8332\":\"2977d15b\",\"8334\":\"7cfa7470\",\"8390\":\"20350234\",\"8494\":\"7efc76d6\",\"8542\":\"c4468ea6\",\"8566\":\"10bf1b35\",\"8902\":\"7c55c148\",\"8990\":\"577df295\",\"9034\":\"116f7535\",\"9038\":\"e307fc2b\",\"9150\":\"0fa22a99\",\"9355\":\"86db726d\",\"9390\":\"fa40267e\",\"9510\":\"fe86be6b\",\"9838\":\"c93b6fa0\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"things-editor:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/utopia-things-editor/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t3524: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkthings_editor\"] = self[\"webpackChunkthings_editor\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(906); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["class","style","ref","loadState","saveState","exportImage","onItemDropdownSelect","selectedItemType","onPageDropdownSelect","selectedPageType","warningText","type","placeholder","username","loadSampleDocument","min","max","step","headerFontPt","number","subheaderFontPt","bodyFontPt","showGridOverlay","resetLayoutDefaults","tabindex","focusEditor","defaultGradient","ensureTrailingSlash","value","endsWith","baseAssetPath","pointsImage","offsetsForScale","scale","position","imageBottom","bodySoulBottom","mindBottom","toNumber","fallback","parsed","Number","isNaN","ParentChevronComponent","name","props","required","column","setup","textSize","showMenu","fill","color1","color2","stop1","stop2","descriptionTop","descriptionColor","height","offsets","gradientId","updateTextSize","event","target","updateDescriptionTop","updateColorOne","updateStopOne","updateColorTwo","updateStopTwo","updateDescriptionColor","reset","template","ChevronComponent","marginTop","zIndex","display","extrasTop","TalentTree","components","ParentChevron","Chevron","default","columns","chevronPositions","Array","from","length","Math","_","idx","ChevronTalentTree","constructor","container","options","this","mountEl","document","createElement","className","appendChild","app","mount","destroy","unmount","parentNode","removeChild","parse","input","columnCount","parseInt","lines","split","escapeHTML","str","String","replace","applyInlineFormatting","text","safe","m","t","u","createEl","tag","el","undefined","textContent","makeColumn","makePage","pageType","page","setProperty","RE","comment","pageNum","spacing","equipment","equipmentDetail","equipmentNext","spell","spellDetail","spellNext","specialist","noteStart","blockEnd","toc","heading","talentStart","talentContent","talentEnd","styleBegin","styleEnd","img","codeFenceBegin","hr","pageBreak","parent","pages","activePageIndex","activePage","pageColumns","activeColumnIndex","noteDiv","equipmentDiv","equipmentSectionContainer","equipmentSectionCount","spellDiv","spellArtistries","spellSectionContainer","spellSectionCount","treeDiv","talentTreeInstance","tocDiv","styleCollect","specialistDiv","pageColumnLimits","getActiveColumn","ensureColumn","querySelector","startNewPage","pageLabel","push","firstCol","col","pageDiv","test","toString","padStart","startEquipment","rarity","toLowerCase","contentWrap","title","startSpell","startTalent","count","pageContent","innerHTML","endTalent","addEquipmentDetail","kind","rawContent","detail","left","rest","right","join","trim","first","second","addSpellDetail","arts","forEach","a","nextEquipmentSection","section","nextSpellSection","endEquipment","endSpell","artistryCount","artistry","artistryIcon","setAttribute","e","console","error","startNote","firstLine","wrapper","makeImg","cls","file","src","gradient","p","appendNoteLine","line","endNote","startTOC","endTOC","addTOCEntry","entry","addHeading","level","span","attrs","h","id","classes","c","classList","add","includes","addParagraph","addSpacing","px","amount","parseFloat","isFinite","spacer","addPageNumber","num","advanceColumn","cols","limit","newCol","addTalentContent","content","contains","label","description","parseAttributeBlock","body","attrMatch","match","attrContent","remaining","slice","index","rawTokens","startsWith","val","substring","addSpecialistTable","div","headerWrap","headerRow","cell","i","raw","styleEl","css","mDet","parts","exec","h2","desc","splits","map","s","row","alt","pb","mList","ul","liLine","mItem","li","mOrdered","ol","mf","lang","buffer","pre","code","pAttrs","data","documentType","docWidth","docHeight","headerFontPx","subheaderFontPx","bodyFontPx","dpi","isSaving","selectedSnippet","showUsername","layoutDefaults","width","headerPt","subheaderPt","bodyPt","mounted","setInterval","model","_monacoEditor","getModel","getValue","setTimeout","$nextTick","tick","$refs","viewerContainer","$watch","viewerContent","backgroundImage","backgroundSize","backgroundRepeat","backgroundPosition","viewer","querySelectorAll","usernameDisplay","beforeUnmount","dispose","_viewerResizeObserver","disconnect","_editorResizeObserver","window","__thingsEditor","methods","updateUsernameDisplays","log","onInsertSelect","onSnippetDropdownSelect","snippetKey","snippets","snippet","onEquipmentButtonClick","onPageButtonClick","samples","sample","shouldReplace","canConfirm","confirm","setValue","localStorage","getItem","editor","current","selection","hadFocus","getSelection","activeElement","monacoContainer","setSelection","focus","now","Date","_lastSave","setItem","warn","register","setMonarchTokensProvider","defaultToken","keywords","typeKeywords","operators","symbols","escapes","tokenizer","root","defineTheme","base","inherit","rules","token","foreground","fontStyle","colors","create","language","wordWrap","theme","renderMarkdown","themeBackgrounds","info","lore","themeColors","headerColor","parsedContent","updateScale","onDidChangeModelContent","pxToPt","updateVars","ptToPx","ResizeObserver","ro","observe","addEventListener","bind","roEditor","layout","option","insertText","pos","getPosition","full","executeEdits","range","lineNumber","forceMoveMarkers","async","alert","zip","usedPageNumbers","pageNumber","blob","dataUrl","dataurl","arr","mime","bstr","atob","n","u8arr","Uint8Array","charCodeAt","Blob","size","err","generateAsync","url","URL","createObjectURL","href","download","click","remove","revokeObjectURL","err2","exportPdf","pdfDoc","PDFDocument","fonts","regular","embedFont","StandardFonts","Helvetica","bold","HelveticaBold","italic","HelveticaOblique","boldItalic","HelveticaBoldOblique","pageWidthPt","pageHeightPt","pageElement","pdfPage","addPage","pngImage","embedPng","drawImage","x","y","opacity","imgErr","pageRect","getBoundingClientRect","textBlocks","_collectTextBlocks","element","computed","getComputedStyle","visibility","normalizedText","_normalizeTextContent","innerText","elementRect","paddingLeft","paddingRight","paddingTop","widthPx","xPx","yTopPx","top","fontSizePx","fontSize","lineHeightPx","lineHeight","fontSizePt","lineHeightPt","maxWidthPt","font","_resolveFont","color","_cssColorToRgb","_wrapTextIntoLines","cursorY","align","textAlign","lineWidth","widthOfTextAtSize","lineX","drawText","pdfBytes","save","blocks","visit","HTMLElement","tagName","children","filter","child","childStyle","hasBlockChild","some","hasTextNode","childNodes","node","nodeType","Node","TEXT_NODE","isBlockLike","colorString","normalizedOpacity","rgb","rgbaMatch","r","g","b","finalOpacity","hexMatch","hex","ch","intVal","weight","fontWeight","isBold","isItalic","maxWidth","paragraphs","paragraph","trimmedParagraph","words","currentLine","rawWord","word","candidate","candidateWidth","wordWidth","fragments","_breakWordIntoChunks","chunks","char","containerW","clientWidth","containerH","clientHeight","docW","docH","scaleX","scaleY","scaledW","scaledH","offsetX","offsetY","transformOrigin","transform","pt","__exports__","ThingsEditor","render","App","webpackAsyncContext","req","Promise","resolve","then","__webpack_require__","o","Error","keys","Object","module","exports","ids","all","__webpack_module_cache__","moduleId","cachedModule","__webpack_modules__","call","amdO","deferred","O","result","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","key","splice","getter","__esModule","d","definition","defineProperty","enumerable","get","f","chunkId","reduce","promises","miniCssF","globalThis","Function","obj","prop","prototype","hasOwnProperty","inProgress","dataWebpackPrefix","l","done","script","needAttach","scripts","getElementsByTagName","getAttribute","charset","timeout","nc","onScriptComplete","prev","onerror","onload","clearTimeout","doneFns","head","Symbol","toStringTag","installedChunks","installedChunkData","promise","reject","loadingEnded","errorType","realSrc","message","request","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}