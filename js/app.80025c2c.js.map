{"version":3,"file":"js/app.80025c2c.js","mappings":"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ACtB,MAED,4BAA6B,CAC5B,MAED,+BAAgC,CAC/B,MAED,qBAAsB,CACrB,MAED,wBAAyB,CACxB,MAED,4BAA6B,CAC5B,MAED,+BAAgC,CAC/B,MAED,oBAAqB,CACpB,MAED,uBAAwB,CACvB,MAED,0BAA2B,CAC1B,MAED,6BAA8B,CAC7B,MAED,sBAAuB,CACtB,MAED,yBAA0B,CACzB,MAED,sBAAuB,CACtB,KAED,yBAA0B,CACzB,KAED,6BAA8B,CAC7B,IAED,gCAAiC,CAChC,IAED,UAAW,CACV,MAED,aAAc,CACb,MAED,iBAAkB,CACjB,KAED,oBAAqB,CACpB,KAED,oBAAqB,CACpB,MAED,uBAAwB,CACvB,MAED,sBAAuB,CACtB,MAED,yBAA0B,CACzB,MAED,kCAAmC,CAClC,MAED,qCAAsC,CACrC,MAED,0BAA2B,CAC1B,MAED,6BAA8B,CAC7B,MAED,iCAAkC,CACjC,MAED,oCAAqC,CACpC,MAED,qCAAsC,CACrC,MAED,wCAAyC,CACxC,MAED,yCAA0C,CACzC,KACA,MAED,4CAA6C,CAC5C,KACA,MAED,8BAA+B,CAC9B,MAED,iCAAkC,CACjC,MAED,4BAA6B,CAC5B,MAED,+BAAgC,CAC/B,MAED,iBAAkB,CACjB,MAED,oBAAqB,CACpB,MAED,wBAAyB,CACxB,MAED,2BAA4B,CAC3B,MAED,gCAAiC,CAChC,MAED,mCAAoC,CACnC,MAED,4DAA6D,CAC5D,MAED,+DAAgE,CAC/D,MAED,iEAAkE,CACjE,MAED,oEAAqE,CACpE,MAED,2DAA4D,CAC3D,KAED,8DAA+D,CAC9D,KAED,+DAAgE,CAC/D,MAED,kEAAmE,CAClE,MAED,iEAAkE,CACjE,MAED,oEAAqE,CACpE,MAED,6DAA8D,CAC7D,MAED,gEAAiE,CAChE,MAED,sEAAuE,CACtE,MAED,yEAA0E,CACzE,MAED,+DAAgE,CAC/D,MAED,kEAAmE,CAClE,MAED,sEAAuE,CACtE,MAED,yEAA0E,CACzE,MAED,8DAA+D,CAC9D,MAED,iEAAkE,CACjE,MAED,oEAAqE,CACpE,MAED,uEAAwE,CACvE,MAE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","sources":["webpack://things-editor/./src/App.vue","webpack://things-editor/./src/components/Editor.vue","webpack://things-editor/./src/components/Parser.js","webpack://things-editor/./src/components/Editor.vue?81e4","webpack://things-editor/./src/App.vue?7ccd","webpack://things-editor/./src/main.js","webpack://things-editor/./node_modules/monaco-editor/esm/vs/base/common/worker/ lazy ^.*$ namespace object","webpack://things-editor/./node_modules/monaco-editor/esm/vs/editor/common/services/ lazy ^.*$ namespace object","webpack://things-editor/webpack/bootstrap","webpack://things-editor/webpack/runtime/amd options","webpack://things-editor/webpack/runtime/chunk loaded","webpack://things-editor/webpack/runtime/compat get default export","webpack://things-editor/webpack/runtime/define property getters","webpack://things-editor/webpack/runtime/ensure chunk","webpack://things-editor/webpack/runtime/get javascript chunk filename","webpack://things-editor/webpack/runtime/get mini-css chunk filename","webpack://things-editor/webpack/runtime/global","webpack://things-editor/webpack/runtime/hasOwnProperty shorthand","webpack://things-editor/webpack/runtime/load script","webpack://things-editor/webpack/runtime/make namespace object","webpack://things-editor/webpack/runtime/publicPath","webpack://things-editor/webpack/runtime/jsonp chunk loading","webpack://things-editor/webpack/startup"],"sourcesContent":["<template>\n  <ThingsEditor />\n</template>\n\n<script>\nimport ThingsEditor from './components/Editor.vue';\n\nexport default {\n  name: 'App',\n  components: {\n    ThingsEditor\n  }\n}\n\n</script>\n\n<style>\nbody {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n</style>\n","<template>\n  <div class=\"main-container\">\n\n    <div class=\"editor-container\">\n      <div class=\"editor-toolbar\">\n        <div class=\"toolbar-left\">\n          <div class=\"control\">\n            <label class=\"control-label\">Type</label>\n            <select v-model=\"documentType\" class=\"control-select\">\n              <option value=\"info\">Info</option>\n              <option value=\"lore\">Lore</option>\n            </select>\n          </div>\n\n          <div class=\"control\">\n            <label class=\"control-label\">Columns</label>\n            <select v-model=\"columnCount\" class=\"control-select\">\n              <option value=\"1\">1</option>\n              <option value=\"2\">2</option>\n              <option value=\"3\">3</option>\n            </select>\n          </div>\n        </div>\n\n        <div class=\"toolbar-center\">\n          <div class=\"control\">\n            <button class=\"btn secondary\" @click=\"loadState\">Load</button>\n          </div>\n          <div class=\"control\">\n            <button class=\"btn primary\" @click=\"saveState\">Save</button>\n          </div>\n        </div>\n\n        <div class=\"toolbar-right\">\n          <div class=\"control\" style=\"width: 150px;\">\n            <span class=\"save-timer\" v-if=\"isSaving\">Auto-saving...</span>\n          </div>\n          <button class=\"btn primary\" @click=\"exportImage\">Export</button>\n        </div>\n      </div>\n\n      <div class=\"editor-toolbar\">\n        <div class=\"toolbar-left\">\n          <div class=\"control\">\n            <label class=\"control-label\"><i class=\"ra ra-hammer\"></i> Insert Item</label>\n            <select @change=\"onItemDropdownSelect\" class=\"control-select\">\n              <option disabled selected value=\"\">Select Item Type...</option>\n              <option value=\"equipment\">Blank Equipment Template</option>\n              <option value=\"sample_javelin\">Sample: \"JAVELIN OF THE SKIES\"</option>\n              <option value=\"sample_specialist_table\">Sample: Specialist Talent Table</option>\n              <option value=\"sample_spell\">Sample: Spell Template</option>\n            </select>\n          </div>\n\n          <div class=\"control\">\n            <label class=\"control-label\"><i class=\"ra ra-book\"></i> Insert Page</label>\n            <select @change=\"onPageDropdownSelect\" class=\"control-select\">\n              <option disabled selected value=\"\">Select Page Type...</option>\n              <option value=\"info\">Info Page</option>\n              <option value=\"lore\">Lore Page</option>\n              <option value=\"gameplay\">Gameplay Page</option>\n              <option value=\"species\">Species Page</option>\n              <option value=\"talent\">Talent Page</option>\n              <option value=\"toc\">ToC Page</option>\n              <option value=\"advanced\">Advanced Page</option>\n            </select>\n          </div>\n        </div>\n\n        <div class=\"toolbar-right\">\n          <div class=\"control\" style=\"width: 300px; text-align: right; color: #f39c12;\" v-if=\"warningText\">\n            <i class=\"ra ra-exclamation-triangle\"></i> {{ warningText }}\n          </div>\n        </div>\n      </div>\n\n      <div ref=\"monacoContainer\" class=\"editor\" aria-label=\"Markdown editor\" tabindex=\"0\" @click=\"focusEditor\"></div>\n    </div>\n\n    <div ref=\"viewerContainer\" class=\"viewer\" aria-label=\"Document preview\"></div>\n\n  </div>\n</template>\n\n<script>\nimport * as monaco from 'monaco-editor';\nimport { parse } from './Parser';\nimport domtoimage from 'dom-to-image-more';\nimport JSZip from 'jszip';\nimport * as FileSaver from 'file-saver';\n//import CustomDropdown from './CustomDropdown.vue';\n\nexport default {\n  name: 'ThingsEditor',\n  //components: { CustomDropdown },\n\n  data() {\n    return {\n      documentType: \"info\",\n      columnCount: 2,\n\n      docWidth: 1275,\n      docHeight: 1650,\n      headerFontPx: 58.333333333333336,\n      subheaderFontPx: 50,\n      bodyFontPx: 25,\n\n      dpi: 150,\n      headerFontPt: 28,\n      subheaderFontPt: 24,\n      bodyFontPt: 12,\n\n      isSaving: false,\n      warningText: '',\n    };\n  },\n\n  mounted() {\n\n    setInterval(() => {\n      const model = this._monacoEditor ? this._monacoEditor.getModel() : null;\n      if (model && model.getValue().length > 0) {\n        this.isSaving = true;\n        this.saveState();\n        setTimeout(() => this.isSaving = false, 1000);\n      }\n    }, 20000);\n\n    // Only auto-load saved state if there is no existing content in the editor\n    // setTimeout(() => {\n    //   if (this._monacoEditor) {\n    //   const model = this._monacoEditor.getModel();\n    //   if (model && !model.getValue()) {\n    //     this.loadState();\n    //   }\n    //   }\n    // }, 500);\n\n    this.$nextTick(() => {\n      this.tick();\n\n      // set initial header color; the background image will be applied to\n      // the document root inside renderMarkdown so it scales and aligns with\n      // the document content.\n      const container = this.$refs.viewerContainer;\n      if (container) {\n        if (this.documentType === 'info') {\n          container.style.setProperty('--header-color', '#0067a9');\n        } else {\n          container.style.setProperty('--header-color', '#8349a4');\n        }\n      }\n\n      this.$watch('documentType', () => {\n        // If a document root already exists, update its background so it\n        // stays aligned with the document content. Otherwise header color\n        // will be applied when the document is next rendered.\n        const viewerContent = this.$refs.viewerContainer && this.$refs.viewerContainer.querySelector('.viewer-content');\n\n        switch (this.documentType) {\n          case 'info':\n            if (viewerContent) {\n              viewerContent.style.backgroundImage = \"url('../assets/documents/info-sheet.png')\";\n              viewerContent.style.backgroundSize = '100% 100%';\n              viewerContent.style.backgroundRepeat = 'no-repeat';\n              viewerContent.style.backgroundPosition = 'top left';\n            }\n            if (this.$refs.viewerContainer) this.$refs.viewerContainer.style.setProperty('--header-color', '#0067a9');\n            break;\n          case 'lore':\n            if (viewerContent) {\n              viewerContent.style.backgroundImage = \"url('../assets/documents/lore-sheet.png')\";\n              viewerContent.style.backgroundSize = '100% 100%';\n              viewerContent.style.backgroundRepeat = 'no-repeat';\n              viewerContent.style.backgroundPosition = 'top left';\n            }\n            if (this.$refs.viewerContainer) this.$refs.viewerContainer.style.setProperty('--header-color', '#8349a4');\n            break;\n        }\n      });\n    });\n  },\n\n  beforeUnmount() {\n    // dispose Monaco editor and observers when component is removed\n    try {\n      if (this._monacoEditor) {\n        this._monacoEditor.dispose();\n        this._monacoEditor = null;\n      }\n    } catch (e) { }\n\n    try {\n      if (this._viewerResizeObserver) {\n        this._viewerResizeObserver.disconnect();\n        this._viewerResizeObserver = null;\n      }\n    } catch (e) { }\n\n    try {\n      if (this._editorResizeObserver) {\n        this._editorResizeObserver.disconnect();\n        this._editorResizeObserver = null;\n      }\n    } catch (e) { }\n    try { if (window && window.__thingsEditor) delete window.__thingsEditor; } catch (e) { }\n  },\n\n  methods: {\n    onItemDropdownSelect(event) {\n      console.log('Item dropdown changed:', event);\n      if (event.target.value === \"sample_javelin\") {\n        this.onInsertSelect({\n          value: [\n            \"/equipment mythic JAVELIN OF THE SKIES\",\n            \"/type Fast Weapon, Mythical\",\n            \"/cost 7040 Silver Pieces\",\n            \"/next\",\n            \"/tag Attack Speed: 1 Turn Action\",\n            \"/tag Handling: 2 hands\",\n            \"/tag Range: 15 meters (Ranged)\",\n            \"/tag Size: 27 slots\",\n            \"/next\",\n            \"/damage 7d4 Energy Damage\",\n            \"/desc Attacks made with this weapon affect all creatures within a 1 meter wide line, originating from the user, extending out to the weapon's range. Tests for accuracy do not need to be made.\",\n            \"/desc This weapon is sentient, sensing objects and creatures within 10 meters of it, and can communicate basic emotions directly to its user.\",\n            \"/desc Damage dealt by this weapon ignores defenses.\",\n            \"/desc This weapon requires 1 stamina to attack with. This weapon consumes 1 cell during each attack. Ammunition used this way must be equipped on the user's back or waist slot.\",\n            \"/next\",\n            \"/flavor One of three weapons a part of the Nine Divines. It uses its sentience to implore progress and calculated improvement. Naturally, it hovers between the two hands of its user, firing trailing shards of lightning at high speeds.\",\n            \"/craft 1 Mythical Material Component\",\n            \"/craft 4 Mythical Refinement Components\",\n            \"/craft 3 Mythical Power Components\",\n            \"/end\"\n          ].join('\\n')\n        });\n      }\n      else if (event.target.value === \"equipment\") {\n        this.onInsertSelect({\n          value: [\n            \"/equipment <rarity> <name>\",\n            \"/type\",\n            \"/cost\",\n            \"/next\",\n            \"/tag <tag>\",\n            \"/next\",\n            \"/damage 7d4 <damageType> Damage\",\n            \"/desc <description>\",\n            \"/next\",\n            \"/flavor <flavor text>\",\n            \"/craft <quantity> <component>\",\n            \"/end\"\n          ].join('\\n')\n        });\n      }\n      else if (event.target.value === \"sample_specialist_table\") {\n        this.onInsertSelect({\n          value: [\n            \"/page talent 1\",\n            \"/specialist\",\n            \"/title Arcane Specialist Talents\",\n            \"/desc Arcane specialist talents are used to push a caster when putting spells together, allowing for significant versatility. Some require that the caster have a specific talent within the Magecraft tree, others require that the caster can simply cast spells at all, even less require specific trait scores.\",\n            \"Subtle Spells | Must have at least one talent from the **Magecraft** core talent tree. | You may cast spells without making any physical or audible gestures. Creatures gaina point of favor on tests made to resist spells cast this way. You may cast spells 2 meters through a medium rather than 1.\",\n            \"Mystical Cognizance | Must have the **Subtle Spells** specialist talent. | When casting spells with no physical gestures, creatures do not gain a point of favor on tests made to resist spells cast this way. You may cast spells 3 meters through a medium rather than 2.\",\n            \"Arcane Withdrawal | Must know the Art of **Enchantment.** | You may spend 6 turn actions to undo a permanent spell that you cast, given you are within 1 meter of the spell's effects.\",\n            \"In Tune | Must have a **Will** score of 10 or higher. | Your spellcap is equal to your **Will** score. If you have no Spellcap, spells you cast cost less stamina by an amount equal to your **Soul** score.\",\n            \"Enlightened | Must have the **In Tune** specialist talent.\\\\nMust be able to use at least three **Arcane Arts.** | Your Spellcap is equal to double your **Will** score. If you have no Spellcap, spells you cast cost less stamina by an amount equal to your **Mind** score.\",\n            \"Occult Mind | Must have at least one talent rom the **Magecraft** core talent tree. | You gain 2 points of favor on tests made to resist losing Focus or breaking Concentration.\",\n            \"Pyromancy | Must know the Art of **Evocation.** | You may cast spells that deal only Heat damage and cost 3 stamina or less after discounts without spending any stamina.\",\n            \"Cryomancy | Must know the Art of **Evocation.** | You may cast spells that deal only Chill damage and cost 3 stamina or less after discounts without spending any stamina.\",\n            \"/end\"\n          ].join('\\n')\n        })\n      }\n      else if (event.target.value === \"sample_spell\") {\n        this.onInsertSelect({\n          value: [\n            \"/page equipment 1\",\n            \"/spell DISPEL\",\n            \"/type Utility\",\n            \"/arts Enchantment, Illusion, Necromancy, Evocation\",\n            \"/next\",\n            \"/tag Duration: Immediate\",\n            \"/tag Range: Touch\",\n            \"/tag AOE: Target Spell\",\n            \"/next\",\n            \"/stamina 5 TIMES X STAMINA\",\n            \"/desc You grasp something affected by a spell, methodically unweaving its runes. If a creature is currently focusing or concentrating on the spell, it makes a Will contest against you. Given the spell is no older than X hours and any apposing creatures fail their test, the spell ends.\",\n            \"/end\"\n          ].join('\\n')\n        })\n      }\n      // Reset dropdown after insert\n      this.selectedItemType = \"\";\n    },\n\n    onPageDropdownSelect(event) {\n      const pageType = event.target.value;\n      if (pageType) {\n        this.onInsertSelect({ value: `/page ${pageType} 1` });\n        // Reset dropdown after insert\n        this.selectedPageType = \"\";\n      }\n    },\n\n    onEquipmentButtonClick() {\n      this.onItemDropdownSelect();\n    },\n\n    onPageButtonClick(type) {\n      this.selectedPageType = type;\n      this.onPageDropdownSelect();\n    },\n\n    loadState() {\n      const content = localStorage.getItem('things-editor-content');\n      console.log('Loaded content:', content);\n      if (typeof content === 'string' && this._monacoEditor) {\n        const editor = this._monacoEditor;\n        const model = editor.getModel();\n        if (model) {\n          const current = model.getValue();\n          // avoid replacing the model value if identical (prevents focus/selection loss)\n          if (content !== current) {\n            let selection = null;\n            let hadFocus = false;\n            try {\n              selection = editor.getSelection();\n              hadFocus = document.activeElement && (this.$refs.monacoContainer && this.$refs.monacoContainer.contains(document.activeElement));\n            } catch (e) { }\n\n            model.setValue(content);\n\n            try {\n              if (selection) editor.setSelection(selection);\n              if (hadFocus) editor.focus();\n            } catch (e) { }\n          }\n        }\n      }\n    },\n\n    saveState() {\n      // simple throttle to avoid blocking UI with many writes\n      const now = Date.now();\n      if (this._lastSave && now - this._lastSave < 200) return;\n      this._lastSave = now;\n\n      if (!this._monacoEditor) return;\n      const model = this._monacoEditor.getModel();\n      if (!model) return;\n      const content = model.getValue();\n      try {\n        localStorage.setItem('things-editor-content', content);\n      } catch (e) {\n        console.warn('Failed to save to localStorage:', e);\n      }\n      console.log('Saved content:', content);\n    },\n\n    tick() {\n      const container = this.$refs.monacoContainer;\n      const viewerContainer = this.$refs.viewerContainer;\n\n      if (container && viewerContainer) {\n        // Register a small custom language that highlights our Parser commands\n        try {\n          monaco.languages.register({ id: 'utopia' });\n\n          monaco.languages.setMonarchTokensProvider('utopia', {\n            defaultToken: 'invalid',\n            keywords: [],\n            typeKeywords: [],\n            operators: [],\n            symbols: /[-+*/=<>!]+/,\n            escapes: /\\\\(?:[abfnrtv\\\\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,\n\n            tokenizer: {\n              root: [\n                // commands that start a line: /page, /column, /note, /end, /spacing, /page-num\n                [/^\\/(page|column|note|info|lore|end|spacing|page-num|advanced|toc)\\b/i, 'utopia.command'],\n                // page types used with /page commands (case-insensitive)\n                [/(equipment|gameplay|info|lore|species|talent|toc|advanced)\\b/i, 'utopia.pagetype'],\n                // talents\n                [/\\/(specialist)\\b/i, 'utopia.talent'],\n                // equipment, spells (case-insensitive)\n                [/\\/(equipment|spell)\\b/i, 'utopia.equipment'],\n                [/\\/(type|cost|tag|damage|desc|flavor|craft)\\b/i, 'utopia.equipment'],\n                // rarity colors (match common variants and be case-insensitive)\n                [/\\bcrude\\b/i, 'utopia.crude'],\n                [/\\bcommon\\b/i, 'utopia.common'],\n                [/\\buncommon\\b/i, 'utopia.uncommon'],\n                [/\\brare\\b/i, 'utopia.rare'],\n                [/\\blegendary\\b/i, 'utopia.legendary'],\n                [/\\bmythic(?:al)?\\b/i, 'utopia.mythical'],\n                // comment\n                [/^\\/\\/\\s+(.*)$/i, 'utopia.comment'],\n                // numeric values\n                [/\\b\\d+\\b/, 'number'],\n                // markdown-style headings\n                [/^#{1,6}[^\\n]*/, 'utopia.heading'],\n                // bold / italic inline (simple)\n                [/\\*\\*(.+?)\\*\\*/, 'utopia.strong'],\n                [/\\*(.+?)\\*/, 'utopia.emphasis'],\n                // escaped characters (use Monarch reference to the escapes pattern)\n                [/@escapes/, 'string.escape'],\n                [/\\n/, 'string.escape'],\n                // table cells\n                [/[A-Za-z0-9\\s]+(?=\\||$)/, 'table-cell'],\n                // whitespace (consume spaces so word-based rules can match at word-start)\n                [/[ \\t]+/, ''],\n                // pipes\n                [/\\|/, 'delimiter.pipe'],\n                // everything else (avoid consuming pipes so pipe token can match)\n                [/[^|\\n]+/, '']\n              ]\n            }\n          });\n\n          monaco.editor.defineTheme('utopia-theme', {\n            base: 'vs-dark',\n            inherit: true,\n            rules: [\n              { token: 'utopia.command', foreground: 'FFA500', fontStyle: 'bold' }, // orange\n              { token: 'utopia.pagetype', foreground: '00e5ff' }, // cyan\n              { token: 'utopia.equipment', foreground: 'ff79c6' }, // pink\n\n              { token: 'utopia.comment', foreground: '6272a4' }, // blue\n\n              { token: 'utopia.talent', foreground: 'ffb86c' }, // light orange\n\n              { token: 'utopia.crude', foreground: '8f9092' },\n              { token: 'utopia.common', foreground: '737790' },\n              { token: 'utopia.uncommon', foreground: '809a7d' },\n              { token: 'utopia.rare', foreground: 'c0b985' },\n              { token: 'utopia.legendary', foreground: 'b78e70' },\n              { token: 'utopia.mythical', foreground: 'a7645b' },\n\n              { token: 'table-cell', foreground: 'ff965d' },\n\n              { token: 'utopia.heading', foreground: 'ffd166', fontStyle: 'bold' }, // gold\n              { token: 'number', foreground: 'c792ea' }, // purple\n              { token: 'utopia.strong', fontStyle: 'bold' },\n              { token: 'utopia.emphasis', fontStyle: 'italic' },\n\n              { token: 'string.escape', foreground: 'ff79c6' }, // pink\n              { token: 'delimiter.pipe', foreground: 'ffd166' } // white\n            ],\n            colors: {\n              'editor.background': '#1e1e1e'\n            }\n          });\n        } catch (e) {\n          // If Monaco already registered the language, ignore errors and continue\n          console.warn('Monaco language/theme registration issue:', e);\n        }\n\n        const editor = monaco.editor.create(container, {\n          language: 'utopia',\n          wordWrap: 'on',\n          theme: 'utopia-theme'\n        });\n\n        // focus editor so keyboard input is accepted immediately\n        try {\n          editor.focus();\n        } catch (e) {\n          // ignore focus errors in test environments\n        }\n\n        // expose the monaco editor instance for toolbar actions\n        this._monacoEditor = editor;\n        // also expose to window for quick debugging in the browser console\n        try { window.__thingsEditor = editor; } catch (e) { }\n\n        const renderMarkdown = () => {\n          const content = editor.getValue();\n\n          // if (editor && (content.trim().length === 0 || !/^\\/page\\s+(equipment|gameplay|info|lore|species|talent|toc|advanced)\\s+(.+)$/i.test(content.split('\\n')[0]))) {\n          //   // if the editor is empty, show a warning\n          //   this.warningText = 'No pages defined. Add a page with /page <type> <number> (e.g. /page info 1) at the start of the document.';\n          // }\n          // else {\n          //   this.warningText = '';\n          // }\n          this.warningText = '';\n\n\n          viewerContainer.innerHTML = '';\n\n          // create a document-root sized to the Illustrator pixels\n          const viewer = document.createElement('div');\n          viewer.className = 'viewer-content';\n          viewer.style.width = this.docWidth + 'px';\n          viewer.style.height = this.docHeight + 'px';\n\n          // const documentImage = document.createElement('img');\n          // documentImage.classList.add('document-image');\n          // documentImage.src = this.documentType === 'info' ? '../assets/documents/info-sheet.png' : '../assets/documents/lore-sheet.png';\n          // viewer.appendChild(documentImage);\n\n          // set font-size vars so styles are pixel-accurate\n          viewer.style.setProperty('--header-font-px', this.headerFontPx + 'px');\n          viewer.style.setProperty('--subheader-font-px', this.subheaderFontPx + 'px');\n          viewer.style.setProperty('--body-font-px', this.bodyFontPx + 'px');\n          viewer.style.setProperty('--doc-height', this.docHeight + 'px');\n          viewer.style.setProperty('--doc-width', this.docWidth + 'px');\n          //viewer.style.setProperty('--page-background', this.documentType === 'info' ? \"url('../assets/documents/info-sheet.png')\" : \"url('../assets/documents/lore-sheet.png')\");\n          // set background image on the document root so it remains aligned\n          // with the content when scaled and when the window resizes\n          if (this.documentType === 'info') {\n            //viewer.style.backgroundImage = \"url('../assets/documents/info-sheet.png')\";\n            viewer.style.setProperty('--header-color', '#0067a9');\n          } else {\n            //viewer.style.backgroundImage = \"url('../assets/documents/lore-sheet.png')\";\n            viewer.style.setProperty('--header-color', '#8349a4');\n          }\n          viewer.style.backgroundSize = '100% 100%';\n          viewer.style.backgroundRepeat = 'no-repeat';\n          viewer.style.backgroundPosition = 'top left';\n\n          const parsedContent = parse(content, this.columnCount);\n          viewer.appendChild(parsedContent);\n          viewerContainer.appendChild(viewer);\n\n          // compute scaling to fit the viewer area while preserving pixel font sizes\n          this.updateScale();\n        };\n\n        renderMarkdown();\n\n        // Use the editor-level change event so we catch user edits\n        editor.onDidChangeModelContent(() => {\n          renderMarkdown();\n        });\n\n        // watchers for the pixel-perfect controls\n        this.$watch('docWidth', () => {\n          // force re-render so sizing updates\n          renderMarkdown();\n        });\n        this.$watch('docHeight', () => renderMarkdown());\n        this.$watch('headerFontPx', () => {\n          // keep pt in sync\n          this.headerFontPt = this.pxToPt(this.headerFontPx, this.dpi);\n          this.updateVars();\n        });\n        this.$watch('bodyFontPx', () => {\n          this.bodyFontPt = this.pxToPt(this.bodyFontPx, this.dpi);\n          this.updateVars();\n        });\n        this.$watch('columnCount', () => renderMarkdown());\n\n        this.$watch('dpi', () => {\n          // recompute px from pt when DPI changes\n          this.headerFontPx = this.ptToPx(this.headerFontPt, this.dpi);\n          this.subheaderFontPx = this.ptToPx(this.subheaderFontPt, this.dpi);\n          this.bodyFontPx = this.ptToPx(this.bodyFontPt, this.dpi);\n          renderMarkdown();\n        });\n\n        this.$watch('headerFontPt', () => {\n          this.headerFontPx = this.ptToPx(this.headerFontPt, this.dpi);\n          this.updateVars();\n        });\n\n        this.$watch('subheaderFontPt', () => {\n          this.subheaderFontPx = this.ptToPx(this.subheaderFontPt, this.dpi);\n          this.updateVars();\n        });\n\n        this.$watch('bodyFontPt', () => {\n          this.bodyFontPx = this.ptToPx(this.bodyFontPt, this.dpi);\n          this.updateVars();\n        });\n\n        // Resize observer to recompute scale when viewer size changes\n        if (window.ResizeObserver) {\n          const ro = new ResizeObserver(() => this.updateScale());\n          ro.observe(viewerContainer);\n          this._viewerResizeObserver = ro;\n        } else {\n          window.addEventListener('resize', this.updateScale.bind(this));\n        }\n        // also re-layout the monaco editor on container resize\n        if (container) {\n          const roEditor = window.ResizeObserver ? new ResizeObserver(() => {\n            try { editor.layout(); } catch (e) { }\n          }) : null;\n          if (roEditor) {\n            roEditor.observe(container);\n            this._editorResizeObserver = roEditor;\n          } else {\n            window.addEventListener('resize', () => { try { editor.layout(); } catch (e) { } });\n          }\n        }\n      }\n    },\n\n    focusEditor() {\n      if (this._monacoEditor) {\n        try { this._monacoEditor.focus(); } catch (e) { }\n      } else if (this.$refs && this.$refs.monacoContainer) {\n        try { this.$refs.monacoContainer.focus(); } catch (e) { }\n      }\n    },\n\n    onInsertSelect(option) {\n      if (!this._monacoEditor) return;\n      const insertText = option && option.value ? option.value : '';\n      const model = this._monacoEditor.getModel();\n      const pos = this._monacoEditor.getPosition();\n      if (!model || !pos) {\n        // fallback: append to end\n        const full = model.getValue();\n        model.setValue(full + '\\n' + insertText + '\\n');\n        return;\n      }\n\n      // perform an edit at the current cursor\n      this._monacoEditor.executeEdits('insert-dropdown', [{\n        range: new monaco.Range(pos.lineNumber, pos.column, pos.lineNumber, pos.column),\n        text: insertText + '\\n',\n        forceMoveMarkers: true\n      }]);\n\n      // focus editor after inserting\n      this._monacoEditor.focus();\n    },\n\n    exportImage: async function () {\n      const viewerContainer = this.$refs.viewerContainer;\n      if (!viewerContainer) return;\n\n      try {\n        // Discard the first instance of the toPng to correct object alignment\n        // eslint-disable-next-line\n        await domtoimage.toPng(viewerContainer);\n\n        const pages = Array.from(document.querySelectorAll('.page'));\n        if (pages.length === 0) {\n          console.warn('No pages found to export.');\n          alert('No pages found to export.');\n          return;\n        }\n\n        const zip = new JSZip();\n        const usedPageNumbers = [];\n\n        // Render each page to PNG and add to the zip. Prefer toBlob if available.\n        for (let i = 0; i < pages.length; i++) {\n          const page = pages[i];\n          var pageNumber = page.querySelector('.page-number') ? page.querySelector('.page-number').textContent.trim() : `page-${i + 1}`;\n\n          if (usedPageNumbers.includes(pageNumber)) {\n            console.warn(`Duplicate page number found: ${pageNumber}`);\n            alert(`Duplicate page number found: ${pageNumber}`);\n            pageNumber = `${pageNumber} - ${i}`;\n          }\n\n          usedPageNumbers.push(pageNumber);\n\n          try {\n            let blob = null;\n\n            if (domtoimage && typeof domtoimage.toBlob === 'function') {\n              // dom-to-image-more exposes toBlob in many builds\n              blob = await domtoimage.toBlob(page);\n            } else {\n              const dataUrl = await domtoimage.toPng(page);\n              // Convert dataURL to blob so JSZip stores binary data correctly\n              blob = (function dataURLtoBlob(dataurl) {\n                const arr = dataurl.split(',');\n                const mime = arr[0].match(/:(.*?);/)[1];\n                const bstr = atob(arr[1]);\n                let n = bstr.length;\n                const u8arr = new Uint8Array(n);\n                while (n--) {\n                  u8arr[n] = bstr.charCodeAt(n);\n                }\n                return new Blob([u8arr], { type: mime });\n              })(dataUrl);\n            }\n\n            if (blob) {\n              zip.file(`${pageNumber}.png`, blob);\n              console.log(`Added ${pageNumber}.png (${blob.size} bytes) to ZIP`);\n            } else {\n              console.warn(`No blob produced for page ${i + 1}`);\n            }\n          } catch (err) {\n            console.error(`Error exporting page ${i + 1}:`, err);\n          }\n        }\n\n        // Generate the zip and trigger download\n        const content = await zip.generateAsync({ type: 'blob' });\n        // Try FileSaver first, then fallback to creating an object URL and clicking an anchor.\n        try {\n          FileSaver.saveAs(content, 'document.zip');\n          console.log('ZIP generated and download triggered via FileSaver');\n        } catch (err) {\n          console.warn('FileSaver failed, falling back to anchor method:', err);\n          try {\n            const url = URL.createObjectURL(content);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = 'document.zip';\n            document.body.appendChild(a);\n            a.click();\n            a.remove();\n            // allow time for the download to start before revoking\n            setTimeout(() => URL.revokeObjectURL(url), 10000);\n            console.log('ZIP generated and download triggered via anchor fallback');\n          } catch (err2) {\n            console.error('Anchor fallback failed to save the zip:', err2);\n            alert('Failed to trigger download. Check console for details.');\n          }\n        }\n      } catch (error) {\n        console.error('Error creating ZIP:', error);\n      }\n    },\n\n    updateScale() {\n      this.$nextTick(() => {\n        const viewerContainer = this.$refs.viewerContainer;\n        if (!viewerContainer) return;\n        const viewer = viewerContainer.querySelector('.viewer-content');\n        if (!viewer) return;\n\n        const containerW = viewerContainer.clientWidth;\n        const containerH = viewerContainer.clientHeight;\n        const docW = parseFloat(this.docWidth || 1);\n        const docH = parseFloat(this.docHeight || 1);\n\n        const scaleX = containerW / docW;\n        const scaleY = containerH / docH;\n        const scale = Math.min(scaleX, scaleY, 1);\n\n        const scaledW = docW * scale;\n        const scaledH = docH * scale;\n        const offsetX = containerW > scaledW ? (containerW - scaledW) / 2 : 0;\n        const offsetY = containerH > scaledH ? (containerH - scaledH) / 2 : 0;\n\n        viewer.style.transformOrigin = 'top left';\n        viewer.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;\n        viewer.style.setProperty('--scale', scale);\n      });\n    },\n\n    updateVars() {\n      this.$nextTick(() => {\n        const viewerContainer = this.$refs.viewerContainer;\n        if (!viewerContainer) return;\n        const viewer = viewerContainer.querySelector('.viewer-content');\n        if (!viewer) return;\n        viewer.style.setProperty('--header-font-px', this.headerFontPx + 'px');\n        viewer.style.setProperty('--subheader-font-px', this.subheaderFontPx + 'px');\n        viewer.style.setProperty('--body-font-px', this.bodyFontPx + 'px');\n      });\n    }\n\n    // Helper: convert points to pixels for a given DPI.\n    // 1pt = 1/72 inch. px = pt * dpi / 72\n    , ptToPx(pt, dpi) {\n      return (parseFloat(pt) || 0) * (parseFloat(dpi) || 72) / 72;\n    }\n\n    // Helper: convert pixels to points for a given DPI.\n    , pxToPt(px, dpi) {\n      return (parseFloat(px) || 0) * 72 / (parseFloat(dpi) || 72);\n    }\n  }\n};\n</script>\n\n<style lang=\"css\">\n:root {\n  --doc-height: 1650px;\n  --doc-width: 1275px;\n  --page-background: white;\n\n  --toolbar-bg: rgba(0, 0, 0, 0.35);\n  --toolbar-fg: #fff;\n  --control-bg: rgba(255, 255, 255, 0.06);\n  --accent: #2f9adf;\n\n  --line-width: 5px;\n  --line-offset: -38px;\n  /* how far left from origin */\n  --line-shadow: 0 2px 6px rgba(0, 0, 0, 0.9);\n\n  --info-background: url('@/assets/documents/info-sheet.png');\n  --lore-background: url('@/assets/documents/lore-sheet.png');\n  --equipment-background: url('@/assets/documents/equipment-sheet.png');\n  --species-background: url('@/assets/documents/species-sheet.png');\n  --talent-background: url('@/assets/documents/talent-sheet.png');\n  --toc-background: url('@/assets/documents/toc-sheet.png');\n  --gameplay-background: url('@/assets/documents/gameplay-sheet.png');\n  --advanced-background: url('@/assets/documents/advanced-sheet.png');\n\n  --header-color: #000000;\n  --page-color: #000000;\n\n  --info-color: #0c4e81;\n  --lore-color: #32004b;\n  --equipment-color: #a36209;\n  --species-color: #007236;\n  --talent-color: #aba835;\n  --toc-color: #72103e;\n  --gameplay-color: #a36209;\n  --advanced-color: #a21d21;\n\n  --info-page-number: #203e62;\n  --lore-page-number: #39164e;\n  --equipment-page-number: #794d12;\n  --species-page-number: #00582c;\n  --talent-page-number: #706800;\n  --toc-page-number: #79314a;\n  --gameplay-page-number: #794d12;\n  --advanced-page-number: #712d24;\n\n  --rarity-crude: #8f9092;\n  --rarity-common: #737790;\n  --rarity-uncommon: #809a7d;\n  --rarity-rare: #c0b985;\n  --rarity-legendary: #b78e70;\n  --rarity-mythic: #a7645b;\n\n  --equipment-tags: url('@/assets/blocks/equipment-tags.png');\n  --equipment-description: url('@/assets/blocks/equipment-description.png');\n  --equipment-flavor: url('@/assets/blocks/equipment-flavor.png');\n\n  --section-1-border: url('@/assets/blocks/equipment-section-1-border.png');\n  --section-2-border: url('@/assets/blocks/equipment-section-2-border.png');\n  --section-3-border: url('@/assets/blocks/equipment-section-3-border.png');\n\n  --section-1-bg: #a3a4a6;\n  --section-2-bg: #cccccc;\n  --section-3-bg: #e0e0de;\n\n  --frame-crude: url('@/assets/blocks/rarity-border-crude.png');\n  --frame-common: url('@/assets/blocks/rarity-border-common.png');\n  --frame-uncommon: url('@/assets/blocks/rarity-border-uncommon.png');\n  --frame-rare: url('@/assets/blocks/rarity-border-rare.png');\n  --frame-legendary: url('@/assets/blocks/rarity-border-legendary.png');\n  --frame-mythic: url('@/assets/blocks/rarity-border-mythic.png');\n  --frame-edge: 48px;\n  --section-border-size: 48px;\n  --edge-top: 64;\n  --edge-right: 64;\n  --edge-bottom: 64;\n  --edge-left: 64;\n\n  --artistry-enchantment: url('@/assets/artistries/enchantment.svg');\n  --artistry-alteration:  url('@/assets/artistries/alteration.svg');\n  --artistry-array:  url('@/assets/artistries/array.svg');\n  --artistry-divination: url('@/assets/artistries/divination.svg');\n  --artistry-evocation:  url('@/assets/artistries/evocation.svg');\n  --artistry-illusion: url('@/assets/artistries/illusion.svg');\n  --artistry-necromancy:  url('@/assets/artistries/necromancy.svg');\n  --artistry-wake:  url('@/assets/artistries/wake.svg');  \n\n  --specialist-table: url('@/assets/blocks/specialist-table.png');\n}\n\n@font-face {\n  font-family: \"Rockwell Nova Condensed\";\n  src: url('~@/assets/fonts/RockwellNovaCond.woff') format('woff');\n  font-weight: normal;\n  font-style: normal;\n  font-display: swap;\n}\n\n@font-face {\n  font-family: \"Rockwell Nova Condensed\";\n  src: url('~@/assets/fonts/RockwellNovaCond-Bold.woff') format('woff');\n  font-weight: bold;\n  font-style: normal;\n  font-display: swap;\n}\n\n@font-face {\n  font-family: \"Rockwell Nova\";\n  src: url('~@/assets/fonts/RockwellNova.woff') format('woff');\n  font-weight: normal;\n  font-style: normal;\n  font-display: swap;\n}\n\n@font-face {\n  font-family: \"Rockwell Nova\";\n  src: url('~@/assets/fonts/RockwellNova-Bold.woff') format('woff');\n  font-weight: bold;\n  font-style: normal;\n  font-display: swap;\n}\n\n@font-face {\n  font-family: \"Bahnschrift\";\n  src: url('~@/assets/fonts/Bahnschrift.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n  font-display: swap;\n}\n\n.main-container {\n  background-color: #2b2b2b;\n  display: flex;\n  gap: 24px;\n  align-items: stretch;\n  height: 100vh;\n  padding: 20px;\n  box-sizing: border-box;\n}\n\n.editor-container {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  width: 48%;\n  height: 100%;\n}\n\n.editor-toolbar {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 12px;\n  padding: 10px;\n  background: var(--toolbar-bg);\n  color: var(--toolbar-fg);\n  border-radius: 8px;\n  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.5);\n  flex-wrap: wrap;\n}\n\n.editor-toolbar .toolbar-left,\n.editor-toolbar .toolbar-center,\n.editor-toolbar .toolbar-right {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.control {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  color: #e6eef6;\n}\n\n.control.compact {\n  flex-direction: row;\n  align-items: center;\n}\n\n.control-label {\n  font-size: 12px;\n  opacity: 0.9;\n}\n\n.control-select,\n.control-input {\n  background: #f0f0f0;\n  color: #000;\n  border: 1px solid rgba(255, 255, 255, 0.06);\n  padding: 6px 8px;\n  border-radius: 6px;\n  min-width: 64px;\n}\n\n.control-input[type=number] {\n  width: 80px;\n}\n\n.btn {\n  appearance: none;\n  border: 0;\n  padding: 10px 16px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 600;\n}\n\n.btn.primary {\n  background: linear-gradient(180deg, var(--accent), #176fa6);\n  color: white;\n  box-shadow: 0 6px 14px rgba(34, 139, 199, 0.25);\n}\n\n.editor {\n  width: calc(100% - 20px);\n  height: calc(100% - 20px);\n  text-align: left;\n}\n\n.viewer {\n  width: 52%;\n  height: calc(100% - 0px);\n  display: flex;\n  justify-content: flex-start;\n  align-items: flex-start;\n  position: relative;\n  overflow: auto;\n  background: linear-gradient(180deg, #f3f2f0 0%, #dcdcdc 100%);\n  padding: 12px;\n  border-radius: 8px;\n}\n\n.viewer-content {\n  text-align: left;\n  transform-origin: top left;\n  will-change: transform;\n  background-clip: padding-box;\n  background-origin: padding-box;\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.35);\n  border-radius: 6px;\n}\n\n.page {\n  min-width: var(--doc-width);\n  max-width: var(--doc-width);\n  min-height: var(--doc-height, 1650px);\n  max-height: var(--doc-height, 1650px);\n  position: relative;\n}\n\n.page.page-equipment {\n  background: var(--equipment-background);\n  --header-color: var(--equipment-color);\n  --page-color: var(--equipment-page-number);\n}\n\n.page.page-gameplay {\n  background: var(--gameplay-background);\n  --header-color: var(--gameplay-color);\n  --page-color: var(--gameplay-page-number);\n}\n\n.page.page-info {\n  background: var(--info-background);\n  --header-color: var(--info-color);\n  --page-color: var(--info-page-number);\n}\n\n.page.page-lore {\n  background: var(--lore-background);\n  --header-color: var(--lore-color);\n  --page-color: var(--lore-page-number);\n}\n\n.page.page-species {\n  background: var(--species-background);\n  --header-color: var(--species-color);\n  --page-color: var(--species-page-number);\n}\n\n.page.page-talent {\n  background: var(--talent-background);\n  --header-color: var(--talent-color);\n  --page-color: var(--talent-page-number);\n}\n\n.page.page-toc {\n  background: var(--toc-background);\n  --header-color: var(--toc-color);\n  --page-color: var(--toc-page-number);\n}\n\n.page.page-advanced {\n  background: var(--advanced-background);\n  --header-color: var(--advanced-color);\n  --page-color: var(--advanced-page-number);\n}\n\n.page h1 {\n  color: var(--header-color, #573084);\n  font-family: \"Rockwell Nova Condensed\";\n  font-weight: bold;\n  font-size: var(--header-font-px, 28pt);\n  line-height: 1.15;\n  margin: 0 0 28px;\n}\n\n.page h1.span-2 {\n  position: absolute;\n  left: 150px;\n  /* align with page-content left */\n  top: 125px;\n  /* adjust vertically to sit above page content */\n  width: calc(459px * 2 + 58px);\n  /* two columns + gap */\n  z-index: 6;\n  margin: 0 0 18px;\n  box-sizing: border-box;\n}\n\n.page.has-span-2 .column {\n  padding-top: 120px;\n}\n\n.page h2 {\n  color: var(--header-color, #573084);\n  font-family: \"Rockwell Nova Condensed\";\n  font-weight: bold;\n  font-size: var(--subheader-font-px, 24pt);\n  line-height: 1.15;\n  margin: 38px 0 -5px;\n}\n\n.page h3 {\n  color: var(--header-color, #573084);\n  font-family: \"Rockwell Nova Condensed\";\n  font-weight: bold;\n  font-size: var(--subheader-font-px, 24pt);\n  line-height: 1.15;\n  margin: 38px 0 -5px;\n}\n\n.page p {\n  color: black;\n  font-family: \"Bahnschrift\";\n  font-size: var(--body-font-px, 12px);\n  margin: 0 0 30px;\n  line-height: 1.2;\n}\n\n.page-content {\n  position: absolute;\n  left: 150px;\n  top: 120px;\n  display: flex;\n  gap: 50px;\n}\n\n.column {\n  max-width: 465px;\n  min-width: 465px;\n}\n\n.column h1,\n.column h2,\n.column h3,\n.column p {\n  padding-right: 5px;\n  word-wrap: break-word;\n}\n\n.column p:first-of-type {\n  margin-top: 5px;\n}\n\n.page-number {\n  color: var(--page-color);\n  font-family: \"Rockwell Nova\";\n  font-weight: bold;\n  position: absolute;\n  bottom: 25px;\n  font-size: 56px;\n  width: 100%;\n  text-align: center;\n}\n\n.note.lore {\n  color: black;\n  font-family: \"Bahnschrift\";\n  font-size: var(--body-font-px, 12px);\n  margin: 0;\n  margin-bottom: 30px;\n  line-height: 1.2;\n}\n\n.note {\n  position: relative;\n}\n\n.note::before {\n  content: \"\";\n  position: absolute;\n  top: 110px;\n  bottom: 110px;\n  left: var(--line-offset);\n  /* negative to push it out to the left */\n  width: var(--line-width);\n  /* fixed horizontal size — prevents horizontal growth */\n  background-image: linear-gradient(to right, #a7a9ac 100%, #d1d3d4 110%, #a7a9ac 120%);\n  pointer-events: none;\n  z-index: 4;\n  /* place under/over content as needed */\n  /* filter: drop-shadow(1px 2px 2px rgba(0,0,0,0.3)); */\n  border-radius: 2px;\n  /* optional subtle rounding */\n}\n\n.note-content {\n  position: relative;\n  z-index: 4;\n}\n\n.box {\n  z-index: 3;\n  position: absolute;\n}\n\n.box-gradient {\n  top: -10px;\n  left: -35px;\n  right: -35px;\n  bottom: -10px;\n  background: radial-gradient(circle at center, #00b6f1, #1c75bc);\n  border-radius: 25px;\n  z-index: 1;\n  opacity: 0.3;\n}\n\n.box-top-left {\n  top: -20px;\n  left: -40px;\n}\n\n.box-bottom-left {\n  z-index: 5;\n  bottom: -20px;\n  left: -40px;\n}\n\n.box-top-right {\n  top: -20px;\n  right: -40px;\n}\n\n.box-bottom-right {\n  bottom: -20px;\n  right: -40px;\n}\n\n.box-left {\n  z-index: 3;\n  top: 0;\n  left: -39px;\n  bottom: 0;\n  width: 8px;\n  /* fixed horizontal size so background cannot expand horizontally */\n  height: 100%;\n  transform: none;\n  position: absolute;\n  /* Prevent overflow, stretch to content height */\n  max-height: 100%;\n  pointer-events: none;\n  /* If using SVG as background, make it stretch vertically */\n  /* map the background to the fixed width (100% of 6px) and full height */\n  background-size: 100% 100%;\n  background-repeat: no-repeat;\n  backdrop-filter: drop-shadow(0 0 5px rgba(0, 0, 0, 1));\n}\n\n/* Responsive: stack editor/viewer on narrow windows */\n@media (max-width: 1100px) {\n  .main-container {\n    flex-direction: column;\n    padding: 12px;\n  }\n\n  .editor-container,\n  .viewer {\n    width: 100%;\n  }\n\n  .editor {\n    height: 360px;\n  }\n}\n\n.equipment {\n  position: relative;\n  background: var(--equipment-background);\n  background-clip: padding-box;\n  /* don’t paint behind the border */\n  isolation: isolate;\n\n  /* border-image as before */\n  border: 5px solid transparent;\n  border-image-source: var(--frame);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--frame-edge);\n  border-image-repeat: round;\n}\n\n/* map each rarity class to a custom property used by the pseudo element */\n.equipment.rarity-crude {\n  --equipment-background: var(--rarity-crude);\n  --frame: var(--frame-crude);\n}\n\n.equipment.rarity-common {\n  --equipment-background: var(--rarity-common);\n  --frame: var(--frame-common);\n}\n\n.equipment.rarity-uncommon {\n  --equipment-background: var(--rarity-uncommon);\n  --frame: var(--frame-uncommon);\n}\n\n.equipment.rarity-rare {\n  --equipment-background: var(--rarity-rare);\n  --frame: var(--frame-rare);\n}\n\n.equipment.rarity-legendary {\n  --equipment-background: var(--rarity-legendary);\n  --frame: var(--frame-legendary);\n}\n\n.equipment.rarity-mythic {\n  --equipment-background: var(--rarity-mythic);\n  --frame: var(--frame-mythic);\n}\n\n.equipment-content {\n  position: relative;\n  background-clip: content-box;\n  z-index: 1;\n  padding-top: 10px;\n  padding-left: 10px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  gap: 4px;\n}\n\n.equipment-title {\n  font-family: \"Bahnschrift\";\n  font-weight: bold;\n  font-size: 21.5px;\n}\n\n.equipment-detail {\n  font-family: \"Bahnschrift\";\n  font-size: 18px;\n  z-index: 10;\n  position: relative;\n}\n\n.equipment-detail.cost {\n  color: white;\n}\n\n.equipment-detail.tag {\n  font-family: \"Bahnschrift\";\n  font-size: 21.5px;\n  margin-bottom: 5px;\n  margin-top: 2px;\n}\n\n.equipment-tag-type {\n  font-weight: bold;\n}\n\n.equipment-detail.damage {\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 21px;\n  font-weight: bold;\n  margin-top: 13px;\n  margin-bottom: 25px;\n  text-align: center;\n}\n\n.equipment-detail.desc {\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 20.51px;\n  margin-bottom: 25px;\n  line-height: 1.22;\n}\n\n.equipment-detail.flavor {\n  color: #585858;\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 20.7px;\n  margin-bottom: 23px;\n  margin-top: 13px;\n  line-height: 1.23;\n  text-align: center;\n}\n\n.equipment-detail.craft {\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 20.7px;\n  margin-bottom: 1px;\n}\n\n.equipment-section {\n  position: relative;\n  margin-top: 2px;\n  /* reserve space for the border on all sides */\n  padding-left: 3px;\n  padding-top: 10px;\n  margin-left: 5px;\n  /* clip the background so it doesn’t render under the border */\n  background: var(--section-bg);\n  background-clip: padding-box;\n  /* no background behind the border:contentReference[oaicite:0]{index=0} */\n  /* optional: rounded corners if your frame has them */\n  border-radius: 4px;\n}\n\n.equipment-section.section-1 {\n  background-color: var(--section-1-bg);\n  /* draw the torn frame; reuse your existing border image variables */\n  border: 2px solid transparent;\n  border-image-source: var(--section-1-border);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--section-border-size);\n  border-image-repeat: round;\n}\n\n.equipment-section.section-2 {\n  padding-left: 0px;\n  background-color: var(--section-2-bg);\n  /* draw the torn frame; reuse your existing border image variables */\n  border: 5px solid transparent;\n  border-image-source: var(--section-2-border);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--section-border-size);\n  border-image-repeat: round;\n}\n\n.equipment-section.section-3 {\n  padding-left: 11px;\n  padding-right: 9px;\n  padding-bottom: 30px;\n  text-align: center;\n  background-color: var(--section-3-bg);\n  /* draw the torn frame; reuse your existing border image variables */\n  border: 5px solid transparent;\n  border-image-source: var(--section-3-border);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--section-border-size);\n  border-image-repeat: round;\n}\n\n.spell {\n  position: relative;\n  background: var(--rarity-crude);\n  background-clip: padding-box;\n  /* don’t paint behind the border */\n  isolation: isolate;\n\n  /* border-image as before */\n  border: 5px solid transparent;\n  border-image-source: var(--frame-crude);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--frame-edge);\n  border-image-repeat: round;\n}\n\n.spell-content {\n  position: relative;\n  background-clip: content-box;\n  z-index: 1;\n  padding-top: 10px;\n  padding-left: 10px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  gap: 4px;\n}\n\n.spell-title {\n  font-family: \"Bahnschrift\";\n  font-weight: bold;\n  font-size: 21.5px;\n}\n\n.spell-detail {\n  font-family: \"Bahnschrift\";\n  font-size: 18px;\n  z-index: 10;\n  position: relative;\n}\n\n.spell-detail.arts {\n  color: white;\n}\n\n.spell-detail.tag {\n  font-family: \"Bahnschrift\";\n  font-size: 21.5px;\n  margin-bottom: 5px;\n  margin-top: 2px;\n}\n\n.spell-tag-type {\n  font-weight: bold;\n}\n\n.spell-detail.stamina,\n.spell-detail.sta {\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 21px;\n  font-weight: bold;\n  margin-top: 13px;\n  margin-bottom: 25px;\n  text-align: center;\n}\n\n.spell-detail.desc {\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 20.51px;\n  margin-bottom: 25px;\n  line-height: 1.22;\n  text-align: center;\n}\n\n.spell-detail.flavor {\n  color: #585858;\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 20.7px;\n  margin-bottom: 23px;\n  margin-top: 13px;\n  line-height: 1.23;\n  text-align: center;\n}\n\n.spell-detail.craft {\n  font-family: \"Bahnschrift\";\n  font-stretch: semi-condensed;\n  font-size: 20.7px;\n  margin-bottom: 1px;\n}\n\n.spell-section {\n  position: relative;\n  margin-top: 2px;\n  /* reserve space for the border on all sides */\n  padding-left: 3px;\n  padding-top: 10px;\n  margin-left: 5px;\n  /* clip the background so it doesn’t render under the border */\n  background: var(--section-bg);\n  background-clip: padding-box;\n  /* no background behind the border:contentReference[oaicite:0]{index=0} */\n  /* optional: rounded corners if your frame has them */\n  border-radius: 4px;\n}\n\n.spell-section.section-1 {\n  background-color: var(--section-1-bg);\n  /* draw the torn frame; reuse your existing border image variables */\n  border: 2px solid transparent;\n  border-image-source: var(--section-1-border);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--section-border-size);\n  border-image-repeat: round;\n}\n\n.spell-section.section-2 {\n  padding-left: 0px;\n  background-color: var(--section-2-bg);\n  /* draw the torn frame; reuse your existing border image variables */\n  border: 5px solid transparent;\n  border-image-source: var(--section-2-border);\n  border-image-slice: var(--edge-top) var(--edge-right) var(--edge-bottom) var(--edge-left);\n  border-image-width: var(--section-border-size);\n  border-image-repeat: round;\n  position: relative;\n}\n\n.spell-section .artistry-container {\n  display: flex;\n  align-items: center;\n  gap: 0px;\n  position: absolute;\n  left: 0; right: 0; top: 0; bottom: 0;\n  height: 100%;\n  width: 100%;\n  pointer-events: none;\n  opacity: 0.2;\n}\n\n.spell-section .artistry-container-1 {\n  justify-content: center;\n}\n\n.spell-section .artistry-container-2 {\n  justify-content: space-around;\n}\n\n.spell-section .artistry-container-3,\n.spell-section .artistry-container-4,\n.spell-section .artistry-container-5,\n.spell-section .artistry-container-6 {\n  justify-content: center;\n}\n\n.spell-section .artistry-container-3 .artistry-icon:nth-child(odd),\n.spell-section .artistry-container-4 .artistry-icon:nth-child(odd),\n.spell-section .artistry-container-5 .artistry-icon:nth-child(odd),\n.spell-section .artistry-container-6 .artistry-icon:nth-child(odd) {\n  position: relative;\n  top: -25px;\n}\n.spell-section .artistry-container-3 .artistry-icon:nth-child(even),\n.spell-section .artistry-container-4 .artistry-icon:nth-child(even),\n.spell-section .artistry-container-5 .artistry-icon:nth-child(even),\n.spell-section .artistry-container-6 .artistry-icon:nth-child(even) {\n  position: relative;\n  bottom: -25px;\n}\n\n.artistry-icon {\n  position: relative;\n  width: 100px;\n  height: 100px;\n  background-size: contain;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n\n.artistry-enchantment {\n  background-image: var(--artistry-enchantment);\n}\n.artistry-alteration {\n  background-image: var(--artistry-alteration);\n}\n.artistry-array {\n  background-image: var(--artistry-array);\n}\n.artistry-divination {\n  background-image: var(--artistry-divination);\n}\n.artistry-evocation {\n  background-image: var(--artistry-evocation);\n}\n.artistry-illusion {\n  background-image: var(--artistry-illusion);\n}\n.artistry-necromancy {\n  background-image: var(--artistry-necromancy);\n}\n.artistry-wake {\n  background-image: var(--artistry-wake);\n}\n\n\n.toc-entry {\n  font-family: \"Bahnschrift\";\n  display: flex;\n  gap: 20px;\n  justify-content: space-between;\n  font-size: 22px;\n}\n\n.toc-title {\n  font-weight: bold;\n}\n\n.toc-page {\n  color: gray;\n}\n\n.specialist-table {\n  position: absolute;\n  inset: 0;\n  background-image: var(--specialist-table);\n}\n\n.specialist-header {\n  position: absolute;\n  top: 93px;\n  left: 105px;\n  padding-right: 119px;\n  word-wrap: break-word;\n  word-break: break-all;\n  hyphens: auto;\n  -webkit-hyphens: auto;\n  -moz-hyphens: auto;\n  -ms-hyphens: auto;\n  font-family: \"Bahnschrift\";\n}\n\n.specialist-content {\n  inset: 251px 88px 163px 105px;\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\n.specialist-row.header {\n  position: absolute;\n  top: 211px;\n  left: 105px;\n  font-family: \"Bahnschrift\";\n  display: grid;\n  grid-template-columns: 281px 285px 1fr;\n  gap: 0;\n}\n\n.specialist-row.header .specialist-cell.cell-1,\n.specialist-row.header .specialist-cell.cell-2,\n.specialist-row.header .specialist-cell.cell-3 {\n  font-size: 25px;\n  font-weight: bold;\n}\n\n.specialist-row {\n  flex: 1;\n  align-items: center;\n  display: grid;\n  grid-template-columns: 292px 282px 1fr;\n}\n\n.specialist-cell {\n  font-size: 19.5px;\n}\n\n.specialist-cell.cell-1 {\n  font-weight: bold;\n}\n\n.specialist-cell.cell-2 {\n  letter-spacing: 0.2px;\n  font-size: 20.5px;\n  padding-right: 38px;\n}\n\n.specialist-cell.cell-3 {\n  padding-bottom: 8px;\n  font-size: 20.8px;\n  padding-right: 25px;\n}\n\n.specialist-table .specialist-title {\n  font-family: \"Bahnschrift\";\n  font-size: 25px;\n  font-weight: bold;  \n  margin: 0;\n  padding: 0;\n  color: black;\n}\n\n.specialist-table .specialist-desc {\n  color: black;\n  font-family: \"Bahnschrift\";\n  font-size: 20.5px;\n  margin: 0 0 30px;\n  text-align: left;\n  line-height: 1.2;\n  word-break: break-word;\n  word-wrap: break-word;\n  hyphens: auto;\n  -webkit-hyphens: auto;\n  -moz-hyphens: auto;\n  -ms-hyphens: auto;\n}\n</style>","/**\n * Parse lightweight markup into structured DOM nodes.\n *\n * Supported commands (case-insensitive):\n *  /page <type> <number|label>\n *  /column   (alias: /col)\n *  /spacing <px> (alias: /sp <px>)\n *  /equipment <rarity> <name>\n *      followed by /type /cost /tag /damage /desc /flavor /craft lines\n *      /next to start a new equipment section, /end to close equipment block\n *  /note <text> (aliases: /info, /lore) ... /end\n *  /toc begin  ... /toc end\n *      Inside TOC block: lines shaped as \"Title | 001\" become entries.\n *  /page-num <number>\n *  /style begin ... /style end  -> injects a <style> block (sanitized)\n *  /img <src> [alt and attributes]\n *  /columns <n>  -> set number of columns for current page\n *  /page-break\n *\n * Headings:  #, ##, ### etc. Append {.class #id style=\"...\" span-2} to add attributes.\n * Inline formatting: **bold**, *italic*, [link](url).\n * All user content is HTML-escaped prior to inline formatting replacement.\n */\nexport function parse(input, columnCount = 1) {\n  columnCount = Math.max(1, parseInt(columnCount, 10) || 1);\n  const lines = (input || '').split('\\n');\n\n  // ---------- Utility helpers ----------\n  const escapeHTML = (str) => String(str || '')\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n\n  const applyInlineFormatting = (text) => {\n    // Work on escaped text so user HTML cannot break out.\n    let safe = escapeHTML(text);\n    // Bold first to avoid double-processing inside italic.\n    safe = safe.replace(/\\*\\*(.+?)\\*\\*/g, '<strong>$1</strong>');\n    safe = safe.replace(/\\*(.+?)\\*/g, '<em>$1</em>');\n    safe = safe.replace(/\\\\n/g, '<br/>');\n    // Links: [text](url)\n    safe = safe.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, (m, t, u) => {\n      return `<a href=\"${escapeHTML(u)}\">${t}</a>`;\n    });\n    return safe;\n  };\n\n  const createEl = (tag, className, text) => {\n    const el = document.createElement(tag);\n    if (className) el.className = className;\n    if (text !== undefined) el.textContent = text;\n    return el;\n  };\n\n  const makeColumn = () => createEl('div', 'column');\n  const makePage = (pageType) => {\n    const type = pageType || 'default';\n    const page = createEl('div', 'page page-' + type);\n    page.style.setProperty('background', `var(--${type}-background)`);\n    page.appendChild(createEl('div', 'page-content'));\n    return page;\n  };\n\n  // ---------- Regex (precompiled) ----------\n  const RE = {\n    comment: /^\\/\\/\\s+(.*)$/i,\n    page: /^\\/page\\s+(equipment|gameplay|info|lore|species|talent|toc|advanced)\\s+(.+)$/i,\n    pageNum: /^\\/page-num\\s+(\\d+)$/i,\n    column: /^\\/(column|col)$/i,\n    spacing: /^\\/(spacing|sp)\\s+(\\d+)$/i,\n    equipment: /^\\/equipment\\s+(crude|common|uncommon|rare|legendary|mythic)\\s+(.*)$/i,\n    equipmentDetail: /^\\/(type|cost|tag|damage|desc|flavor|craft)\\s+(.*)$/i,\n    equipmentNext: /^\\/next$/i,\n    spell: /^\\/spell\\s+(.*)$/i,\n    spellDetail: /^\\/(type|arts|tag|sta|stamina|desc)\\s+(.*)$/i,\n    spellNext: /^\\/next$/i,\n    specialist: /^\\/specialist$/i,\n    noteStart: /^\\/(note|info|lore)\\s+(.*)$/i,\n    blockEnd: /^\\/end$/i,\n    toc: /^\\/toc\\s+(begin|end)$/i,\n    heading: /^(#+)\\s+(.*)$/, \n    // style blocks\n    styleBegin: /^\\/style\\s+begin$/i,\n    styleEnd: /^\\/style\\s+end$/i,\n    img: /^\\/img\\s+(\\S+)(?:\\s+(.*))?$/i,\n    codeFenceBegin: /^```\\s*(\\w+)?\\s*$/,\n    hr: /^-{3,}\\s*$/,\n    pageBreak: /^\\/page-break$/i,\n    columns: /^\\/columns\\s+(\\d+)$/i\n  };\n\n  // ---------- State ----------\n  const parent = createEl('div', 'content-parent');\n  // lazy pages: don't create a page until a explicit /page command is seen\n  const pages = [];\n  let activePageIndex = -1;\n  let activePage = null;\n  const pageColumns = [];\n  let activeColumnIndex = -1;\n\n  let noteDiv = null; // current note box\n  let equipmentDiv = null; // current equipment wrapper\n  let equipmentSectionContainer = null; // current equipment inner section\n  let equipmentSectionCount = 0;\n  let spellDiv = null;\n  let spellArtistries = [];\n  let spellSectionContainer = null;\n  let spellSectionCount = 0;\n  let tocDiv = null; // TOC container\n  let styleCollect = null; // array of style lines when inside style block\n  let specialistDiv = null; // current specialist table\n  const pageColumnLimits = [];\n\n  const getActiveColumn = () => pageColumns[activePageIndex][activeColumnIndex];\n\n  const ensureColumn = () => {\n    if (activePageIndex < 0) return; // no active page\n    if (!pageColumns[activePageIndex] || pageColumns[activePageIndex].length === 0) {\n      pageColumns[activePageIndex] = [makeColumn()];\n      activePage.querySelector('.page-content').appendChild(pageColumns[activePageIndex][0]);\n      activeColumnIndex = 0;\n    }\n  };\n\n  const startNewPage = (type, pageLabel) => {\n    const page = makePage(type);\n    pages.push(page);\n    parent.appendChild(page);\n    activePageIndex = pages.length - 1;\n    activePage = page;\n    pageColumns[activePageIndex] = [];\n    const firstCol = makeColumn();\n    page.querySelector('.page-content').appendChild(firstCol);\n    pageColumns[activePageIndex].push(firstCol);\n    activeColumnIndex = 0;\n    if (pageLabel) {\n      const pageDiv = createEl('div', 'page-number');\n      if (/^\\d+$/.test(pageLabel)) {\n        pageDiv.textContent = pageLabel.toString().padStart(3, '0');\n      } else {\n        pageDiv.textContent = pageLabel;\n      }\n      activePage.appendChild(pageDiv);\n    }\n  };\n\n  const startEquipment = (rarity, name) => {\n    const equipment = createEl('div', 'equipment rarity-' + rarity.toLowerCase());\n    const contentWrap = createEl('div', 'equipment-content');\n    const title = createEl('div', 'equipment-title', name);\n    contentWrap.appendChild(title);\n    equipment.appendChild(contentWrap);\n    getActiveColumn().appendChild(equipment);\n    equipmentDiv = equipment;\n    equipmentSectionContainer = contentWrap;\n    equipmentSectionCount = 0;\n  };\n\n  const startSpell = (name) => {\n    const spell = createEl('div', 'spell');\n    const contentWrap = createEl('div', 'spell-content');\n    const title = createEl('div', 'spell-title', name);\n    contentWrap.appendChild(title);\n    spell.appendChild(contentWrap);\n    getActiveColumn().appendChild(spell);\n    spellDiv = spell;\n    spellSectionContainer = contentWrap;\n    spellSectionCount = 0;\n  };\n\n  const addEquipmentDetail = (kind, rawContent) => {\n    if (!equipmentDiv) return;\n    // Don't create a new section until the first 'next' is called\n    // if (!equipmentSectionContainer || equipmentSectionCount === 0) {\n    //   equipmentSectionCount = 1;\n    //   const section = createEl('div', 'equipment-section section-1');\n    //   equipmentDiv.appendChild(section);\n    //   equipmentSectionContainer = section;\n    // }\n    const detail = createEl('div', 'equipment-detail ' + kind.toLowerCase());\n    if (kind.toLowerCase() === 'tag') {\n      const [left, ...rest] = rawContent.split(':');\n      const right = rest.join(':').trim();\n      const first = createEl('span', 'equipment-tag-type', left.trim() + ': ');\n      const second = createEl('span', 'equipment-tag-content', right);\n      detail.appendChild(first);\n      detail.appendChild(second);\n    } else {\n      detail.textContent = rawContent;\n    }\n    equipmentSectionContainer.appendChild(detail);\n  };\n\n  const addSpellDetail = (kind, rawContent) => {\n    if (!spellDiv) return;\n    // Don't create a new section until the first 'next' is called\n    // if (!spellSectionContainer || spellSectionCount === 0) {\n    //   spellSectionCount = 1;\n    //   const section = createEl('div', 'spell-section section-1');\n    //   spellDiv.appendChild(section);\n    //   spellSectionContainer = section;\n    // }\n    const detail = createEl('div', 'spell-detail ' + kind.toLowerCase());\n    if (kind.toLowerCase() === 'tag') {\n      const [left, ...rest] = rawContent.split(':');\n      const right = rest.join(':').trim();\n      const first = createEl('span', 'equipment-tag-type', left.trim() + ': ');\n      const second = createEl('span', 'equipment-tag-content', right);\n      detail.appendChild(first);\n      detail.appendChild(second);\n    } else if (kind.toLowerCase() === \"arts\") {\n      const arts = rawContent.split(',');\n      arts.forEach(a => spellArtistries.push(a.trim().toLowerCase()));\n      detail.textContent = rawContent;\n    } else {\n      detail.textContent = rawContent;\n    }\n    spellSectionContainer.appendChild(detail);\n  };\n\n  const nextEquipmentSection = () => {\n    if (!equipmentDiv) return;\n    equipmentSectionCount += 1;\n    const section = createEl('div', 'equipment-section section-' + equipmentSectionCount);\n    equipmentDiv.appendChild(section);\n    equipmentSectionContainer = section;\n  };\n\n  const nextSpellSection = () => {\n    if (!spellDiv) return;\n    spellSectionCount += 1;\n    const section = createEl('div', 'spell-section section-' + spellSectionCount);\n    spellDiv.appendChild(section);\n    spellSectionContainer = section;\n  }\n\n  const endEquipment = () => {\n    equipmentDiv = null;\n    equipmentSectionContainer = null;\n    equipmentSectionCount = 0;\n  };\n\n  const endSpell = () => {\n    const section = spellDiv.querySelector('.section-2');\n    const artistryCount = spellArtistries.length;\n    const container = createEl('div', 'artistry-container artistry-container-' + artistryCount, '');\n    section.appendChild(container);\n    for (const artistry of spellArtistries) {\n      const artistryIcon = createEl('img', `artistry-icon artistry-${artistry}`, '')\n      artistryIcon.setAttribute('width', '130');\n      artistryIcon.setAttribute('height', '130');\n      container.appendChild(artistryIcon);\n    } \n\n    spellDiv = null;\n    spellSectionContainer = null;\n    spellSectionCount = 0;\n  };\n\n  const startNote = (type, firstLine) => {\n    const wrapper = createEl('div', 'note ' + type.toLowerCase());\n    const makeImg = (cls, file) => {\n      const img = document.createElement('img');\n      img.className = 'box ' + cls;\n      img.src = '../assets/blocks/' + file;\n      return img;\n    };\n    wrapper.appendChild(makeImg('box-top-left', 'box-top-left.svg'));\n    wrapper.appendChild(makeImg('box-top-right', 'box-top-right.svg'));\n    wrapper.appendChild(makeImg('box-bottom-left', 'box-bottom-left.svg'));\n    wrapper.appendChild(makeImg('box-bottom-right', 'box-bottom-right.svg'));\n    const gradient = createEl('div', 'box box-gradient ' + type.toLowerCase());\n    wrapper.appendChild(gradient);\n    const p = createEl('p', 'note-content');\n    p.innerHTML = applyInlineFormatting(firstLine);\n    wrapper.appendChild(p);\n    getActiveColumn().appendChild(wrapper);\n    noteDiv = wrapper;\n  };\n\n  const appendNoteLine = (line) => {\n    if (!noteDiv) return;\n    const p = createEl('p', 'note-content');\n    p.innerHTML = applyInlineFormatting(line);\n    noteDiv.appendChild(p);\n  };\n\n  const endNote = () => { noteDiv = null; };\n\n  const startTOC = () => {\n    tocDiv = createEl('div', 'toc');\n    getActiveColumn().appendChild(tocDiv);\n  };\n  const endTOC = () => { tocDiv = null; };\n  const addTOCEntry = (title, page) => {\n    if (!tocDiv) return;\n    const entry = createEl('div', 'toc-entry');\n    const t = createEl('span', 'toc-title');\n    t.textContent = title;\n    const p = createEl('span', 'toc-page');\n    p.textContent = page;\n    entry.appendChild(t);\n    entry.appendChild(p);\n    tocDiv.appendChild(entry);\n  };\n\n  const addHeading = (level, text, span, attrs) => {\n    level = Math.min(6, level || 1);\n    const h = createEl('h' + level);\n    h.textContent = text;\n    if (attrs) {\n      if (attrs.id) h.id = attrs.id;\n      attrs.classes.forEach(c => h.classList.add(c));\n      if (attrs.style) h.setAttribute('style', attrs.style);\n    }\n    if (span && span > 1) {\n      h.classList.add('span-' + span);\n      if (attrs && !attrs.classes.includes('span-' + span)) {\n        h.classList.add('span-' + span);\n      }\n      activePage.appendChild(h);\n      activePage.classList.add('has-span-' + span);\n    } else {\n      getActiveColumn().appendChild(h);\n    }\n  };\n\n  const addParagraph = (line, attrs) => {\n    const p = createEl('p');\n    p.innerHTML = applyInlineFormatting(line);\n    if (attrs) {\n      if (attrs.id) p.id = attrs.id;\n      attrs.classes.forEach(c => p.classList.add(c));\n      if (attrs.style) p.setAttribute('style', attrs.style);\n    }\n    getActiveColumn().appendChild(p);\n  };\n\n  const addSpacing = (px) => {\n    const spacer = createEl('div', 'spacing');\n    spacer.style.height = px + 'px';\n    getActiveColumn().appendChild(spacer);\n  };\n\n  const addPageNumber = (num) => {\n    const pageDiv = createEl('div', 'page-number');\n    pageDiv.textContent = num.toString().padStart(3, '0');\n    activePage.appendChild(pageDiv);\n  };\n\n  const advanceColumn = () => {\n    const cols = pageColumns[activePageIndex];\n    const limit = pageColumnLimits[activePageIndex] || columnCount;\n    if (cols.length < limit) {\n      const newCol = makeColumn();\n      cols.push(newCol);\n      activePage.querySelector('.page-content').appendChild(newCol);\n      activeColumnIndex = cols.length - 1;\n    } else {\n      activeColumnIndex = (activeColumnIndex + 1) % limit;\n    }\n  };\n\n  // Attribute block parser: supports {.class1 .class2 #id style=\"color:red;\" span-2}\n  const parseAttributeBlock = (body) => {\n    const attrMatch = body.match(/\\s\\{([^}]*)}\\s*$/);\n    if (!attrMatch) return { text: body, classes: [], id: null, style: null, span: null };\n    const attrContent = attrMatch[1].trim();\n    const remaining = body.slice(0, attrMatch.index).trim();\n    // Tokenize by spaces not inside quotes (simple split suffices for limited syntax)\n    const rawTokens = attrContent.match(/(?:\"[^\"]*\"|'[^']*'|[^\\s]+)/g) || [];\n    const classes = [];\n    let id = null;\n    let style = null;\n    let span = null;\n    rawTokens.forEach(t => {\n      if (t.startsWith('.')) {\n        classes.push(t.slice(1));\n      } else if (t.startsWith('#')) {\n        id = t.slice(1);\n      } else if (t.toLowerCase().startsWith('style=')) {\n        const val = t.substring(6).replace(/^['\"]|['\"]$/g, '');\n        style = val;\n      } else if (/^span-(\\d+)$/i.test(t)) {\n        const m = t.match(/span-(\\d+)/i);\n        span = parseInt(m[1], 10) || null;\n      } else {\n        // treat unknown token as class to be flexible\n        classes.push(t);\n      }\n    });\n    return { text: remaining, classes, id, style, span };\n  };\n\n  const addSpecialistTable = () => {\n    const div = createEl('div', 'specialist-table');\n    activePage.appendChild(div);\n    const headerWrap = createEl('div', 'specialist-header');\n    div.appendChild(headerWrap);\n    const contentWrap = createEl('div', 'specialist-content');\n    div.appendChild(contentWrap);\n    const headerRow = createEl('div', 'specialist-row header');\n    ['Talent Name', 'Prerequisites', 'Abilities'].forEach((text, idx) => {\n      const cell = createEl('div', 'specialist-cell cell-' + (idx + 1), text);\n      headerRow.appendChild(cell);\n    });\n    div.appendChild(headerRow);\n    specialistDiv = div;\n  };\n\n  // ---------- Main loop ----------\n  for (let i = 0; i < lines.length; i++) {\n    const raw = lines[i];\n    let line = raw.trim();\n    if (!line) continue;\n\n    // If no page has been created yet, ignore all non-page lines to avoid\n    // inserting a blank initial page. Allow style blocks and comments.\n    if (activePageIndex < 0 && !RE.page.test(line) && !RE.styleBegin.test(line) && !RE.styleEnd.test(line) && !RE.comment.test(line)) {\n      continue;\n    }\n\n    // Style block collection mode\n    if (styleCollect && !(RE.styleEnd.test(line) || RE.blockEnd.test(line))) {\n      styleCollect.push(line);\n      continue;\n    }\n    if (styleCollect && (RE.styleEnd.test(line) || RE.blockEnd.test(line))) {\n      // finalize style element\n      const styleEl = document.createElement('style');\n      // Basic sanitization: remove < and >\n      const css = styleCollect.join('\\n').replace(/[<>]/g, '');\n      styleEl.textContent = css;\n      parent.appendChild(styleEl);\n      styleCollect = null;\n      continue;\n    }\n\n    // Skip comments\n    if (RE.comment.test(line)) continue;\n\n    // Handle modes first\n    if (noteDiv && !RE.blockEnd.test(line)) {\n      appendNoteLine(line);\n      continue;\n    }\n\n    if (equipmentDiv && !RE.blockEnd.test(line)) {\n      if (RE.equipmentNext.test(line)) { nextEquipmentSection(); continue; }\n      const mDet = line.match(RE.equipmentDetail);\n      if (mDet) { addEquipmentDetail(mDet[1], mDet[2]); continue; }\n    }\n\n    if (spellDiv && !RE.blockEnd.test(line)) {\n      if (RE.spellNext.test(line)) { nextSpellSection(); continue; }\n      const mDet = line.match(RE.spellDetail);\n      if (mDet) { addSpellDetail(mDet[1], mDet[2]); continue; }\n    }\n\n    if (tocDiv && !RE.toc.test(line)) {\n      // Expect pattern: Title | 001   (page part optional)\n      const parts = line.split('|');\n      if (parts.length >= 1) {\n        const title = parts[0].trim();\n        const page = (parts[1] || '').trim();\n        addTOCEntry(title, page);\n      }\n      continue;\n    }\n\n    if (specialistDiv) {\n      if (RE.blockEnd.test(line)) {\n        specialistDiv = null;\n        continue;\n      } else {\n        const title = /^\\/title\\s*(.*)$/i.exec(line);\n        if (title) {\n          const h2 = createEl('h2', 'specialist-title', title[1]);\n          specialistDiv.querySelector('.specialist-header').appendChild(h2);\n          continue;\n        }\n\n        const desc = /^\\/desc\\s*(.*)$/i.exec(line);\n        if (desc) {\n          const p = createEl('p', 'specialist-desc');\n          p.innerHTML = applyInlineFormatting(desc[1]);\n          specialistDiv.querySelector('.specialist-header').appendChild(p);\n          continue;\n        }\n\n        const splits = line.split('|').map(s => s.trim());\n        if (splits.length === 3) {\n          const row = createEl('div', 'specialist-row');\n          splits.forEach((text, idx) => {\n            const cell = createEl('div', 'specialist-cell cell-' + (idx + 1));\n            cell.innerHTML = applyInlineFormatting(text);\n            row.appendChild(cell);\n          });\n          specialistDiv.querySelector('.specialist-content').appendChild(row);\n          continue;\n        }\n      }\n    }\n\n    // Generic command matching\n    let m;\n    if ((m = line.match(RE.page))) { startNewPage(m[1].toLowerCase(), m[2]); continue; }\n    if (RE.styleBegin.test(line)) { styleCollect = []; continue; }\n    if (RE.styleEnd.test(line)) { /* stray end without begin ignored */ continue; }\n    if ((m = line.match(RE.pageNum))) { addPageNumber(m[1]); continue; }\n    if ((m = line.match(RE.column))) { advanceColumn(); continue; }\n    if ((m = line.match(RE.columns))) { pageColumnLimits[activePageIndex] = parseInt(m[1], 10) || columnCount; continue; }\n    if ((m = line.match(RE.spacing))) { addSpacing(m[2]); continue; }\n    if ((m = line.match(RE.equipment))) { startEquipment(m[1], m[2]); continue; }\n    if ((m = line.match(RE.spell))) { startSpell(m[1]); continue; }\n    if ((m = line.match(RE.specialist))) { addSpecialistTable(); continue; }\n    if ((m = line.match(RE.noteStart))) { startNote(m[1], m[2]); continue; }\n    if ((m = line.match(RE.img))) {\n      const src = m[1];\n      const rest = (m[2] || '').trim();\n      const attrs = parseAttributeBlock(rest);\n      const img = document.createElement('img');\n      img.src = src;\n      img.alt = attrs.text || '';\n      if (attrs.id) img.id = attrs.id;\n      attrs.classes.forEach(c => img.classList.add(c));\n      if (attrs.style) img.setAttribute('style', attrs.style);\n      getActiveColumn().appendChild(img);\n      continue;\n    }\n    if (RE.blockEnd.test(line)) { endNote(); endEquipment(); endSpell(); endTOC(); continue; }\n    if ((m = line.match(RE.toc))) { if (m[1].toLowerCase() === 'begin') startTOC(); else endTOC(); continue; }\n    if (RE.hr.test(line) || /^\\/hr$/i.test(line)) { getActiveColumn().appendChild(document.createElement('hr')); continue; }\n    if (RE.pageBreak.test(line)) { const pb = createEl('div', 'page-break'); getActiveColumn().appendChild(pb); continue; }\n\n    // Headings\n    if ((m = line.match(RE.heading))) {\n      const level = m[1].length;\n      let body = m[2].trim();\n      const attrs = parseAttributeBlock(body);\n      body = attrs.text;\n      addHeading(level, body, attrs.span, attrs);\n      continue;\n    }\n\n    // Unordered lists\n    const mList = line.match(/^[-*]\\s+(.*)$/);\n    if (mList) {\n      const ul = createEl('ul');\n      while (i < lines.length) {\n        const liLine = lines[i].trim();\n        const mItem = liLine.match(/^[-*]\\s+(.*)$/);\n        if (!mItem) break;\n        const li = createEl('li');\n        li.innerHTML = applyInlineFormatting(mItem[1]);\n        ul.appendChild(li);\n        i++;\n      }\n      i--;\n      ensureColumn();\n      getActiveColumn().appendChild(ul);\n      continue;\n    }\n\n    // Ordered lists\n    const mOrdered = line.match(/^(\\d+)\\.\\s+(.*)$/);\n    if (mOrdered) {\n      const ol = createEl('ol');\n      while (i < lines.length) {\n        const liLine = lines[i].trim();\n        const mItem = liLine.match(/^(\\d+)\\.\\s+(.*)$/);\n        if (!mItem) break;\n        const li = createEl('li');\n        li.innerHTML = applyInlineFormatting(mItem[2]);\n        ol.appendChild(li);\n        i++;\n      }\n      i--;\n      ensureColumn();\n      getActiveColumn().appendChild(ol);\n      continue;\n    }\n\n    // Code fence blocks ```lang\n    let mf;\n    if ((mf = line.match(RE.codeFenceBegin))) {\n      const lang = mf[1] || '';\n      const buffer = [];\n      i++;\n      while (i < lines.length && !/^```\\s*$/.test(lines[i])) {\n        buffer.push(lines[i]);\n        i++;\n      }\n      const pre = createEl('pre');\n      const code = createEl('code');\n      if (lang) code.className = 'language-' + lang;\n      code.textContent = buffer.join('\\n');\n      pre.appendChild(code);\n      ensureColumn();\n      getActiveColumn().appendChild(pre);\n      continue;\n    }\n\n    // Fallback paragraph\n    ensureColumn();\n    // Attribute parsing for paragraphs\n    const pAttrs = parseAttributeBlock(line);\n    addParagraph(pAttrs.text, pAttrs);\n  }\n\n  console.log(`Parsed ${pages.length} pages.`);\n  console.log(parent);\n\n  return parent;\n}","import { render } from \"./Editor.vue?vue&type=template&id=994c176e\"\nimport script from \"./Editor.vue?vue&type=script&lang=js\"\nexport * from \"./Editor.vue?vue&type=script&lang=js\"\n\nimport \"./Editor.vue?vue&type=style&index=0&id=994c176e&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=5eb96928\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=5eb96928&lang=css\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { createApp } from 'vue'\nimport App from './App.vue'\nimport './assets/fonts/rpg-awesome.min.css';\n\ncreateApp(App).mount('#app')\n","var map = {\n\t\"./simpleWorker\": 5585,\n\t\"./simpleWorker.js\": 5585,\n\t\"monaco-editor/esm/vs/base/common/worker/simpleWorker\": 5585,\n\t\"monaco-editor/esm/vs/base/common/worker/simpleWorker.js\": 5585\n};\n\nfunction webpackAsyncContext(req) {\n\treturn Promise.resolve().then(function() {\n\t\tif(!__webpack_require__.o(map, req)) {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t}\n\n\t\tvar id = map[req];\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function() { return Object.keys(map); };\nwebpackAsyncContext.id = 5890;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./editorBaseApi\": [\n\t\t3059\n\t],\n\t\"./editorBaseApi.js\": [\n\t\t3059\n\t],\n\t\"./editorSimpleWorker\": [\n\t\t4003\n\t],\n\t\"./editorSimpleWorker.js\": [\n\t\t4003\n\t],\n\t\"./editorWorker\": [\n\t\t304\n\t],\n\t\"./editorWorker.js\": [\n\t\t304\n\t],\n\t\"./editorWorkerHost\": [\n\t\t6358\n\t],\n\t\"./editorWorkerHost.js\": [\n\t\t6358\n\t],\n\t\"./findSectionHeaders\": [\n\t\t9307\n\t],\n\t\"./findSectionHeaders.js\": [\n\t\t9307\n\t],\n\t\"./getIconClasses\": [\n\t\t5767\n\t],\n\t\"./getIconClasses.js\": [\n\t\t5767\n\t],\n\t\"./languageFeatureDebounce\": [\n\t\t2060\n\t],\n\t\"./languageFeatureDebounce.js\": [\n\t\t2060\n\t],\n\t\"./languageFeatures\": [\n\t\t2230\n\t],\n\t\"./languageFeatures.js\": [\n\t\t2230\n\t],\n\t\"./languageFeaturesService\": [\n\t\t6127\n\t],\n\t\"./languageFeaturesService.js\": [\n\t\t6127\n\t],\n\t\"./languageService\": [\n\t\t3930\n\t],\n\t\"./languageService.js\": [\n\t\t3930\n\t],\n\t\"./languagesAssociations\": [\n\t\t5996\n\t],\n\t\"./languagesAssociations.js\": [\n\t\t5996\n\t],\n\t\"./languagesRegistry\": [\n\t\t6995\n\t],\n\t\"./languagesRegistry.js\": [\n\t\t6995\n\t],\n\t\"./markerDecorations\": [\n\t\t886\n\t],\n\t\"./markerDecorations.js\": [\n\t\t886\n\t],\n\t\"./markerDecorationsService\": [\n\t\t11\n\t],\n\t\"./markerDecorationsService.js\": [\n\t\t11\n\t],\n\t\"./model\": [\n\t\t4830\n\t],\n\t\"./model.js\": [\n\t\t4830\n\t],\n\t\"./modelService\": [\n\t\t931\n\t],\n\t\"./modelService.js\": [\n\t\t931\n\t],\n\t\"./resolverService\": [\n\t\t7042\n\t],\n\t\"./resolverService.js\": [\n\t\t7042\n\t],\n\t\"./semanticTokensDto\": [\n\t\t9376\n\t],\n\t\"./semanticTokensDto.js\": [\n\t\t9376\n\t],\n\t\"./semanticTokensProviderStyling\": [\n\t\t7642\n\t],\n\t\"./semanticTokensProviderStyling.js\": [\n\t\t7642\n\t],\n\t\"./semanticTokensStyling\": [\n\t\t2891\n\t],\n\t\"./semanticTokensStyling.js\": [\n\t\t2891\n\t],\n\t\"./semanticTokensStylingService\": [\n\t\t8148\n\t],\n\t\"./semanticTokensStylingService.js\": [\n\t\t8148\n\t],\n\t\"./textModelSync/textModelSync.impl\": [\n\t\t1171\n\t],\n\t\"./textModelSync/textModelSync.impl.js\": [\n\t\t1171\n\t],\n\t\"./textModelSync/textModelSync.protocol\": [\n\t\t5628,\n\t\t5628\n\t],\n\t\"./textModelSync/textModelSync.protocol.js\": [\n\t\t5628,\n\t\t5628\n\t],\n\t\"./textResourceConfiguration\": [\n\t\t1504\n\t],\n\t\"./textResourceConfiguration.js\": [\n\t\t1504\n\t],\n\t\"./treeSitterParserService\": [\n\t\t5320\n\t],\n\t\"./treeSitterParserService.js\": [\n\t\t5320\n\t],\n\t\"./treeViewsDnd\": [\n\t\t2603\n\t],\n\t\"./treeViewsDnd.js\": [\n\t\t2603\n\t],\n\t\"./treeViewsDndService\": [\n\t\t6756\n\t],\n\t\"./treeViewsDndService.js\": [\n\t\t6756\n\t],\n\t\"./unicodeTextModelHighlighter\": [\n\t\t9887\n\t],\n\t\"./unicodeTextModelHighlighter.js\": [\n\t\t9887\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorBaseApi\": [\n\t\t3059\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorBaseApi.js\": [\n\t\t3059\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorSimpleWorker\": [\n\t\t4003\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorSimpleWorker.js\": [\n\t\t4003\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorWorker\": [\n\t\t304\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorWorker.js\": [\n\t\t304\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorWorkerHost\": [\n\t\t6358\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/editorWorkerHost.js\": [\n\t\t6358\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/findSectionHeaders\": [\n\t\t9307\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/findSectionHeaders.js\": [\n\t\t9307\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/getIconClasses\": [\n\t\t5767\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/getIconClasses.js\": [\n\t\t5767\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageFeatureDebounce\": [\n\t\t2060\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageFeatureDebounce.js\": [\n\t\t2060\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageFeatures\": [\n\t\t2230\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageFeatures.js\": [\n\t\t2230\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageFeaturesService\": [\n\t\t6127\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageFeaturesService.js\": [\n\t\t6127\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageService\": [\n\t\t3930\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languageService.js\": [\n\t\t3930\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languagesAssociations\": [\n\t\t5996\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languagesAssociations.js\": [\n\t\t5996\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languagesRegistry\": [\n\t\t6995\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/languagesRegistry.js\": [\n\t\t6995\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/markerDecorations\": [\n\t\t886\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/markerDecorations.js\": [\n\t\t886\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/markerDecorationsService\": [\n\t\t11\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/markerDecorationsService.js\": [\n\t\t11\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/model\": [\n\t\t4830\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/model.js\": [\n\t\t4830\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/modelService\": [\n\t\t931\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/modelService.js\": [\n\t\t931\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/resolverService\": [\n\t\t7042\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/resolverService.js\": [\n\t\t7042\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensDto\": [\n\t\t9376\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensDto.js\": [\n\t\t9376\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensProviderStyling\": [\n\t\t7642\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensProviderStyling.js\": [\n\t\t7642\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensStyling\": [\n\t\t2891\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensStyling.js\": [\n\t\t2891\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensStylingService\": [\n\t\t8148\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/semanticTokensStylingService.js\": [\n\t\t8148\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.impl\": [\n\t\t1171\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.impl.js\": [\n\t\t1171\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.protocol\": [\n\t\t5628,\n\t\t5628\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.protocol.js\": [\n\t\t5628,\n\t\t5628\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/textResourceConfiguration\": [\n\t\t1504\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/textResourceConfiguration.js\": [\n\t\t1504\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/treeSitterParserService\": [\n\t\t5320\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/treeSitterParserService.js\": [\n\t\t5320\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/treeViewsDnd\": [\n\t\t2603\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/treeViewsDnd.js\": [\n\t\t2603\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/treeViewsDndService\": [\n\t\t6756\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/treeViewsDndService.js\": [\n\t\t6756\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/unicodeTextModelHighlighter\": [\n\t\t9887\n\t],\n\t\"monaco-editor/esm/vs/editor/common/services/unicodeTextModelHighlighter.js\": [\n\t\t9887\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function() { return Object.keys(map); };\nwebpackAsyncContext.id = 9204;\nmodule.exports = webpackAsyncContext;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdO = {};","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"js/\" + chunkId + \".\" + {\"198\":\"019281a0\",\"205\":\"be988e82\",\"398\":\"69575a9b\",\"494\":\"b89d81c7\",\"558\":\"3d98b531\",\"910\":\"07627dc0\",\"946\":\"8bd6966d\",\"968\":\"93dcd98b\",\"970\":\"5966d6de\",\"1118\":\"15282e03\",\"1122\":\"cfb3ef65\",\"1282\":\"fe485f76\",\"1420\":\"b6d319fd\",\"1438\":\"cd56bc64\",\"1446\":\"723579ce\",\"1560\":\"e1c2012f\",\"1710\":\"365111e7\",\"1740\":\"60cd1a85\",\"1888\":\"347a0ce3\",\"1914\":\"f5ef0dc3\",\"2077\":\"91fa0ff8\",\"2094\":\"ca683993\",\"2244\":\"b0b04def\",\"2278\":\"31aec673\",\"2398\":\"6d75374a\",\"2586\":\"d68a1ef4\",\"2658\":\"b7a6e5e0\",\"2686\":\"7c641f9a\",\"2692\":\"3063380d\",\"2745\":\"1588fb81\",\"2962\":\"15c4ae8f\",\"3042\":\"6c75c68a\",\"3062\":\"8610b604\",\"3096\":\"c1b9df44\",\"3182\":\"3c94dc32\",\"3622\":\"9bef8934\",\"3726\":\"cf3bdbf6\",\"4114\":\"53ba94e6\",\"4120\":\"64ebe536\",\"4334\":\"c35675f2\",\"4630\":\"c752b031\",\"4680\":\"3ac34c98\",\"4698\":\"8057b0c7\",\"4839\":\"a1498f0d\",\"4958\":\"8730b31c\",\"4962\":\"34107969\",\"5130\":\"b32ce11f\",\"5196\":\"986b08da\",\"5364\":\"83c7c473\",\"5550\":\"e043983b\",\"5618\":\"579221bd\",\"5628\":\"652b5ba0\",\"5786\":\"9d2fb584\",\"5966\":\"93daa54c\",\"6018\":\"4bfaea07\",\"6134\":\"31ac4595\",\"6185\":\"50d53859\",\"6302\":\"eefcb942\",\"6414\":\"5215c642\",\"6446\":\"e2507bc6\",\"6590\":\"39cf1ba2\",\"6830\":\"d1e27f9f\",\"6940\":\"e244bf19\",\"6990\":\"e8352b4c\",\"7048\":\"aeff6a27\",\"7200\":\"d6e8fb13\",\"7246\":\"a7457529\",\"7466\":\"f5692250\",\"7614\":\"bbe567f9\",\"7836\":\"30f7ef17\",\"7886\":\"4f4416aa\",\"8230\":\"e36f02c9\",\"8332\":\"2977d15b\",\"8334\":\"7cfa7470\",\"8390\":\"20350234\",\"8494\":\"7efc76d6\",\"8542\":\"c4468ea6\",\"8566\":\"10bf1b35\",\"8902\":\"7c55c148\",\"8990\":\"577df295\",\"9034\":\"116f7535\",\"9038\":\"e307fc2b\",\"9150\":\"0fa22a99\",\"9355\":\"86db726d\",\"9390\":\"fa40267e\",\"9510\":\"fe86be6b\",\"9838\":\"c93b6fa0\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"things-editor:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t3524: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkthings_editor\"] = self[\"webpackChunkthings_editor\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(1988); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["class","style","ref","value","documentType","columnCount","loadState","saveState","exportImage","onItemDropdownSelect","onPageDropdownSelect","warningText","tabindex","focusEditor","parse","input","Math","max","parseInt","lines","split","escapeHTML","str","String","replace","applyInlineFormatting","text","safe","m","t","u","createEl","tag","className","el","document","createElement","undefined","textContent","makeColumn","makePage","pageType","type","page","setProperty","appendChild","RE","comment","pageNum","column","spacing","equipment","equipmentDetail","equipmentNext","spell","spellDetail","spellNext","specialist","noteStart","blockEnd","toc","heading","styleBegin","styleEnd","img","codeFenceBegin","hr","pageBreak","columns","parent","pages","activePageIndex","activePage","pageColumns","activeColumnIndex","noteDiv","equipmentDiv","equipmentSectionContainer","equipmentSectionCount","spellDiv","spellArtistries","spellSectionContainer","spellSectionCount","tocDiv","styleCollect","specialistDiv","pageColumnLimits","getActiveColumn","ensureColumn","length","querySelector","startNewPage","pageLabel","push","firstCol","pageDiv","test","toString","padStart","startEquipment","rarity","name","toLowerCase","contentWrap","title","startSpell","addEquipmentDetail","kind","rawContent","detail","left","rest","right","join","trim","first","second","addSpellDetail","arts","forEach","a","nextEquipmentSection","section","nextSpellSection","endEquipment","endSpell","artistryCount","container","artistry","artistryIcon","setAttribute","startNote","firstLine","wrapper","makeImg","cls","file","src","gradient","p","innerHTML","appendNoteLine","line","endNote","startTOC","endTOC","addTOCEntry","entry","addHeading","level","span","attrs","min","h","id","classes","c","classList","add","includes","addParagraph","addSpacing","px","spacer","height","addPageNumber","num","advanceColumn","cols","limit","newCol","parseAttributeBlock","body","attrMatch","match","attrContent","remaining","slice","index","rawTokens","startsWith","val","substring","addSpecialistTable","div","headerWrap","headerRow","idx","cell","i","raw","styleEl","css","mDet","parts","exec","h2","desc","splits","map","s","row","alt","pb","mList","ul","liLine","mItem","li","mOrdered","ol","mf","lang","buffer","pre","code","pAttrs","console","log","data","docWidth","docHeight","headerFontPx","subheaderFontPx","bodyFontPx","dpi","headerFontPt","subheaderFontPt","bodyFontPt","isSaving","mounted","setInterval","model","this","_monacoEditor","getModel","getValue","setTimeout","$nextTick","tick","$refs","viewerContainer","$watch","viewerContent","backgroundImage","backgroundSize","backgroundRepeat","backgroundPosition","beforeUnmount","dispose","e","_viewerResizeObserver","disconnect","_editorResizeObserver","window","__thingsEditor","methods","event","target","onInsertSelect","selectedItemType","selectedPageType","onEquipmentButtonClick","onPageButtonClick","content","localStorage","getItem","editor","current","selection","hadFocus","getSelection","activeElement","monacoContainer","contains","setValue","setSelection","focus","now","Date","_lastSave","setItem","warn","register","setMonarchTokensProvider","defaultToken","keywords","typeKeywords","operators","symbols","escapes","tokenizer","root","defineTheme","base","inherit","rules","token","foreground","fontStyle","colors","create","language","wordWrap","theme","renderMarkdown","viewer","width","parsedContent","updateScale","onDidChangeModelContent","pxToPt","updateVars","ptToPx","ResizeObserver","ro","observe","addEventListener","bind","roEditor","layout","option","insertText","pos","getPosition","full","executeEdits","range","lineNumber","forceMoveMarkers","async","Array","from","querySelectorAll","alert","zip","usedPageNumbers","pageNumber","blob","dataUrl","dataurl","arr","mime","bstr","atob","n","u8arr","Uint8Array","charCodeAt","Blob","size","err","error","generateAsync","url","URL","createObjectURL","href","download","click","remove","revokeObjectURL","err2","containerW","clientWidth","containerH","clientHeight","docW","parseFloat","docH","scaleX","scaleY","scale","scaledW","scaledH","offsetX","offsetY","transformOrigin","transform","pt","__exports__","components","ThingsEditor","render","App","mount","webpackAsyncContext","req","Promise","resolve","then","__webpack_require__","o","Error","keys","Object","module","exports","ids","all","__webpack_module_cache__","moduleId","cachedModule","__webpack_modules__","call","amdO","deferred","O","result","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","key","splice","r","getter","__esModule","d","definition","defineProperty","enumerable","get","f","chunkId","reduce","promises","miniCssF","g","globalThis","Function","obj","prop","prototype","hasOwnProperty","inProgress","dataWebpackPrefix","l","done","script","needAttach","scripts","getElementsByTagName","getAttribute","charset","timeout","nc","onScriptComplete","prev","onerror","onload","clearTimeout","doneFns","parentNode","removeChild","head","Symbol","toStringTag","installedChunks","installedChunkData","promise","reject","loadingEnded","errorType","realSrc","message","request","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}